{
  "version": 3,
  "sources": ["../src/js/search-card-template.js", "../src/js/multi-select-dropdown.js", "../src/js/populate-dropdowns.js", "../src/js/search-filters.js", "../src/js/ntg-funnelback.js", "../src/js/cta-button-alias.js", "../src/js/load-initial-results.js", "../src/js/offline-search.js", "../src/js/search-form-handler.js", "../src/js/index.js"],
  "sourcesContent": ["// Search card template generator for AI Knowledge Base results\r\n\r\n/**\r\n * Parse date string and extract \"Month YYYY\" format\r\n * @param {string} dateStr - Raw date string (e.g., \"December 2025\")\r\n * @returns {string} Formatted date or original string if parsing fails\r\n */\r\nfunction formatDate(dateStr) {\r\n  if (!dateStr) return \"\";\r\n\r\n  // If already in \"Month YYYY\" format, return as-is\r\n  const monthYearPattern = /^[A-Z][a-z]+ \\d{4}$/;\r\n  if (monthYearPattern.test(dateStr)) {\r\n    return dateStr;\r\n  }\r\n\r\n  // Try to parse as Date object\r\n  try {\r\n    const date = new Date(dateStr);\r\n    if (!isNaN(date.getTime())) {\r\n      const months = [\r\n        \"January\",\r\n        \"February\",\r\n        \"March\",\r\n        \"April\",\r\n        \"May\",\r\n        \"June\",\r\n        \"July\",\r\n        \"August\",\r\n        \"September\",\r\n        \"October\",\r\n        \"November\",\r\n        \"December\",\r\n      ];\r\n      return `${months[date.getMonth()]} ${date.getFullYear()}`;\r\n    }\r\n  } catch (e) {\r\n    // Fall through to return original\r\n  }\r\n\r\n  return dateStr;\r\n}\r\n\r\n/**\r\n * Create a search result card DOM element\r\n * @param {Object} result - Result data object\r\n * @param {string} result.title - Card title\r\n * @param {string} result.summary - Card summary/description\r\n * @param {Object} result.listMetadata - Metadata object\r\n * @param {Array<string>} result.listMetadata.keyword - Array of keywords [category, usefulFor]\r\n * @param {string} result.date - Submission date\r\n * @param {string} result.liveUrl - URL for \"See more\" button\r\n * @returns {HTMLElement|null} Card element or null if required fields missing\r\n */\r\nfunction createSearchCard(result) {\r\n  // Validate required fields\r\n  if (!result.title || !result.summary || !result.liveUrl) {\r\n    console.warn(\"Skipping card with missing required fields:\", result);\r\n    return null;\r\n  }\r\n\r\n  // Create card container\r\n  const card = document.createElement(\"div\");\r\n  card.className = \"aikb-search-card\";\r\n\r\n  // Create inner wrapper\r\n  const inner = document.createElement(\"div\");\r\n  inner.className = \"aikb-search-card__inner\";\r\n\r\n  // Create content section\r\n  const content = document.createElement(\"div\");\r\n  content.className = \"aikb-search-card__content\";\r\n\r\n  // Text section\r\n  const textSection = document.createElement(\"div\");\r\n  textSection.className = \"aikb-search-card__text\";\r\n\r\n  // Title\r\n  const title = document.createElement(\"h3\");\r\n  title.className = \"aikb-search-card__title\";\r\n  title.textContent = result.title;\r\n  textSection.appendChild(title);\r\n\r\n  // Summary\r\n  const summary = document.createElement(\"p\");\r\n  summary.className = \"aikb-search-card__summary\";\r\n  summary.textContent = result.summary;\r\n  textSection.appendChild(summary);\r\n\r\n  content.appendChild(textSection);\r\n\r\n  // Tags section (split comma-separated categories into individual tags)\r\n  const category =\r\n    result.listMetadata && result.listMetadata.keyword\r\n      ? result.listMetadata.keyword[0]\r\n      : null;\r\n  if (category) {\r\n    const tagsContainer = document.createElement(\"div\");\r\n    tagsContainer.className = \"aikb-search-card__tags\";\r\n\r\n    // Split by comma to create multiple tags if needed\r\n    const categories = category.split(\",\");\r\n    categories.forEach((cat) => {\r\n      const trimmedCat = cat.trim();\r\n      if (trimmedCat) {\r\n        const tag = document.createElement(\"div\");\r\n        tag.className = \"aikb-search-card__tag\";\r\n        tag.textContent = trimmedCat;\r\n        tagsContainer.appendChild(tag);\r\n      }\r\n    });\r\n\r\n    content.appendChild(tagsContainer);\r\n  }\r\n\r\n  inner.appendChild(content);\r\n\r\n  // Actions section\r\n  const actions = document.createElement(\"div\");\r\n  actions.className = \"aikb-search-card__actions\";\r\n\r\n  // \"See more\" button\r\n  const button = document.createElement(\"a\");\r\n  button.href = result.liveUrl;\r\n  button.className = \"ntgc-btn ntgc-btn--secondary\";\r\n\r\n  const buttonText = document.createElement(\"span\");\r\n  buttonText.textContent = \"See more\";\r\n  button.appendChild(buttonText);\r\n\r\n  const icon = document.createElement(\"span\");\r\n  icon.className = \"fal fa-long-arrow-right\";\r\n  icon.setAttribute(\"aria-hidden\", \"true\");\r\n  button.appendChild(icon);\r\n\r\n  actions.appendChild(button);\r\n\r\n  // Metadata section\r\n  const metadata = document.createElement(\"div\");\r\n  metadata.className = \"aikb-search-card__metadata\";\r\n\r\n  // \"Useful for\" row (only if keyword[1] exists)\r\n  const usefulFor =\r\n    result.listMetadata && result.listMetadata.keyword\r\n      ? result.listMetadata.keyword[1]\r\n      : null;\r\n  if (usefulFor) {\r\n    const usefulRow = document.createElement(\"div\");\r\n    usefulRow.className = \"aikb-search-card__useful-for\";\r\n\r\n    const label = document.createElement(\"span\");\r\n    label.className = \"aikb-search-card__useful-label\";\r\n    label.textContent = \"Useful for: \";\r\n    usefulRow.appendChild(label);\r\n\r\n    const value = document.createElement(\"span\");\r\n    value.className = \"aikb-search-card__useful-value\";\r\n    value.textContent = usefulFor;\r\n    usefulRow.appendChild(value);\r\n\r\n    metadata.appendChild(usefulRow);\r\n  }\r\n\r\n  // Submitted date\r\n  if (result.date) {\r\n    const dateEl = document.createElement(\"div\");\r\n    dateEl.className = \"aikb-search-card__date\";\r\n    dateEl.textContent = `Submitted: ${formatDate(result.date)}`;\r\n    metadata.appendChild(dateEl);\r\n  }\r\n\r\n  actions.appendChild(metadata);\r\n  inner.appendChild(actions);\r\n\r\n  card.appendChild(inner);\r\n\r\n  return card;\r\n}\r\n\r\n/**\r\n * Render search results to the container\r\n * @param {Array<Object>} results - Array of result objects\r\n * @param {string} containerId - ID of the container element (default: \"search-results-list\")\r\n */\r\nexport function renderResults(results, containerId = \"search-results-list\") {\r\n  console.log(\r\n    `renderResults called with ${results.length} results for container #${containerId}`\r\n  );\r\n\r\n  // Try multiple selection methods\r\n  let container = document.getElementById(containerId);\r\n  console.log(`document.getElementById(\"${containerId}\"):`, container);\r\n\r\n  if (!container) {\r\n    // Try jQuery selector as fallback\r\n    const $container = window.$ ? window.$(`#${containerId}`) : null;\r\n    console.log(`jQuery selector $(\"#${containerId}\"):`, $container);\r\n    container = $container && $container.length > 0 ? $container[0] : null;\r\n  }\r\n\r\n  if (!container) {\r\n    console.error(`Container #${containerId} not found`);\r\n    console.log(\r\n      \"Available elements with id:\",\r\n      Array.from(document.querySelectorAll(\"[id]\")).map((el) => el.id)\r\n    );\r\n    return;\r\n  }\r\n\r\n  // Clear existing content\r\n  container.innerHTML = \"\";\r\n\r\n  // Filter and render valid cards\r\n  const cards = results\r\n    .map((result) => createSearchCard(result))\r\n    .filter((card) => card !== null);\r\n\r\n  if (cards.length === 0) {\r\n    const noResults = document.createElement(\"p\");\r\n    noResults.textContent = \"No results found.\";\r\n    noResults.style.padding = \"24px 48px\";\r\n    container.appendChild(noResults);\r\n    return;\r\n  }\r\n\r\n  cards.forEach((card) => container.appendChild(card));\r\n\r\n  console.log(`Rendered ${cards.length} search result cards`);\r\n}\r\n\r\n// Expose globally for legacy usage\r\nwindow.aikbRenderResults = renderResults;\r\n", "/**\r\n * Custom Multi-Select Dropdown Component\r\n * Replaces the work area filter with a multi-select dropdown with OK/Cancel buttons\r\n */\r\n\r\nexport class MultiSelectDropdown {\r\n  constructor(selectElement) {\r\n    this.selectElement = selectElement;\r\n    this.options = [];\r\n    this.selectedValues = new Set();\r\n    this.tempSelectedValues = new Set();\r\n    this.isOpen = false;\r\n\r\n    this.container = null;\r\n    this.displayButton = null;\r\n    this.dropdownPanel = null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    // Hide original select element\r\n    this.selectElement.style.display = \"none\";\r\n\r\n    // Create custom dropdown structure\r\n    this.createDropdownStructure();\r\n\r\n    // Bind event listeners\r\n    this.bindEvents();\r\n\r\n    // Store instance reference on container for external access\r\n    this.container.__multiSelectInstance = this;\r\n  }\r\n\r\n  createDropdownStructure() {\r\n    // Main container\r\n    this.container = document.createElement(\"div\");\r\n    this.container.className = \"aikb-multiselect-container\";\r\n\r\n    // Display button (shows selected items)\r\n    this.displayButton = document.createElement(\"button\");\r\n    this.displayButton.type = \"button\";\r\n    this.displayButton.className = \"aikb-multiselect-button\";\r\n    this.displayButton.innerHTML = `\r\n      <span class=\"aikb-multiselect-text\">Select Options</span>\r\n      <span class=\"aikb-multiselect-icon\">\r\n        <span class=\"fal fa-chevron-down\" aria-hidden=\"true\"></span>\r\n      </span>\r\n    `;\r\n\r\n    // Dropdown panel\r\n    this.dropdownPanel = document.createElement(\"div\");\r\n    this.dropdownPanel.className = \"aikb-multiselect-panel\";\r\n    this.dropdownPanel.style.display = \"none\";\r\n\r\n    // Options list\r\n    const optionsList = document.createElement(\"div\");\r\n    optionsList.className = \"aikb-multiselect-options\";\r\n\r\n    // Add \"Select All\" option\r\n    const selectAllItem = this.createOptionItem({\r\n      value: \"_select_all\",\r\n      label: \"Select All\",\r\n      isSelectAll: true,\r\n    });\r\n    optionsList.appendChild(selectAllItem);\r\n\r\n    // Get options from original select element\r\n    Array.from(this.selectElement.options).forEach((option) => {\r\n      if (!option.disabled && option.value) {\r\n        this.options.push({\r\n          value: option.value,\r\n          label: option.textContent,\r\n        });\r\n\r\n        const optionItem = this.createOptionItem({\r\n          value: option.value,\r\n          label: option.textContent,\r\n        });\r\n        optionsList.appendChild(optionItem);\r\n      }\r\n    });\r\n\r\n    // Action buttons\r\n    const actionsContainer = document.createElement(\"div\");\r\n    actionsContainer.className = \"aikb-multiselect-actions\";\r\n\r\n    const okButton = document.createElement(\"button\");\r\n    okButton.type = \"button\";\r\n    okButton.className = \"aikb-multiselect-btn aikb-multiselect-btn-ok\";\r\n    okButton.textContent = \"OK\";\r\n    okButton.addEventListener(\"click\", () => this.handleOk());\r\n\r\n    const cancelButton = document.createElement(\"button\");\r\n    cancelButton.type = \"button\";\r\n    cancelButton.className = \"aikb-multiselect-btn aikb-multiselect-btn-cancel\";\r\n    cancelButton.textContent = \"Cancel\";\r\n    cancelButton.addEventListener(\"click\", () => this.handleCancel());\r\n\r\n    actionsContainer.appendChild(okButton);\r\n    actionsContainer.appendChild(cancelButton);\r\n\r\n    // Assemble dropdown panel\r\n    this.dropdownPanel.appendChild(optionsList);\r\n    this.dropdownPanel.appendChild(actionsContainer);\r\n\r\n    // Assemble container\r\n    this.container.appendChild(this.displayButton);\r\n    this.container.appendChild(this.dropdownPanel);\r\n\r\n    // Insert after original select\r\n    this.selectElement.parentNode.insertBefore(\r\n      this.container,\r\n      this.selectElement.nextSibling\r\n    );\r\n  }\r\n\r\n  createOptionItem(option) {\r\n    const item = document.createElement(\"label\");\r\n    item.className = \"aikb-multiselect-option\";\r\n    if (option.isSelectAll) {\r\n      item.classList.add(\"aikb-multiselect-option-all\");\r\n    }\r\n\r\n    const checkbox = document.createElement(\"input\");\r\n    checkbox.type = \"checkbox\";\r\n    checkbox.className = \"aikb-multiselect-checkbox\";\r\n    checkbox.value = option.value;\r\n    checkbox.dataset.label = option.label;\r\n\r\n    if (option.isSelectAll) {\r\n      checkbox.addEventListener(\"change\", (e) => this.handleSelectAll(e));\r\n    } else {\r\n      checkbox.addEventListener(\"change\", () => this.updateSelectAllState());\r\n    }\r\n\r\n    const labelText = document.createElement(\"span\");\r\n    labelText.className = \"aikb-multiselect-label\";\r\n    labelText.textContent = option.label;\r\n\r\n    item.appendChild(checkbox);\r\n    item.appendChild(labelText);\r\n\r\n    return item;\r\n  }\r\n\r\n  bindEvents() {\r\n    // Toggle dropdown on button click\r\n    this.displayButton.addEventListener(\"click\", (e) => {\r\n      e.stopPropagation();\r\n      this.toggle();\r\n    });\r\n\r\n    // Close dropdown when clicking outside\r\n    document.addEventListener(\"click\", (e) => {\r\n      if (!this.container.contains(e.target) && this.isOpen) {\r\n        this.handleCancel();\r\n      }\r\n    });\r\n  }\r\n\r\n  toggle() {\r\n    if (this.isOpen) {\r\n      this.close();\r\n    } else {\r\n      this.open();\r\n    }\r\n  }\r\n\r\n  open() {\r\n    this.isOpen = true;\r\n    this.dropdownPanel.style.display = \"block\";\r\n    this.displayButton.classList.add(\"aikb-multiselect-open\");\r\n\r\n    // Copy current selections to temp\r\n    this.tempSelectedValues = new Set(this.selectedValues);\r\n\r\n    // Update checkboxes to match temp selections\r\n    this.updateCheckboxes();\r\n  }\r\n\r\n  close() {\r\n    this.isOpen = false;\r\n    this.dropdownPanel.style.display = \"none\";\r\n    this.displayButton.classList.remove(\"aikb-multiselect-open\");\r\n  }\r\n\r\n  handleOk() {\r\n    // Get checked values\r\n    const checkboxes = this.dropdownPanel.querySelectorAll(\r\n      '.aikb-multiselect-checkbox:not([value=\"_select_all\"])'\r\n    );\r\n    this.selectedValues.clear();\r\n\r\n    checkboxes.forEach((checkbox) => {\r\n      if (checkbox.checked) {\r\n        this.selectedValues.add(checkbox.value);\r\n      }\r\n    });\r\n\r\n    // Update display text\r\n    this.updateDisplayText();\r\n\r\n    // Trigger change event\r\n    this.triggerChange();\r\n\r\n    // Close dropdown\r\n    this.close();\r\n  }\r\n\r\n  handleCancel() {\r\n    // Revert to previous selections\r\n    this.tempSelectedValues = new Set(this.selectedValues);\r\n    this.updateCheckboxes();\r\n\r\n    // Close dropdown\r\n    this.close();\r\n  }\r\n\r\n  handleSelectAll(e) {\r\n    const isChecked = e.target.checked;\r\n    const checkboxes = this.dropdownPanel.querySelectorAll(\r\n      '.aikb-multiselect-checkbox:not([value=\"_select_all\"])'\r\n    );\r\n\r\n    checkboxes.forEach((checkbox) => {\r\n      checkbox.checked = isChecked;\r\n    });\r\n  }\r\n\r\n  updateSelectAllState() {\r\n    const selectAllCheckbox = this.dropdownPanel.querySelector(\r\n      '.aikb-multiselect-checkbox[value=\"_select_all\"]'\r\n    );\r\n    const checkboxes = this.dropdownPanel.querySelectorAll(\r\n      '.aikb-multiselect-checkbox:not([value=\"_select_all\"])'\r\n    );\r\n    const checkedCount = Array.from(checkboxes).filter(\r\n      (cb) => cb.checked\r\n    ).length;\r\n\r\n    if (selectAllCheckbox) {\r\n      selectAllCheckbox.checked = checkedCount === checkboxes.length;\r\n      selectAllCheckbox.indeterminate =\r\n        checkedCount > 0 && checkedCount < checkboxes.length;\r\n    }\r\n  }\r\n\r\n  updateCheckboxes() {\r\n    const checkboxes = this.dropdownPanel.querySelectorAll(\r\n      '.aikb-multiselect-checkbox:not([value=\"_select_all\"])'\r\n    );\r\n\r\n    checkboxes.forEach((checkbox) => {\r\n      checkbox.checked = this.tempSelectedValues.has(checkbox.value);\r\n    });\r\n\r\n    this.updateSelectAllState();\r\n  }\r\n\r\n  updateDisplayText() {\r\n    const textElement = this.displayButton.querySelector(\r\n      \".aikb-multiselect-text\"\r\n    );\r\n\r\n    if (this.selectedValues.size === 0) {\r\n      textElement.textContent = \"Select Options\";\r\n      textElement.classList.remove(\"aikb-multiselect-has-selection\");\r\n    } else if (this.selectedValues.size === this.options.length) {\r\n      textElement.textContent = \"All selected\";\r\n      textElement.classList.add(\"aikb-multiselect-has-selection\");\r\n    } else {\r\n      const selectedLabels = Array.from(this.selectedValues).map((value) => {\r\n        const option = this.options.find((opt) => opt.value === value);\r\n        return option ? option.label : value;\r\n      });\r\n\r\n      if (this.selectedValues.size <= 2) {\r\n        textElement.textContent = selectedLabels.join(\", \");\r\n      } else {\r\n        textElement.textContent = `${this.selectedValues.size} selected`;\r\n      }\r\n      textElement.classList.add(\"aikb-multiselect-has-selection\");\r\n    }\r\n  }\r\n\r\n  triggerChange() {\r\n    // Dispatch custom event\r\n    const event = new CustomEvent(\"multiselect-change\", {\r\n      detail: {\r\n        values: Array.from(this.selectedValues),\r\n      },\r\n    });\r\n    this.container.dispatchEvent(event);\r\n\r\n    console.log(\"Multi-select changed:\", Array.from(this.selectedValues));\r\n  }\r\n\r\n  getSelectedValues() {\r\n    return Array.from(this.selectedValues);\r\n  }\r\n\r\n  reset() {\r\n    this.selectedValues.clear();\r\n    this.tempSelectedValues.clear();\r\n    this.updateDisplayText();\r\n    this.updateCheckboxes();\r\n  }\r\n\r\n  destroy() {\r\n    // Remove the custom dropdown container from DOM\r\n    if (this.container && this.container.parentNode) {\r\n      this.container.parentNode.removeChild(this.container);\r\n    }\r\n\r\n    // Show the original select element\r\n    if (this.selectElement) {\r\n      this.selectElement.style.display = \"\";\r\n    }\r\n\r\n    // Clear references\r\n    this.container = null;\r\n    this.displayButton = null;\r\n    this.dropdownPanel = null;\r\n\r\n    console.log(\"Multi-select instance destroyed\");\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize multi-select dropdown on a select element\r\n * @param {string|HTMLElement} selector - CSS selector or DOM element\r\n * @returns {MultiSelectDropdown} - MultiSelectDropdown instance\r\n */\r\nexport function initMultiSelect(selector) {\r\n  const element =\r\n    typeof selector === \"string\" ? document.querySelector(selector) : selector;\r\n\r\n  if (!element) {\r\n    console.warn(\"Multi-select element not found:\", selector);\r\n    return null;\r\n  }\r\n\r\n  return new MultiSelectDropdown(element);\r\n}\r\n", "// Dynamically populate work area and sort dropdowns from search data\r\nimport { initMultiSelect } from \"./multi-select-dropdown.js\";\r\n\r\nlet multiSelectInstance = null;\r\n\r\n/**\r\n * Extract unique work areas from search results\r\n * @param {Array} results - Array of search result objects\r\n * @returns {Array<string>} - Sorted array of unique work area values\r\n */\r\nfunction extractWorkAreas(results) {\r\n  const workAreaSet = new Set();\r\n\r\n  results.forEach((result) => {\r\n    if (\r\n      result.listMetadata &&\r\n      result.listMetadata.keyword &&\r\n      result.listMetadata.keyword[0]\r\n    ) {\r\n      const workArea = result.listMetadata.keyword[0];\r\n      // Split comma-separated values and add each individually\r\n      workArea.split(\",\").forEach((area) => {\r\n        const trimmed = area.trim();\r\n        if (trimmed) {\r\n          workAreaSet.add(trimmed);\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  // Convert to array and sort alphabetically\r\n  return Array.from(workAreaSet).sort((a, b) => {\r\n    // Put \"All work areas\" first if it exists\r\n    if (a === \"All work areas\") return -1;\r\n    if (b === \"All work areas\") return 1;\r\n    return a.localeCompare(b);\r\n  });\r\n}\r\n\r\n/**\r\n * Populate work area dropdown with dynamic options\r\n * @param {Array<string>} workAreas - Array of work area values\r\n */\r\nfunction populateWorkAreaDropdown(workAreas) {\r\n  const dropdown = document.getElementById(\"document_type\");\r\n  if (!dropdown) {\r\n    console.warn(\"Work area dropdown #document_type not found\");\r\n    return;\r\n  }\r\n\r\n  // Clear existing options\r\n  dropdown.innerHTML = \"\";\r\n\r\n  // Add default \"Select a work area\" option\r\n  const defaultOption = document.createElement(\"option\");\r\n  defaultOption.value = \"\";\r\n  defaultOption.textContent = \"Select a work area\";\r\n  defaultOption.disabled = true;\r\n  defaultOption.selected = true;\r\n  dropdown.appendChild(defaultOption);\r\n\r\n  // Add work area options\r\n  workAreas.forEach((workArea) => {\r\n    const option = document.createElement(\"option\");\r\n    option.value = workArea;\r\n    option.textContent = workArea;\r\n    dropdown.appendChild(option);\r\n  });\r\n\r\n  console.log(`Populated work area dropdown with ${workAreas.length} options`);\r\n\r\n  // Initialize multi-select after populating options\r\n  if (multiSelectInstance) {\r\n    // Destroy previous instance if exists\r\n    multiSelectInstance.destroy();\r\n    multiSelectInstance = null;\r\n  }\r\n\r\n  // Only initialize if not already initialized\r\n  if (\r\n    !dropdown.nextElementSibling ||\r\n    !dropdown.nextElementSibling.classList.contains(\r\n      \"aikb-multiselect-container\"\r\n    )\r\n  ) {\r\n    multiSelectInstance = initMultiSelect(dropdown);\r\n  }\r\n}\r\n\r\n/**\r\n * Populate sort dropdown with sort options\r\n */\r\nfunction populateSortDropdown() {\r\n  const dropdown = document.getElementById(\"owner\");\r\n  if (!dropdown) {\r\n    console.warn(\"Sort dropdown #owner not found\");\r\n    return;\r\n  }\r\n\r\n  // Clear existing options\r\n  dropdown.innerHTML = \"\";\r\n\r\n  // Define sort options\r\n  const sortOptions = [\r\n    { value: \"relevance\", label: \"Relevance\", selected: true },\r\n    { value: \"date-newest\", label: \"Date (newest first)\" },\r\n    { value: \"date-oldest\", label: \"Date (oldest first)\" },\r\n    { value: \"title-az\", label: \"Title (A-Z)\" },\r\n    { value: \"title-za\", label: \"Title (Z-A)\" },\r\n  ];\r\n\r\n  // Add options to dropdown\r\n  sortOptions.forEach((opt) => {\r\n    const option = document.createElement(\"option\");\r\n    option.value = opt.value;\r\n    option.textContent = opt.label;\r\n    if (opt.selected) option.selected = true;\r\n    dropdown.appendChild(option);\r\n  });\r\n\r\n  console.log(`Populated sort dropdown with ${sortOptions.length} options`);\r\n}\r\n\r\n/**\r\n * Add chevron-down icons to dropdowns\r\n */\r\nfunction addDropdownIcons() {\r\n  // Add icon to work area dropdown\r\n  const workAreaDropdown = document.getElementById(\"document_type\");\r\n  if (\r\n    workAreaDropdown &&\r\n    !workAreaDropdown.parentElement.querySelector(\".aikb-dropdown-icon\")\r\n  ) {\r\n    const icon = document.createElement(\"div\");\r\n    icon.className = \"aikb-dropdown-icon\";\r\n    icon.setAttribute(\"data-colour\", \"NTG Blue\");\r\n    icon.innerHTML =\r\n      '<span class=\"fal fa-chevron-down\" aria-hidden=\"true\"></span>';\r\n\r\n    const wrapper = workAreaDropdown.closest(\".aikb-dropdown-wrapper\");\r\n    if (wrapper) {\r\n      const inner = wrapper.querySelector(\".aikb-dropdown-inner\");\r\n      if (inner) {\r\n        inner.appendChild(icon);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Add icon to sort dropdown\r\n  const sortDropdown = document.getElementById(\"owner\");\r\n  if (\r\n    sortDropdown &&\r\n    !sortDropdown.parentElement.querySelector(\".aikb-dropdown-icon\")\r\n  ) {\r\n    const icon = document.createElement(\"div\");\r\n    icon.className = \"aikb-dropdown-icon\";\r\n    icon.setAttribute(\"data-colour\", \"NTG Blue\");\r\n    icon.innerHTML =\r\n      '<span class=\"fal fa-chevron-down\" aria-hidden=\"true\"></span>';\r\n\r\n    const wrapper = sortDropdown.closest(\".aikb-dropdown-wrapper\");\r\n    if (wrapper) {\r\n      const inner = wrapper.querySelector(\".aikb-dropdown-inner\");\r\n      if (inner) {\r\n        inner.appendChild(icon);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize dropdowns with data from search results\r\n * @param {Array} results - Array of search result objects\r\n */\r\nexport function initializeDropdowns(results) {\r\n  console.log(\"Initializing dropdowns with search data...\");\r\n\r\n  // Extract and populate work areas\r\n  const workAreas = extractWorkAreas(results);\r\n  populateWorkAreaDropdown(workAreas);\r\n\r\n  // Populate sort options\r\n  populateSortDropdown();\r\n\r\n  // Add chevron icons\r\n  addDropdownIcons();\r\n\r\n  console.log(\"Dropdowns initialized successfully\");\r\n}\r\n\r\n/**\r\n * Initialize on page load with empty state\r\n */\r\nexport function initializeEmptyDropdowns() {\r\n  console.log(\"Initializing dropdowns with default state...\");\r\n\r\n  // Populate sort options (not data-dependent)\r\n  populateSortDropdown();\r\n\r\n  // Add default \"Select a work area\" to work area dropdown\r\n  populateWorkAreaDropdown([]);\r\n\r\n  // Add chevron icons\r\n  addDropdownIcons();\r\n\r\n  console.log(\"Empty dropdowns initialized\");\r\n}\r\n", "// Client-side filtering and sorting for search results\r\n\r\nlet allResults = []; // Store all results for filtering/sorting\r\n\r\n/**\r\n * Store search results for filtering and sorting\r\n * @param {Array} results - Array of search result objects\r\n */\r\nexport function storeResults(results) {\r\n  allResults = results;\r\n  console.log(`Stored ${allResults.length} results for filtering/sorting`);\r\n}\r\n\r\n/**\r\n * Filter results by work area\r\n * @param {Array} selectedWorkAreas - Selected work area values\r\n * @returns {Array} - Filtered results\r\n */\r\nfunction filterByWorkArea(selectedWorkAreas) {\r\n  if (!selectedWorkAreas || selectedWorkAreas.length === 0) {\r\n    return allResults; // Return all if no filter selected\r\n  }\r\n\r\n  return allResults.filter((result) => {\r\n    if (\r\n      !result.listMetadata ||\r\n      !result.listMetadata.keyword ||\r\n      !result.listMetadata.keyword[0]\r\n    ) {\r\n      return false;\r\n    }\r\n\r\n    const resultWorkAreas = result.listMetadata.keyword[0];\r\n\r\n    // Check if any selected work area matches (handle comma-separated values)\r\n    const workAreaArray = resultWorkAreas.split(\",\").map((area) => area.trim());\r\n\r\n    return selectedWorkAreas.some((selectedArea) =>\r\n      workAreaArray.includes(selectedArea)\r\n    );\r\n  });\r\n}\r\n\r\n/**\r\n * Sort results by selected criteria\r\n * @param {Array} results - Results to sort\r\n * @param {string} sortBy - Sort criteria (relevance, date-newest, date-oldest, title-az, title-za)\r\n * @returns {Array} - Sorted results\r\n */\r\nfunction sortResults(results, sortBy) {\r\n  const sorted = [...results]; // Create copy to avoid mutating original\r\n\r\n  switch (sortBy) {\r\n    case \"relevance\":\r\n      // Sort by rank (lower is better) or score (higher is better)\r\n      sorted.sort((a, b) => {\r\n        if (a.rank && b.rank) {\r\n          return a.rank - b.rank;\r\n        }\r\n        if (a.score && b.score) {\r\n          return b.score - a.score;\r\n        }\r\n        return 0;\r\n      });\r\n      break;\r\n\r\n    case \"date-newest\":\r\n      sorted.sort((a, b) => {\r\n        const dateA = a.date ? new Date(a.date).getTime() : 0;\r\n        const dateB = b.date ? new Date(b.date).getTime() : 0;\r\n        return dateB - dateA; // Newest first\r\n      });\r\n      break;\r\n\r\n    case \"date-oldest\":\r\n      sorted.sort((a, b) => {\r\n        const dateA = a.date ? new Date(a.date).getTime() : 0;\r\n        const dateB = b.date ? new Date(b.date).getTime() : 0;\r\n        return dateA - dateB; // Oldest first\r\n      });\r\n      break;\r\n\r\n    case \"title-az\":\r\n      sorted.sort((a, b) => {\r\n        const titleA = a.title || \"\";\r\n        const titleB = b.title || \"\";\r\n        return titleA.localeCompare(titleB);\r\n      });\r\n      break;\r\n\r\n    case \"title-za\":\r\n      sorted.sort((a, b) => {\r\n        const titleA = a.title || \"\";\r\n        const titleB = b.title || \"\";\r\n        return titleB.localeCompare(titleA);\r\n      });\r\n      break;\r\n\r\n    default:\r\n      // No sorting or unknown sort option\r\n      break;\r\n  }\r\n\r\n  return sorted;\r\n}\r\n\r\n/**\r\n * Apply filters and sorting, then render results\r\n */\r\nasync function applyFiltersAndSort() {\r\n  const workAreaContainer = document.querySelector(\r\n    \".aikb-multiselect-container\"\r\n  );\r\n  const sortDropdown = document.getElementById(\"owner\");\r\n\r\n  if (!sortDropdown) {\r\n    console.warn(\"Sort dropdown not found\");\r\n    return;\r\n  }\r\n\r\n  // Get selected work areas from multi-select\r\n  let selectedWorkAreas = [];\r\n  if (workAreaContainer && workAreaContainer.__multiSelectInstance) {\r\n    selectedWorkAreas =\r\n      workAreaContainer.__multiSelectInstance.getSelectedValues();\r\n  }\r\n\r\n  const selectedSort = sortDropdown.value || \"relevance\";\r\n\r\n  console.log(\r\n    `Applying filters - Work Areas: [${selectedWorkAreas.join(\r\n      \", \"\r\n    )}], Sort: \"${selectedSort}\"`\r\n  );\r\n\r\n  // Filter by work areas\r\n  let filtered = filterByWorkArea(selectedWorkAreas);\r\n  console.log(`After filtering: ${filtered.length} results`);\r\n\r\n  // Sort results\r\n  let sorted = sortResults(filtered, selectedSort);\r\n  console.log(`After sorting: ${sorted.length} results`);\r\n\r\n  // Render filtered and sorted results\r\n  const { renderResults } = await import(\"./search-card-template.js\");\r\n  renderResults(sorted, \"search-results-list\");\r\n}\r\n\r\n/**\r\n * Initialize filter and sort listeners\r\n */\r\nexport function initializeFiltersAndSort() {\r\n  const workAreaContainer = document.querySelector(\r\n    \".aikb-multiselect-container\"\r\n  );\r\n  const sortDropdown = document.getElementById(\"owner\");\r\n\r\n  if (workAreaContainer) {\r\n    workAreaContainer.addEventListener(\"multiselect-change\", function () {\r\n      console.log(\"Work area multi-select changed\");\r\n      applyFiltersAndSort();\r\n    });\r\n  }\r\n\r\n  if (sortDropdown) {\r\n    sortDropdown.addEventListener(\"change\", function () {\r\n      console.log(`Sort changed to: ${this.value}`);\r\n      applyFiltersAndSort();\r\n    });\r\n  }\r\n\r\n  console.log(\"Filter and sort listeners initialized\");\r\n}\r\n", "// In-page Funnelback search (unminified source)\r\nimport { renderResults } from \"./search-card-template.js\";\r\nimport { initializeDropdowns } from \"./populate-dropdowns.js\";\r\nimport { storeResults, initializeFiltersAndSort } from \"./search-filters.js\";\r\n\r\nconst ntgFunnelback = {\r\n  originalterm: \"\",\r\n  filteredterm: \"\",\r\n  currentPage: 1,\r\n\r\n  defaults: {\r\n    sourceField: \"#search\",\r\n    baseURL: \"https://ntgov-search.funnelback.squiz.cloud/s/search.json\",\r\n    collection: \"ntgov~sp-ntgc-ai-knowledge-base\",\r\n    defaultQuery: \"!FunDoesNotExist:PadreNull\",\r\n    funnelbackParams: {},\r\n    minChars: 3,\r\n    containerSelector: \"#content .inner-page.au-body .container\",\r\n  },\r\n\r\n  noisewords:\r\n    \"a au all am an and any are as at be been but by can cant co com de do eg else etc for from get go had has hasnt have he hence her here hers him his how http https i ie if in is it its la me my nor not now of off on or our ours pm put re she so than that the their them then there these they this those thus to too uk un until up upon us very via was we well were what when where which while who why www you your yours\",\r\n\r\n  init: function (query, doctype, owner, corrections, scopeID = false) {\r\n    console.log(\"Init Funnelback Search\");\r\n\r\n    // Check for tags\r\n    const regex = new RegExp(\"[*<>();/&]\", \"gi\");\r\n    query = query.replace(regex, \"\");\r\n\r\n    // Perform a search immediately based on querystring?\r\n    if (query !== false && query.trim().length > 0) {\r\n      ntgFunnelback.originalterm = query;\r\n      ntgFunnelback.currentPage = 1;\r\n      ntgFunnelback.callSearchAPI();\r\n    }\r\n  },\r\n\r\n  callSearchAPI: function (query, onError) {\r\n    // If query parameter provided, set originalterm\r\n    if (query !== undefined && query !== null) {\r\n      ntgFunnelback.originalterm = query;\r\n    }\r\n\r\n    console.log(\r\n      \"callSearchAPI called with originalterm:\",\r\n      ntgFunnelback.originalterm\r\n    );\r\n\r\n    // Clear container while loading\r\n    const container = document.getElementById(\"search-results-list\");\r\n    if (container) {\r\n      container.innerHTML = '<div class=\"aikb-loading\">Searching...</div>';\r\n    }\r\n\r\n    // Remove noise words from the query\r\n    ntgFunnelback.filterQuery();\r\n    console.log(\"After filterQuery, filteredterm:\", ntgFunnelback.filteredterm);\r\n\r\n    // Calculate start_rank for pagination (Funnelback uses 1-based ranking)\r\n    const startRank = (ntgFunnelback.currentPage - 1) * 10 + 1;\r\n\r\n    // Build Funnelback API URL\r\n    let fbUrl = `${ntgFunnelback.defaults.baseURL}?collection=${ntgFunnelback.defaults.collection}`;\r\n\r\n    // If there's a filtered search term, use ?query= parameter\r\n    // Otherwise, use ?s= parameter for default top items\r\n    if (\r\n      ntgFunnelback.filteredterm &&\r\n      ntgFunnelback.filteredterm.trim().length > 0\r\n    ) {\r\n      fbUrl += `&query=${encodeURIComponent(ntgFunnelback.filteredterm)}`;\r\n\r\n      // Update URL query string for user searches\r\n      const params = new URLSearchParams(window.location.search);\r\n      params.set(\"query\", ntgFunnelback.filteredterm);\r\n      if (ntgFunnelback.currentPage && ntgFunnelback.currentPage !== 1) {\r\n        params.set(\"page\", ntgFunnelback.currentPage);\r\n      } else {\r\n        params.delete(\"page\");\r\n      }\r\n      const newUrl =\r\n        window.location.pathname +\r\n        (params.toString() ? \"?\" + params.toString() : \"\");\r\n      window.history.replaceState({}, \"\", newUrl);\r\n    } else {\r\n      // No search term - use default query for top items\r\n      fbUrl += `&s=${encodeURIComponent(ntgFunnelback.defaults.defaultQuery)}`;\r\n    }\r\n\r\n    // Add pagination\r\n    fbUrl += `&num_ranks=10&start_rank=${startRank}`;\r\n\r\n    console.log(\"Calling Funnelback API:\", fbUrl);\r\n\r\n    $.ajax({\r\n      url: fbUrl,\r\n      dataType: \"JSON\",\r\n      type: \"GET\",\r\n      success: function (dataset) {\r\n        ntgFunnelback.processResults(dataset);\r\n      },\r\n      error: function (xhr, status, error) {\r\n        console.warn(\"Funnelback API error, loading fallback data:\", error);\r\n        // Load fallback search.json\r\n        $.ajax({\r\n          url: \"src/data/search.json\",\r\n          dataType: \"JSON\",\r\n          type: \"GET\",\r\n          success: function (fallbackData) {\r\n            console.log(\"Loaded fallback search data\");\r\n            ntgFunnelback.processResults(fallbackData);\r\n          },\r\n          error: function () {\r\n            console.error(\"Failed to load fallback search data\");\r\n\r\n            // Invoke onError callback if provided (for offline search)\r\n            if (typeof onError === \"function\") {\r\n              console.log(\"Triggering offline search fallback\");\r\n              onError(new Error(\"Both API and fallback JSON failed\"));\r\n            } else if (container) {\r\n              container.innerHTML =\r\n                \"<p>Unable to load search results. Please try again later.</p>\";\r\n            }\r\n          },\r\n        });\r\n      },\r\n    });\r\n  },\r\n\r\n  filterQuery: function () {\r\n    // If originalterm is empty or undefined, set filteredterm to empty\r\n    if (\r\n      !ntgFunnelback.originalterm ||\r\n      ntgFunnelback.originalterm.trim() === \"\"\r\n    ) {\r\n      ntgFunnelback.filteredterm = \"\";\r\n      return false;\r\n    }\r\n\r\n    const noiseList = ntgFunnelback.noisewords.split(\" \");\r\n    const searchPhrase = ntgFunnelback.originalterm.trim().split(\" \");\r\n\r\n    // Check for empty array\r\n    if (searchPhrase.length === 0) {\r\n      ntgFunnelback.filteredterm = \"\";\r\n      return false;\r\n    }\r\n\r\n    const revisedPhrase = [];\r\n\r\n    $.each(searchPhrase, function (i, term) {\r\n      if ($.inArray(term.toLowerCase(), noiseList) === -1) {\r\n        revisedPhrase.push(term);\r\n      }\r\n    });\r\n\r\n    // Clean for tags\r\n    const regex = new RegExp(\"[*<>{}();/&]\", \"gi\");\r\n    let phraseAsString = revisedPhrase.join(\" \");\r\n    phraseAsString = phraseAsString.replace(regex, \"\");\r\n\r\n    ntgFunnelback.filteredterm = phraseAsString;\r\n    return;\r\n  },\r\n\r\n  processResults: function (dataset) {\r\n    // Extract results from Funnelback response structure\r\n    const results =\r\n      dataset.response && dataset.response.resultPacket\r\n        ? dataset.response.resultPacket.results\r\n        : [];\r\n\r\n    console.log(`Processing ${results.length} search results`);\r\n\r\n    // Filter out excluded URLs\r\n    const excludedUrls = [\r\n      \"https://ntgcentral.nt.gov.au/dev/aikb/configuration/listing/articles/_nocache\",\r\n    ];\r\n\r\n    const filteredResults = results.filter((result) => {\r\n      return !excludedUrls.includes(result.liveUrl);\r\n    });\r\n\r\n    console.log(\r\n      `After filtering: ${filteredResults.length} results (excluded ${\r\n        results.length - filteredResults.length\r\n      })`\r\n    );\r\n\r\n    // Map results to card template format\r\n    const mappedResults = filteredResults.map((result) => ({\r\n      title: result.title || \"\",\r\n      summary: result.summary || \"\",\r\n      listMetadata: result.listMetadata || {},\r\n      date: result.date || \"\",\r\n      liveUrl: result.liveUrl || \"\",\r\n      rank: result.rank || 0,\r\n      score: result.score || 0,\r\n    }));\r\n\r\n    // Store results for filtering/sorting\r\n    storeResults(mappedResults);\r\n\r\n    // Initialize dropdowns with work area data\r\n    initializeDropdowns(mappedResults);\r\n\r\n    // Initialize filter and sort listeners\r\n    initializeFiltersAndSort();\r\n\r\n    // Render results using card template\r\n    renderResults(mappedResults, \"search-results-list\");\r\n\r\n    console.log(\r\n      \"Funnelback API results rendered (updated from offline/fallback)\"\r\n    );\r\n  },\r\n};\r\n\r\n// Expose globally for legacy usage\r\nwindow.ntgFunnelback = ntgFunnelback;\r\nexport { ntgFunnelback };\r\n", "// Alias CTA anchors to reuse NTGC primary button styling\r\nconst CTA_SELECTOR = 'div[data-hydration-component=\"squiz-call-to-action\"] a';\r\n\r\nfunction applyCtaButtonAlias(root = document) {\r\n  const anchors = root.querySelectorAll(CTA_SELECTOR);\r\n  anchors.forEach((anchor) => {\r\n    anchor.classList.add(\"ntgc-btn\", \"ntgc-btn--primary\");\r\n  });\r\n}\r\n\r\nif (document.readyState === \"loading\") {\r\n  document.addEventListener(\"DOMContentLoaded\", () => applyCtaButtonAlias());\r\n} else {\r\n  applyCtaButtonAlias();\r\n}\r\n", "// Load initial search results from Funnelback API on page load\r\nimport { renderResults } from \"./search-card-template.js\";\r\nimport { initializeDropdowns } from \"./populate-dropdowns.js\";\r\nimport { storeResults, initializeFiltersAndSort } from \"./search-filters.js\";\r\n\r\n// Export for use in search-form-handler\r\nexport function loadInitialResults() {\r\n  // Check if we're on a page with search results container\r\n  const searchResultsContainer = document.getElementById(\"search-results-list\");\r\n  if (!searchResultsContainer) {\r\n    console.warn(\"search-results-list container not found on page\");\r\n    return; // Not on search results page\r\n  }\r\n\r\n  console.log(\"Loading initial results (fallback first, then API)...\");\r\n\r\n  // Load fallback JSON immediately for fast initial display\r\n  fetch(\"src/data/search.json\")\r\n    .then((response) => {\r\n      console.log(\r\n        \"Fallback JSON response status:\",\r\n        response.status,\r\n        response.ok\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then((data) => {\r\n      console.log(\"Fallback JSON data loaded successfully:\", data);\r\n      processAndRenderResults(data, \"fallback\");\r\n    })\r\n    .catch((fallbackError) => {\r\n      console.error(\"Error loading fallback search.json:\", fallbackError);\r\n      searchResultsContainer.innerHTML =\r\n        '<p class=\"aikb-error\">Error loading search data: ' +\r\n        fallbackError.message +\r\n        \"</p>\";\r\n    });\r\n\r\n  // Fetch from Funnelback API in background (will update results when ready)\r\n  const apiURL =\r\n    \"https://ntgov-search.funnelback.squiz.cloud/s/search.json?collection=ntgov~sp-ntgc-ai-knowledge-base&s=!FunDoesNotExist:PadreNull\";\r\n\r\n  fetch(apiURL)\r\n    .then((response) => {\r\n      console.log(\r\n        \"Funnelback API response status:\",\r\n        response.status,\r\n        response.ok\r\n      );\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n      return response.json();\r\n    })\r\n    .then((data) => {\r\n      console.log(\r\n        \"Funnelback API data loaded successfully, updating results:\",\r\n        data\r\n      );\r\n      processAndRenderResults(data, \"api\");\r\n    })\r\n    .catch((error) => {\r\n      console.warn(\r\n        \"Funnelback API failed or timed out, keeping fallback data:\",\r\n        error\r\n      );\r\n      // Don't show error - fallback data already displayed\r\n    });\r\n}\r\n\r\nfunction processAndRenderResults(data, source = \"unknown\") {\r\n  // Extract results from Funnelback response structure\r\n  const results =\r\n    data.response && data.response.resultPacket\r\n      ? data.response.resultPacket.results\r\n      : [];\r\n\r\n  // Map to card template format\r\n  const mappedResults = results.map((result) => ({\r\n    title: result.title || \"\",\r\n    summary: result.summary || \"\",\r\n    listMetadata: result.listMetadata || {},\r\n    date: result.date\r\n      ? new Date(result.date).toLocaleDateString(\"en-AU\", {\r\n          year: \"numeric\",\r\n          month: \"long\",\r\n        })\r\n      : \"\",\r\n    liveUrl: result.liveUrl || \"\",\r\n    rank: result.rank || 0,\r\n    score: result.score || 0,\r\n  }));\r\n\r\n  console.log(`Rendering ${mappedResults.length} cards from ${source}`);\r\n\r\n  // Store results for filtering/sorting\r\n  storeResults(mappedResults);\r\n\r\n  // Cache results for offline search\r\n  window.aikbSearchCache = mappedResults;\r\n  console.log(`Cached ${mappedResults.length} results for offline search`);\r\n\r\n  // Initialize dropdowns with work area data\r\n  initializeDropdowns(mappedResults);\r\n\r\n  // Initialize filter and sort listeners (only once)\r\n  if (source === \"fallback\") {\r\n    initializeFiltersAndSort();\r\n  }\r\n\r\n  // Render cards using the template\r\n  renderResults(mappedResults, \"search-results-list\");\r\n}\r\n\r\n// Wait for complete page load (not just DOM ready)\r\nwindow.addEventListener(\"load\", function () {\r\n  console.log(\"Page load event fired, loading initial results...\");\r\n  // Extra delay after full page load to ensure all scripts initialized\r\n  setTimeout(loadInitialResults, 200);\r\n});\r\n", "/**\r\n * Offline Search Module\r\n *\r\n * Provides client-side search functionality when Funnelback API is unavailable.\r\n * Uses cached search results stored in window.aikbSearchCache.\r\n */\r\n\r\n/**\r\n * Search through locally cached data using keywords\r\n *\r\n * Scoring algorithm:\r\n * - Title matches: 3 points per occurrence (prioritized)\r\n * - Summary matches: 1 point per occurrence\r\n * - Metadata matches: 2 points per keyword match\r\n *\r\n * @param {string} keywords - Search keywords entered by user\r\n * @param {Array} results - Cached search results to filter\r\n * @returns {Array} Filtered and scored results, sorted by relevance\r\n */\r\nexport function searchLocalData(keywords, results) {\r\n  if (!keywords || !results || results.length === 0) {\r\n    console.log(\"Offline search: No keywords or no cached results available\");\r\n    return [];\r\n  }\r\n\r\n  // Normalize keywords for matching\r\n  const normalizedKeywords = keywords\r\n    .toLowerCase()\r\n    .replace(/[^\\w\\s]/g, \"\") // Remove special characters\r\n    .trim();\r\n\r\n  if (!normalizedKeywords) {\r\n    console.log(\"Offline search: Keywords empty after normalization\");\r\n    return [];\r\n  }\r\n\r\n  console.log(\r\n    `Offline search: Searching for \"${keywords}\" in ${results.length} cached results`\r\n  );\r\n\r\n  // Create regex pattern for matching\r\n  const keywordPattern = new RegExp(normalizedKeywords, \"gi\");\r\n\r\n  // Score each result\r\n  const scoredResults = results.map((result) => {\r\n    let score = 0;\r\n    let titleMatches = 0;\r\n    let summaryMatches = 0;\r\n    let metadataMatches = 0;\r\n\r\n    // Score title matches (weight: 3)\r\n    if (result.title) {\r\n      const titleText = result.title.toLowerCase().replace(/[^\\w\\s]/g, \"\");\r\n      const matches = titleText.match(keywordPattern);\r\n      if (matches) {\r\n        titleMatches = matches.length;\r\n        score += titleMatches * 3;\r\n      }\r\n    }\r\n\r\n    // Score summary matches (weight: 1)\r\n    if (result.summary) {\r\n      const summaryText = result.summary.toLowerCase().replace(/[^\\w\\s]/g, \"\");\r\n      const matches = summaryText.match(keywordPattern);\r\n      if (matches) {\r\n        summaryMatches = matches.length;\r\n        score += summaryMatches * 1;\r\n      }\r\n    }\r\n\r\n    // Score metadata matches (weight: 2)\r\n    if (result.metadata) {\r\n      const metadataText = result.metadata\r\n        .toLowerCase()\r\n        .replace(/[^\\w\\s]/g, \"\");\r\n      const matches = metadataText.match(keywordPattern);\r\n      if (matches) {\r\n        metadataMatches = matches.length;\r\n        score += metadataMatches * 2;\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...result,\r\n      _offlineScore: score,\r\n      _offlineMatches: {\r\n        title: titleMatches,\r\n        summary: summaryMatches,\r\n        metadata: metadataMatches,\r\n      },\r\n    };\r\n  });\r\n\r\n  // Filter out results with no matches (score = 0)\r\n  const matchedResults = scoredResults.filter(\r\n    (result) => result._offlineScore > 0\r\n  );\r\n\r\n  // Sort by score descending (highest score first)\r\n  matchedResults.sort((a, b) => b._offlineScore - a._offlineScore);\r\n\r\n  console.log(\r\n    `Offline search: Found ${matchedResults.length} results matching \"${keywords}\"`\r\n  );\r\n\r\n  // Log top 3 results for debugging\r\n  if (matchedResults.length > 0) {\r\n    console.log(\"Offline search: Top results:\");\r\n    matchedResults.slice(0, 3).forEach((result, index) => {\r\n      console.log(\r\n        `  ${index + 1}. \"${result.title}\" (score: ${\r\n          result._offlineScore\r\n        }, title:${result._offlineMatches.title}, summary:${\r\n          result._offlineMatches.summary\r\n        }, metadata:${result._offlineMatches.metadata})`\r\n      );\r\n    });\r\n  }\r\n\r\n  return matchedResults;\r\n}\r\n\r\n/**\r\n * Get cached search data from global scope\r\n *\r\n * @returns {Array|null} Cached results or null if not available\r\n */\r\nexport function getCachedData() {\r\n  if (window.aikbSearchCache && Array.isArray(window.aikbSearchCache)) {\r\n    console.log(\r\n      `Offline search: Retrieved ${window.aikbSearchCache.length} cached results`\r\n    );\r\n    return window.aikbSearchCache;\r\n  }\r\n\r\n  console.log(\"Offline search: No cached data available\");\r\n  return null;\r\n}\r\n", "/**\r\n * Search Form Handler\r\n * Wires the #policy-search-form submission to trigger Funnelback API calls\r\n * and populate #search-results-list with results\r\n */\r\n\r\nimport { loadInitialResults } from \"./load-initial-results.js\";\r\nimport { renderResults } from \"./search-card-template.js\";\r\nimport { searchLocalData, getCachedData } from \"./offline-search.js\";\r\nimport { storeResults } from \"./search-filters.js\";\r\nimport { initializeDropdowns } from \"./populate-dropdowns.js\";\r\n\r\n(function initSearchForm() {\r\n  // Only initialize if jQuery is available\r\n  if (typeof window.$ === \"undefined\") {\r\n    console.warn(\"jQuery not loaded; search form handler disabled\");\r\n    return;\r\n  }\r\n\r\n  const $form = window.$(\"#policy-search-form\");\r\n  const $searchInput = window.$(\"#search\");\r\n\r\n  if ($form.length === 0) {\r\n    console.error(\"Form #policy-search-form not found\");\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Extract search parameters from form\r\n   * @returns {Object} Search parameters {query, area, ...}\r\n   */\r\n  function getSearchParams() {\r\n    return {\r\n      query: $searchInput.val() || \"\",\r\n      area: window.$(\"#document_type\").val() || \"\",\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Handle form submission\r\n   * Prevent default navigation and trigger API search\r\n   */\r\n  function handleFormSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    const params = getSearchParams();\r\n\r\n    // If search is empty, reload initial results (top items)\r\n    if (!params.query.trim()) {\r\n      console.log(\"Empty search - reloading initial results\");\r\n      loadInitialResults();\r\n      return;\r\n    }\r\n\r\n    // Perform offline search immediately for fast results\r\n    const cachedData = getCachedData();\r\n    if (cachedData && cachedData.length > 0) {\r\n      console.log(\"Performing immediate offline search for fast results\");\r\n      const offlineResults = searchLocalData(params.query, cachedData);\r\n\r\n      // Store and render offline results immediately\r\n      storeResults(offlineResults);\r\n      initializeDropdowns(offlineResults);\r\n      renderResults(offlineResults, \"search-results-list\");\r\n\r\n      console.log(\r\n        `Offline search: Displayed ${offlineResults.length} results (will update with API results)`\r\n      );\r\n    } else {\r\n      // No cached data - show loading state\r\n      const $container = window.$(\"#search-results-list\");\r\n      if ($container.length > 0) {\r\n        $container.html('<div class=\"aikb-loading\">Searching...</div>');\r\n      }\r\n    }\r\n\r\n    // Trigger Funnelback API call in background to update results\r\n    if (\r\n      window.ntgFunnelback &&\r\n      typeof window.ntgFunnelback.callSearchAPI === \"function\"\r\n    ) {\r\n      // Set originalterm and call API\r\n      window.ntgFunnelback.originalterm = params.query;\r\n      window.ntgFunnelback.currentPage = 1;\r\n\r\n      // Pass onError callback (will only trigger if both API and fallback JSON fail)\r\n      window.ntgFunnelback.callSearchAPI(params.query, function (error) {\r\n        // Only show error if we didn't already show offline results\r\n        if (!cachedData || cachedData.length === 0) {\r\n          console.error(\"Search failed and no cached data available\");\r\n          const $container = window.$(\"#search-results-list\");\r\n          if ($container.length > 0) {\r\n            $container.html(\r\n              '<p class=\"aikb-error\">Unable to load search results. Please check your connection and try again.</p>'\r\n            );\r\n          }\r\n        } else {\r\n          console.log(\"API failed but offline results already displayed\");\r\n        }\r\n      });\r\n    } else {\r\n      console.error(\"Funnelback API not initialized\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle clear input button click\r\n   * Clear the search field and reload initial results\r\n   */\r\n  function handleClearInput() {\r\n    $searchInput.val(\"\");\r\n    console.log(\"Search cleared - reloading initial results\");\r\n    loadInitialResults();\r\n  }\r\n\r\n  // Attach form submission handler\r\n  $form.on(\"submit\", handleFormSubmit);\r\n\r\n  // Attach clear input handler\r\n  window.$(\"#clear-input\").on(\"click\", handleClearInput);\r\n\r\n  // Show/hide clear button based on input state\r\n  $searchInput.on(\"input\", function () {\r\n    const $clearBtn = window.$(\"#clear-input\");\r\n    if (window.$(this).val().length > 0) {\r\n      $clearBtn.attr(\"hidden\", false);\r\n    } else {\r\n      $clearBtn.attr(\"hidden\", \"\");\r\n    }\r\n  });\r\n\r\n  console.log(\"Search form handler initialized\");\r\n})();\r\n", "// Entry point: bundle search logic for in-page Funnelback search\r\nimport \"./ntg-funnelback.js\";\r\nimport \"./cta-button-alias.js\";\r\nimport \"./search-card-template.js\";\r\nimport \"./search-form-handler.js\";\r\nimport \"./load-initial-results.js\";\r\nimport \"./populate-dropdowns.js\";\r\nimport \"./search-filters.js\";\r\nimport \"./offline-search.js\";\r\nimport \"./multi-select-dropdown.js\";\r\n"],
  "mappings": "2mBAAA,IAAAA,EAAA,GAAAC,GAAAD,EAAA,mBAAAE,IAOA,SAASC,GAAWC,EAAS,CAC3B,GAAI,CAACA,EAAS,MAAO,GAIrB,GADyB,sBACJ,KAAKA,CAAO,EAC/B,OAAOA,EAIT,GAAI,CACF,IAAMC,EAAO,IAAI,KAAKD,CAAO,EAC7B,GAAI,CAAC,MAAMC,EAAK,QAAQ,CAAC,EAevB,MAAO,GAdQ,CACb,UACA,WACA,QACA,QACA,MACA,OACA,OACA,SACA,YACA,UACA,WACA,UACF,EACiBA,EAAK,SAAS,CAAC,CAAC,IAAIA,EAAK,YAAY,CAAC,EAE3D,MAAY,CAEZ,CAEA,OAAOD,CACT,CAaA,SAASE,GAAiBC,EAAQ,CAEhC,GAAI,CAACA,EAAO,OAAS,CAACA,EAAO,SAAW,CAACA,EAAO,QAC9C,eAAQ,KAAK,8CAA+CA,CAAM,EAC3D,KAIT,IAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,mBAGjB,IAAMC,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAY,0BAGlB,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,4BAGpB,IAAMC,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,yBAGxB,IAAMC,EAAQ,SAAS,cAAc,IAAI,EACzCA,EAAM,UAAY,0BAClBA,EAAM,YAAcL,EAAO,MAC3BI,EAAY,YAAYC,CAAK,EAG7B,IAAMC,EAAU,SAAS,cAAc,GAAG,EAC1CA,EAAQ,UAAY,4BACpBA,EAAQ,YAAcN,EAAO,QAC7BI,EAAY,YAAYE,CAAO,EAE/BH,EAAQ,YAAYC,CAAW,EAG/B,IAAMG,EACJP,EAAO,cAAgBA,EAAO,aAAa,QACvCA,EAAO,aAAa,QAAQ,CAAC,EAC7B,KACN,GAAIO,EAAU,CACZ,IAAMC,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,UAAY,yBAGPD,EAAS,MAAM,GAAG,EAC1B,QAASE,GAAQ,CAC1B,IAAMC,EAAaD,EAAI,KAAK,EAC5B,GAAIC,EAAY,CACd,IAAMC,EAAM,SAAS,cAAc,KAAK,EACxCA,EAAI,UAAY,wBAChBA,EAAI,YAAcD,EAClBF,EAAc,YAAYG,CAAG,CAC/B,CACF,CAAC,EAEDR,EAAQ,YAAYK,CAAa,CACnC,CAEAN,EAAM,YAAYC,CAAO,EAGzB,IAAMS,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAY,4BAGpB,IAAMC,EAAS,SAAS,cAAc,GAAG,EACzCA,EAAO,KAAOb,EAAO,QACrBa,EAAO,UAAY,+BAEnB,IAAMC,EAAa,SAAS,cAAc,MAAM,EAChDA,EAAW,YAAc,WACzBD,EAAO,YAAYC,CAAU,EAE7B,IAAMC,EAAO,SAAS,cAAc,MAAM,EAC1CA,EAAK,UAAY,0BACjBA,EAAK,aAAa,cAAe,MAAM,EACvCF,EAAO,YAAYE,CAAI,EAEvBH,EAAQ,YAAYC,CAAM,EAG1B,IAAMG,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,UAAY,6BAGrB,IAAMC,EACJjB,EAAO,cAAgBA,EAAO,aAAa,QACvCA,EAAO,aAAa,QAAQ,CAAC,EAC7B,KACN,GAAIiB,EAAW,CACb,IAAMC,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAY,+BAEtB,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,UAAY,iCAClBA,EAAM,YAAc,eACpBD,EAAU,YAAYC,CAAK,EAE3B,IAAMC,EAAQ,SAAS,cAAc,MAAM,EAC3CA,EAAM,UAAY,iCAClBA,EAAM,YAAcH,EACpBC,EAAU,YAAYE,CAAK,EAE3BJ,EAAS,YAAYE,CAAS,CAChC,CAGA,GAAIlB,EAAO,KAAM,CACf,IAAMqB,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAY,yBACnBA,EAAO,YAAc,cAAczB,GAAWI,EAAO,IAAI,CAAC,GAC1DgB,EAAS,YAAYK,CAAM,CAC7B,CAEA,OAAAT,EAAQ,YAAYI,CAAQ,EAC5Bd,EAAM,YAAYU,CAAO,EAEzBX,EAAK,YAAYC,CAAK,EAEfD,CACT,CAOO,SAASN,EAAc2B,EAASC,EAAc,sBAAuB,CAC1E,QAAQ,IACN,6BAA6BD,EAAQ,MAAM,2BAA2BC,CAAW,EACnF,EAGA,IAAIC,EAAY,SAAS,eAAeD,CAAW,EAGnD,GAFA,QAAQ,IAAI,4BAA4BA,CAAW,MAAOC,CAAS,EAE/D,CAACA,EAAW,CAEd,IAAMC,EAAa,OAAO,EAAI,OAAO,EAAE,IAAIF,CAAW,EAAE,EAAI,KAC5D,QAAQ,IAAI,uBAAuBA,CAAW,MAAOE,CAAU,EAC/DD,EAAYC,GAAcA,EAAW,OAAS,EAAIA,EAAW,CAAC,EAAI,IACpE,CAEA,GAAI,CAACD,EAAW,CACd,QAAQ,MAAM,cAAcD,CAAW,YAAY,EACnD,QAAQ,IACN,8BACA,MAAM,KAAK,SAAS,iBAAiB,MAAM,CAAC,EAAE,IAAKG,GAAOA,EAAG,EAAE,CACjE,EACA,MACF,CAGAF,EAAU,UAAY,GAGtB,IAAMG,EAAQL,EACX,IAAKtB,GAAWD,GAAiBC,CAAM,CAAC,EACxC,OAAQC,GAASA,IAAS,IAAI,EAEjC,GAAI0B,EAAM,SAAW,EAAG,CACtB,IAAMC,EAAY,SAAS,cAAc,GAAG,EAC5CA,EAAU,YAAc,oBACxBA,EAAU,MAAM,QAAU,YAC1BJ,EAAU,YAAYI,CAAS,EAC/B,MACF,CAEAD,EAAM,QAAS1B,GAASuB,EAAU,YAAYvB,CAAI,CAAC,EAEnD,QAAQ,IAAI,YAAY0B,EAAM,MAAM,sBAAsB,CAC5D,CApOA,IAAAE,EAAAC,EAAA,KAuOA,OAAO,kBAAoBnC,ICuGpB,SAASoC,EAAgBC,EAAU,CACxC,IAAMC,EACJ,OAAOD,GAAa,SAAW,SAAS,cAAcA,CAAQ,EAAIA,EAEpE,OAAKC,EAKE,IAAIC,EAAoBD,CAAO,GAJpC,QAAQ,KAAK,kCAAmCD,CAAQ,EACjD,KAIX,CAxVA,IAKaE,EALbC,EAAAC,EAAA,KAKaF,EAAN,KAA0B,CAC/B,YAAYG,EAAe,CACzB,KAAK,cAAgBA,EACrB,KAAK,QAAU,CAAC,EAChB,KAAK,eAAiB,IAAI,IAC1B,KAAK,mBAAqB,IAAI,IAC9B,KAAK,OAAS,GAEd,KAAK,UAAY,KACjB,KAAK,cAAgB,KACrB,KAAK,cAAgB,KAErB,KAAK,KAAK,CACZ,CAEA,MAAO,CAEL,KAAK,cAAc,MAAM,QAAU,OAGnC,KAAK,wBAAwB,EAG7B,KAAK,WAAW,EAGhB,KAAK,UAAU,sBAAwB,IACzC,CAEA,yBAA0B,CAExB,KAAK,UAAY,SAAS,cAAc,KAAK,EAC7C,KAAK,UAAU,UAAY,6BAG3B,KAAK,cAAgB,SAAS,cAAc,QAAQ,EACpD,KAAK,cAAc,KAAO,SAC1B,KAAK,cAAc,UAAY,0BAC/B,KAAK,cAAc,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA,MAQ/B,KAAK,cAAgB,SAAS,cAAc,KAAK,EACjD,KAAK,cAAc,UAAY,yBAC/B,KAAK,cAAc,MAAM,QAAU,OAGnC,IAAMC,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,UAAY,2BAGxB,IAAMC,EAAgB,KAAK,iBAAiB,CAC1C,MAAO,cACP,MAAO,aACP,YAAa,EACf,CAAC,EACDD,EAAY,YAAYC,CAAa,EAGrC,MAAM,KAAK,KAAK,cAAc,OAAO,EAAE,QAASC,GAAW,CACzD,GAAI,CAACA,EAAO,UAAYA,EAAO,MAAO,CACpC,KAAK,QAAQ,KAAK,CAChB,MAAOA,EAAO,MACd,MAAOA,EAAO,WAChB,CAAC,EAED,IAAMC,EAAa,KAAK,iBAAiB,CACvC,MAAOD,EAAO,MACd,MAAOA,EAAO,WAChB,CAAC,EACDF,EAAY,YAAYG,CAAU,CACpC,CACF,CAAC,EAGD,IAAMC,EAAmB,SAAS,cAAc,KAAK,EACrDA,EAAiB,UAAY,2BAE7B,IAAMC,EAAW,SAAS,cAAc,QAAQ,EAChDA,EAAS,KAAO,SAChBA,EAAS,UAAY,+CACrBA,EAAS,YAAc,KACvBA,EAAS,iBAAiB,QAAS,IAAM,KAAK,SAAS,CAAC,EAExD,IAAMC,EAAe,SAAS,cAAc,QAAQ,EACpDA,EAAa,KAAO,SACpBA,EAAa,UAAY,mDACzBA,EAAa,YAAc,SAC3BA,EAAa,iBAAiB,QAAS,IAAM,KAAK,aAAa,CAAC,EAEhEF,EAAiB,YAAYC,CAAQ,EACrCD,EAAiB,YAAYE,CAAY,EAGzC,KAAK,cAAc,YAAYN,CAAW,EAC1C,KAAK,cAAc,YAAYI,CAAgB,EAG/C,KAAK,UAAU,YAAY,KAAK,aAAa,EAC7C,KAAK,UAAU,YAAY,KAAK,aAAa,EAG7C,KAAK,cAAc,WAAW,aAC5B,KAAK,UACL,KAAK,cAAc,WACrB,CACF,CAEA,iBAAiBF,EAAQ,CACvB,IAAMK,EAAO,SAAS,cAAc,OAAO,EAC3CA,EAAK,UAAY,0BACbL,EAAO,aACTK,EAAK,UAAU,IAAI,6BAA6B,EAGlD,IAAMC,EAAW,SAAS,cAAc,OAAO,EAC/CA,EAAS,KAAO,WAChBA,EAAS,UAAY,4BACrBA,EAAS,MAAQN,EAAO,MACxBM,EAAS,QAAQ,MAAQN,EAAO,MAE5BA,EAAO,YACTM,EAAS,iBAAiB,SAAWC,GAAM,KAAK,gBAAgBA,CAAC,CAAC,EAElED,EAAS,iBAAiB,SAAU,IAAM,KAAK,qBAAqB,CAAC,EAGvE,IAAME,EAAY,SAAS,cAAc,MAAM,EAC/C,OAAAA,EAAU,UAAY,yBACtBA,EAAU,YAAcR,EAAO,MAE/BK,EAAK,YAAYC,CAAQ,EACzBD,EAAK,YAAYG,CAAS,EAEnBH,CACT,CAEA,YAAa,CAEX,KAAK,cAAc,iBAAiB,QAAUE,GAAM,CAClDA,EAAE,gBAAgB,EAClB,KAAK,OAAO,CACd,CAAC,EAGD,SAAS,iBAAiB,QAAUA,GAAM,CACpC,CAAC,KAAK,UAAU,SAASA,EAAE,MAAM,GAAK,KAAK,QAC7C,KAAK,aAAa,CAEtB,CAAC,CACH,CAEA,QAAS,CACH,KAAK,OACP,KAAK,MAAM,EAEX,KAAK,KAAK,CAEd,CAEA,MAAO,CACL,KAAK,OAAS,GACd,KAAK,cAAc,MAAM,QAAU,QACnC,KAAK,cAAc,UAAU,IAAI,uBAAuB,EAGxD,KAAK,mBAAqB,IAAI,IAAI,KAAK,cAAc,EAGrD,KAAK,iBAAiB,CACxB,CAEA,OAAQ,CACN,KAAK,OAAS,GACd,KAAK,cAAc,MAAM,QAAU,OACnC,KAAK,cAAc,UAAU,OAAO,uBAAuB,CAC7D,CAEA,UAAW,CAET,IAAME,EAAa,KAAK,cAAc,iBACpC,uDACF,EACA,KAAK,eAAe,MAAM,EAE1BA,EAAW,QAASH,GAAa,CAC3BA,EAAS,SACX,KAAK,eAAe,IAAIA,EAAS,KAAK,CAE1C,CAAC,EAGD,KAAK,kBAAkB,EAGvB,KAAK,cAAc,EAGnB,KAAK,MAAM,CACb,CAEA,cAAe,CAEb,KAAK,mBAAqB,IAAI,IAAI,KAAK,cAAc,EACrD,KAAK,iBAAiB,EAGtB,KAAK,MAAM,CACb,CAEA,gBAAgBC,EAAG,CACjB,IAAMG,EAAYH,EAAE,OAAO,QACR,KAAK,cAAc,iBACpC,uDACF,EAEW,QAASD,GAAa,CAC/BA,EAAS,QAAUI,CACrB,CAAC,CACH,CAEA,sBAAuB,CACrB,IAAMC,EAAoB,KAAK,cAAc,cAC3C,iDACF,EACMF,EAAa,KAAK,cAAc,iBACpC,uDACF,EACMG,EAAe,MAAM,KAAKH,CAAU,EAAE,OACzCI,GAAOA,EAAG,OACb,EAAE,OAEEF,IACFA,EAAkB,QAAUC,IAAiBH,EAAW,OACxDE,EAAkB,cAChBC,EAAe,GAAKA,EAAeH,EAAW,OAEpD,CAEA,kBAAmB,CACE,KAAK,cAAc,iBACpC,uDACF,EAEW,QAASH,GAAa,CAC/BA,EAAS,QAAU,KAAK,mBAAmB,IAAIA,EAAS,KAAK,CAC/D,CAAC,EAED,KAAK,qBAAqB,CAC5B,CAEA,mBAAoB,CAClB,IAAMQ,EAAc,KAAK,cAAc,cACrC,wBACF,EAEA,GAAI,KAAK,eAAe,OAAS,EAC/BA,EAAY,YAAc,iBAC1BA,EAAY,UAAU,OAAO,gCAAgC,UACpD,KAAK,eAAe,OAAS,KAAK,QAAQ,OACnDA,EAAY,YAAc,eAC1BA,EAAY,UAAU,IAAI,gCAAgC,MACrD,CACL,IAAMC,EAAiB,MAAM,KAAK,KAAK,cAAc,EAAE,IAAKC,GAAU,CACpE,IAAMhB,EAAS,KAAK,QAAQ,KAAMiB,GAAQA,EAAI,QAAUD,CAAK,EAC7D,OAAOhB,EAASA,EAAO,MAAQgB,CACjC,CAAC,EAEG,KAAK,eAAe,MAAQ,EAC9BF,EAAY,YAAcC,EAAe,KAAK,IAAI,EAElDD,EAAY,YAAc,GAAG,KAAK,eAAe,IAAI,YAEvDA,EAAY,UAAU,IAAI,gCAAgC,CAC5D,CACF,CAEA,eAAgB,CAEd,IAAMI,EAAQ,IAAI,YAAY,qBAAsB,CAClD,OAAQ,CACN,OAAQ,MAAM,KAAK,KAAK,cAAc,CACxC,CACF,CAAC,EACD,KAAK,UAAU,cAAcA,CAAK,EAElC,QAAQ,IAAI,wBAAyB,MAAM,KAAK,KAAK,cAAc,CAAC,CACtE,CAEA,mBAAoB,CAClB,OAAO,MAAM,KAAK,KAAK,cAAc,CACvC,CAEA,OAAQ,CACN,KAAK,eAAe,MAAM,EAC1B,KAAK,mBAAmB,MAAM,EAC9B,KAAK,kBAAkB,EACvB,KAAK,iBAAiB,CACxB,CAEA,SAAU,CAEJ,KAAK,WAAa,KAAK,UAAU,YACnC,KAAK,UAAU,WAAW,YAAY,KAAK,SAAS,EAIlD,KAAK,gBACP,KAAK,cAAc,MAAM,QAAU,IAIrC,KAAK,UAAY,KACjB,KAAK,cAAgB,KACrB,KAAK,cAAgB,KAErB,QAAQ,IAAI,iCAAiC,CAC/C,CACF,IC7TA,SAASC,GAAiBC,EAAS,CACjC,IAAMC,EAAc,IAAI,IAExB,OAAAD,EAAQ,QAASE,GAAW,CAExBA,EAAO,cACPA,EAAO,aAAa,SACpBA,EAAO,aAAa,QAAQ,CAAC,GAEZA,EAAO,aAAa,QAAQ,CAAC,EAErC,MAAM,GAAG,EAAE,QAASC,GAAS,CACpC,IAAMC,EAAUD,EAAK,KAAK,EACtBC,GACFH,EAAY,IAAIG,CAAO,CAE3B,CAAC,CAEL,CAAC,EAGM,MAAM,KAAKH,CAAW,EAAE,KAAK,CAACI,EAAGC,IAElCD,IAAM,iBAAyB,GAC/BC,IAAM,iBAAyB,EAC5BD,EAAE,cAAcC,CAAC,CACzB,CACH,CAMA,SAASC,GAAyBC,EAAW,CAC3C,IAAMC,EAAW,SAAS,eAAe,eAAe,EACxD,GAAI,CAACA,EAAU,CACb,QAAQ,KAAK,6CAA6C,EAC1D,MACF,CAGAA,EAAS,UAAY,GAGrB,IAAMC,EAAgB,SAAS,cAAc,QAAQ,EACrDA,EAAc,MAAQ,GACtBA,EAAc,YAAc,qBAC5BA,EAAc,SAAW,GACzBA,EAAc,SAAW,GACzBD,EAAS,YAAYC,CAAa,EAGlCF,EAAU,QAASG,GAAa,CAC9B,IAAMC,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,MAAQD,EACfC,EAAO,YAAcD,EACrBF,EAAS,YAAYG,CAAM,CAC7B,CAAC,EAED,QAAQ,IAAI,qCAAqCJ,EAAU,MAAM,UAAU,EAGvEK,IAEFA,EAAoB,QAAQ,EAC5BA,EAAsB,OAKtB,CAACJ,EAAS,oBACV,CAACA,EAAS,mBAAmB,UAAU,SACrC,4BACF,KAEAI,EAAsBC,EAAgBL,CAAQ,EAElD,CAKA,SAASM,IAAuB,CAC9B,IAAMN,EAAW,SAAS,eAAe,OAAO,EAChD,GAAI,CAACA,EAAU,CACb,QAAQ,KAAK,gCAAgC,EAC7C,MACF,CAGAA,EAAS,UAAY,GAGrB,IAAMO,EAAc,CAClB,CAAE,MAAO,YAAa,MAAO,YAAa,SAAU,EAAK,EACzD,CAAE,MAAO,cAAe,MAAO,qBAAsB,EACrD,CAAE,MAAO,cAAe,MAAO,qBAAsB,EACrD,CAAE,MAAO,WAAY,MAAO,aAAc,EAC1C,CAAE,MAAO,WAAY,MAAO,aAAc,CAC5C,EAGAA,EAAY,QAASC,GAAQ,CAC3B,IAAML,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,MAAQK,EAAI,MACnBL,EAAO,YAAcK,EAAI,MACrBA,EAAI,WAAUL,EAAO,SAAW,IACpCH,EAAS,YAAYG,CAAM,CAC7B,CAAC,EAED,QAAQ,IAAI,gCAAgCI,EAAY,MAAM,UAAU,CAC1E,CAKA,SAASE,IAAmB,CAE1B,IAAMC,EAAmB,SAAS,eAAe,eAAe,EAChE,GACEA,GACA,CAACA,EAAiB,cAAc,cAAc,qBAAqB,EACnE,CACA,IAAMC,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,qBACjBA,EAAK,aAAa,cAAe,UAAU,EAC3CA,EAAK,UACH,+DAEF,IAAMC,EAAUF,EAAiB,QAAQ,wBAAwB,EACjE,GAAIE,EAAS,CACX,IAAMC,EAAQD,EAAQ,cAAc,sBAAsB,EACtDC,GACFA,EAAM,YAAYF,CAAI,CAE1B,CACF,CAGA,IAAMG,EAAe,SAAS,eAAe,OAAO,EACpD,GACEA,GACA,CAACA,EAAa,cAAc,cAAc,qBAAqB,EAC/D,CACA,IAAMH,EAAO,SAAS,cAAc,KAAK,EACzCA,EAAK,UAAY,qBACjBA,EAAK,aAAa,cAAe,UAAU,EAC3CA,EAAK,UACH,+DAEF,IAAMC,EAAUE,EAAa,QAAQ,wBAAwB,EAC7D,GAAIF,EAAS,CACX,IAAMC,EAAQD,EAAQ,cAAc,sBAAsB,EACtDC,GACFA,EAAM,YAAYF,CAAI,CAE1B,CACF,CACF,CAMO,SAASI,EAAoBxB,EAAS,CAC3C,QAAQ,IAAI,4CAA4C,EAGxD,IAAMQ,EAAYT,GAAiBC,CAAO,EAC1CO,GAAyBC,CAAS,EAGlCO,GAAqB,EAGrBG,GAAiB,EAEjB,QAAQ,IAAI,oCAAoC,CAClD,CA5LA,IAGIL,EAHJY,EAAAC,EAAA,KACAC,IAEId,EAAsB,OCKnB,SAASe,EAAaC,EAAS,CACpCC,EAAaD,EACb,QAAQ,IAAI,UAAUC,EAAW,MAAM,gCAAgC,CACzE,CAOA,SAASC,GAAiBC,EAAmB,CAC3C,MAAI,CAACA,GAAqBA,EAAkB,SAAW,EAC9CF,EAGFA,EAAW,OAAQG,GAAW,CACnC,GACE,CAACA,EAAO,cACR,CAACA,EAAO,aAAa,SACrB,CAACA,EAAO,aAAa,QAAQ,CAAC,EAE9B,MAAO,GAMT,IAAMC,EAHkBD,EAAO,aAAa,QAAQ,CAAC,EAGf,MAAM,GAAG,EAAE,IAAKE,GAASA,EAAK,KAAK,CAAC,EAE1E,OAAOH,EAAkB,KAAMI,GAC7BF,EAAc,SAASE,CAAY,CACrC,CACF,CAAC,CACH,CAQA,SAASC,GAAYR,EAASS,EAAQ,CACpC,IAAMC,EAAS,CAAC,GAAGV,CAAO,EAE1B,OAAQS,EAAQ,CACd,IAAK,YAEHC,EAAO,KAAK,CAACC,EAAGC,IACVD,EAAE,MAAQC,EAAE,KACPD,EAAE,KAAOC,EAAE,KAEhBD,EAAE,OAASC,EAAE,MACRA,EAAE,MAAQD,EAAE,MAEd,CACR,EACD,MAEF,IAAK,cACHD,EAAO,KAAK,CAACC,EAAGC,IAAM,CACpB,IAAMC,EAAQF,EAAE,KAAO,IAAI,KAAKA,EAAE,IAAI,EAAE,QAAQ,EAAI,EAEpD,OADcC,EAAE,KAAO,IAAI,KAAKA,EAAE,IAAI,EAAE,QAAQ,EAAI,GACrCC,CACjB,CAAC,EACD,MAEF,IAAK,cACHH,EAAO,KAAK,CAACC,EAAGC,IAAM,CACpB,IAAMC,EAAQF,EAAE,KAAO,IAAI,KAAKA,EAAE,IAAI,EAAE,QAAQ,EAAI,EAC9CG,EAAQF,EAAE,KAAO,IAAI,KAAKA,EAAE,IAAI,EAAE,QAAQ,EAAI,EACpD,OAAOC,EAAQC,CACjB,CAAC,EACD,MAEF,IAAK,WACHJ,EAAO,KAAK,CAACC,EAAGC,IAAM,CACpB,IAAMG,EAASJ,EAAE,OAAS,GACpBK,EAASJ,EAAE,OAAS,GAC1B,OAAOG,EAAO,cAAcC,CAAM,CACpC,CAAC,EACD,MAEF,IAAK,WACHN,EAAO,KAAK,CAACC,EAAGC,IAAM,CACpB,IAAMG,EAASJ,EAAE,OAAS,GAE1B,OADeC,EAAE,OAAS,IACZ,cAAcG,CAAM,CACpC,CAAC,EACD,MAEF,QAEE,KACJ,CAEA,OAAOL,CACT,CAKA,eAAeO,GAAsB,CACnC,IAAMC,EAAoB,SAAS,cACjC,6BACF,EACMC,EAAe,SAAS,eAAe,OAAO,EAEpD,GAAI,CAACA,EAAc,CACjB,QAAQ,KAAK,yBAAyB,EACtC,MACF,CAGA,IAAIhB,EAAoB,CAAC,EACrBe,GAAqBA,EAAkB,wBACzCf,EACEe,EAAkB,sBAAsB,kBAAkB,GAG9D,IAAME,EAAeD,EAAa,OAAS,YAE3C,QAAQ,IACN,mCAAmChB,EAAkB,KACnD,IACF,CAAC,aAAaiB,CAAY,GAC5B,EAGA,IAAIC,EAAWnB,GAAiBC,CAAiB,EACjD,QAAQ,IAAI,oBAAoBkB,EAAS,MAAM,UAAU,EAGzD,IAAIX,EAASF,GAAYa,EAAUD,CAAY,EAC/C,QAAQ,IAAI,kBAAkBV,EAAO,MAAM,UAAU,EAGrD,GAAM,CAAE,cAAAY,CAAc,EAAI,KAAM,qCAChCA,EAAcZ,EAAQ,qBAAqB,CAC7C,CAKO,SAASa,GAA2B,CACzC,IAAML,EAAoB,SAAS,cACjC,6BACF,EACMC,EAAe,SAAS,eAAe,OAAO,EAEhDD,GACFA,EAAkB,iBAAiB,qBAAsB,UAAY,CACnE,QAAQ,IAAI,gCAAgC,EAC5CD,EAAoB,CACtB,CAAC,EAGCE,GACFA,EAAa,iBAAiB,SAAU,UAAY,CAClD,QAAQ,IAAI,oBAAoB,KAAK,KAAK,EAAE,EAC5CF,EAAoB,CACtB,CAAC,EAGH,QAAQ,IAAI,uCAAuC,CACrD,CA5KA,IAEIhB,EAFJuB,EAAAC,EAAA,KAEIxB,EAAa,CAAC,ICFlB,IAKMyB,EALNC,EAAAC,EAAA,KACAC,IACAC,IACAC,IAEML,EAAgB,CACpB,aAAc,GACd,aAAc,GACd,YAAa,EAEb,SAAU,CACR,YAAa,UACb,QAAS,4DACT,WAAY,kCACZ,aAAc,6BACd,iBAAkB,CAAC,EACnB,SAAU,EACV,kBAAmB,yCACrB,EAEA,WACE,oaAEF,KAAM,SAAUM,EAAOC,EAASC,EAAOC,EAAaC,EAAU,GAAO,CACnE,QAAQ,IAAI,wBAAwB,EAGpC,IAAMC,EAAQ,IAAI,OAAO,aAAc,IAAI,EAC3CL,EAAQA,EAAM,QAAQK,EAAO,EAAE,EAG3BL,IAAU,IAASA,EAAM,KAAK,EAAE,OAAS,IAC3CN,EAAc,aAAeM,EAC7BN,EAAc,YAAc,EAC5BA,EAAc,cAAc,EAEhC,EAEA,cAAe,SAAUM,EAAOM,EAAS,CAEZN,GAAU,OACnCN,EAAc,aAAeM,GAG/B,QAAQ,IACN,0CACAN,EAAc,YAChB,EAGA,IAAMa,EAAY,SAAS,eAAe,qBAAqB,EAC3DA,IACFA,EAAU,UAAY,gDAIxBb,EAAc,YAAY,EAC1B,QAAQ,IAAI,mCAAoCA,EAAc,YAAY,EAG1E,IAAMc,GAAad,EAAc,YAAc,GAAK,GAAK,EAGrDe,EAAQ,GAAGf,EAAc,SAAS,OAAO,eAAeA,EAAc,SAAS,UAAU,GAI7F,GACEA,EAAc,cACdA,EAAc,aAAa,KAAK,EAAE,OAAS,EAC3C,CACAe,GAAS,UAAU,mBAAmBf,EAAc,YAAY,CAAC,GAGjE,IAAMgB,EAAS,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACzDA,EAAO,IAAI,QAAShB,EAAc,YAAY,EAC1CA,EAAc,aAAeA,EAAc,cAAgB,EAC7DgB,EAAO,IAAI,OAAQhB,EAAc,WAAW,EAE5CgB,EAAO,OAAO,MAAM,EAEtB,IAAMC,EACJ,OAAO,SAAS,UACfD,EAAO,SAAS,EAAI,IAAMA,EAAO,SAAS,EAAI,IACjD,OAAO,QAAQ,aAAa,CAAC,EAAG,GAAIC,CAAM,CAC5C,MAEEF,GAAS,MAAM,mBAAmBf,EAAc,SAAS,YAAY,CAAC,GAIxEe,GAAS,4BAA4BD,CAAS,GAE9C,QAAQ,IAAI,0BAA2BC,CAAK,EAE5C,EAAE,KAAK,CACL,IAAKA,EACL,SAAU,OACV,KAAM,MACN,QAAS,SAAUG,EAAS,CAC1BlB,EAAc,eAAekB,CAAO,CACtC,EACA,MAAO,SAAUC,EAAKC,EAAQC,EAAO,CACnC,QAAQ,KAAK,+CAAgDA,CAAK,EAElE,EAAE,KAAK,CACL,IAAK,uBACL,SAAU,OACV,KAAM,MACN,QAAS,SAAUC,EAAc,CAC/B,QAAQ,IAAI,6BAA6B,EACzCtB,EAAc,eAAesB,CAAY,CAC3C,EACA,MAAO,UAAY,CACjB,QAAQ,MAAM,qCAAqC,EAG/C,OAAOV,GAAY,YACrB,QAAQ,IAAI,oCAAoC,EAChDA,EAAQ,IAAI,MAAM,mCAAmC,CAAC,GAC7CC,IACTA,EAAU,UACR,gEAEN,CACF,CAAC,CACH,CACF,CAAC,CACH,EAEA,YAAa,UAAY,CAEvB,GACE,CAACb,EAAc,cACfA,EAAc,aAAa,KAAK,IAAM,GAEtC,OAAAA,EAAc,aAAe,GACtB,GAGT,IAAMuB,EAAYvB,EAAc,WAAW,MAAM,GAAG,EAC9CwB,EAAexB,EAAc,aAAa,KAAK,EAAE,MAAM,GAAG,EAGhE,GAAIwB,EAAa,SAAW,EAC1B,OAAAxB,EAAc,aAAe,GACtB,GAGT,IAAMyB,EAAgB,CAAC,EAEvB,EAAE,KAAKD,EAAc,SAAUE,EAAGC,EAAM,CAClC,EAAE,QAAQA,EAAK,YAAY,EAAGJ,CAAS,IAAM,IAC/CE,EAAc,KAAKE,CAAI,CAE3B,CAAC,EAGD,IAAMhB,EAAQ,IAAI,OAAO,eAAgB,IAAI,EACzCiB,EAAiBH,EAAc,KAAK,GAAG,EAC3CG,EAAiBA,EAAe,QAAQjB,EAAO,EAAE,EAEjDX,EAAc,aAAe4B,CAE/B,EAEA,eAAgB,SAAUV,EAAS,CAEjC,IAAMW,EACJX,EAAQ,UAAYA,EAAQ,SAAS,aACjCA,EAAQ,SAAS,aAAa,QAC9B,CAAC,EAEP,QAAQ,IAAI,cAAcW,EAAQ,MAAM,iBAAiB,EAGzD,IAAMC,EAAe,CACnB,+EACF,EAEMC,EAAkBF,EAAQ,OAAQG,GAC/B,CAACF,EAAa,SAASE,EAAO,OAAO,CAC7C,EAED,QAAQ,IACN,oBAAoBD,EAAgB,MAAM,sBACxCF,EAAQ,OAASE,EAAgB,MACnC,GACF,EAGA,IAAME,EAAgBF,EAAgB,IAAKC,IAAY,CACrD,MAAOA,EAAO,OAAS,GACvB,QAASA,EAAO,SAAW,GAC3B,aAAcA,EAAO,cAAgB,CAAC,EACtC,KAAMA,EAAO,MAAQ,GACrB,QAASA,EAAO,SAAW,GAC3B,KAAMA,EAAO,MAAQ,EACrB,MAAOA,EAAO,OAAS,CACzB,EAAE,EAGFE,EAAaD,CAAa,EAG1BE,EAAoBF,CAAa,EAGjCG,EAAyB,EAGzBC,EAAcJ,EAAe,qBAAqB,EAElD,QAAQ,IACN,iEACF,CACF,CACF,EAGA,OAAO,cAAgBjC,IC5NvB,IAAAsC,EAAAC,EAAA,KACA,IAAMC,GAAe,yDAErB,SAASC,EAAoBC,EAAO,SAAU,CAC5BA,EAAK,iBAAiBF,EAAY,EAC1C,QAASG,GAAW,CAC1BA,EAAO,UAAU,IAAI,WAAY,mBAAmB,CACtD,CAAC,CACH,CAEI,SAAS,aAAe,UAC1B,SAAS,iBAAiB,mBAAoB,IAAMF,EAAoB,CAAC,EAEzEA,EAAoB,ICPf,SAASG,GAAqB,CAEnC,IAAMC,EAAyB,SAAS,eAAe,qBAAqB,EAC5E,GAAI,CAACA,EAAwB,CAC3B,QAAQ,KAAK,iDAAiD,EAC9D,MACF,CAEA,QAAQ,IAAI,uDAAuD,EAGnE,MAAM,sBAAsB,EACzB,KAAMC,GAAa,CAMlB,GALA,QAAQ,IACN,iCACAA,EAAS,OACTA,EAAS,EACX,EACI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAM,uBAAuBA,EAAS,MAAM,EAAE,EAE1D,OAAOA,EAAS,KAAK,CACvB,CAAC,EACA,KAAMC,GAAS,CACd,QAAQ,IAAI,0CAA2CA,CAAI,EAC3DC,EAAwBD,EAAM,UAAU,CAC1C,CAAC,EACA,MAAOE,GAAkB,CACxB,QAAQ,MAAM,sCAAuCA,CAAa,EAClEJ,EAAuB,UACrB,oDACAI,EAAc,QACd,MACJ,CAAC,EAMH,MAFE,mIAEU,EACT,KAAMH,GAAa,CAMlB,GALA,QAAQ,IACN,kCACAA,EAAS,OACTA,EAAS,EACX,EACI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAM,uBAAuBA,EAAS,MAAM,EAAE,EAE1D,OAAOA,EAAS,KAAK,CACvB,CAAC,EACA,KAAMC,GAAS,CACd,QAAQ,IACN,6DACAA,CACF,EACAC,EAAwBD,EAAM,KAAK,CACrC,CAAC,EACA,MAAOG,GAAU,CAChB,QAAQ,KACN,6DACAA,CACF,CAEF,CAAC,CACL,CAEA,SAASF,EAAwBD,EAAMI,EAAS,UAAW,CAQzD,IAAMC,GALJL,EAAK,UAAYA,EAAK,SAAS,aAC3BA,EAAK,SAAS,aAAa,QAC3B,CAAC,GAGuB,IAAKM,IAAY,CAC7C,MAAOA,EAAO,OAAS,GACvB,QAASA,EAAO,SAAW,GAC3B,aAAcA,EAAO,cAAgB,CAAC,EACtC,KAAMA,EAAO,KACT,IAAI,KAAKA,EAAO,IAAI,EAAE,mBAAmB,QAAS,CAChD,KAAM,UACN,MAAO,MACT,CAAC,EACD,GACJ,QAASA,EAAO,SAAW,GAC3B,KAAMA,EAAO,MAAQ,EACrB,MAAOA,EAAO,OAAS,CACzB,EAAE,EAEF,QAAQ,IAAI,aAAaD,EAAc,MAAM,eAAeD,CAAM,EAAE,EAGpEG,EAAaF,CAAa,EAG1B,OAAO,gBAAkBA,EACzB,QAAQ,IAAI,UAAUA,EAAc,MAAM,6BAA6B,EAGvEG,EAAoBH,CAAa,EAG7BD,IAAW,YACbK,EAAyB,EAI3BC,EAAcL,EAAe,qBAAqB,CACpD,CAnHA,IAAAM,EAAAC,EAAA,KACAC,IACAC,IACAC,IAmHA,OAAO,iBAAiB,OAAQ,UAAY,CAC1C,QAAQ,IAAI,mDAAmD,EAE/D,WAAWlB,EAAoB,GAAG,CACpC,CAAC,ICvGM,SAASmB,EAAgBC,EAAUC,EAAS,CACjD,GAAI,CAACD,GAAY,CAACC,GAAWA,EAAQ,SAAW,EAC9C,eAAQ,IAAI,4DAA4D,EACjE,CAAC,EAIV,IAAMC,EAAqBF,EACxB,YAAY,EACZ,QAAQ,WAAY,EAAE,EACtB,KAAK,EAER,GAAI,CAACE,EACH,eAAQ,IAAI,oDAAoD,EACzD,CAAC,EAGV,QAAQ,IACN,kCAAkCF,CAAQ,QAAQC,EAAQ,MAAM,iBAClE,EAGA,IAAME,EAAiB,IAAI,OAAOD,EAAoB,IAAI,EAqDpDE,EAlDgBH,EAAQ,IAAKI,GAAW,CAC5C,IAAIC,EAAQ,EACRC,EAAe,EACfC,EAAiB,EACjBC,EAAkB,EAGtB,GAAIJ,EAAO,MAAO,CAEhB,IAAMK,EADYL,EAAO,MAAM,YAAY,EAAE,QAAQ,WAAY,EAAE,EACzC,MAAMF,CAAc,EAC1CO,IACFH,EAAeG,EAAQ,OACvBJ,GAASC,EAAe,EAE5B,CAGA,GAAIF,EAAO,QAAS,CAElB,IAAMK,EADcL,EAAO,QAAQ,YAAY,EAAE,QAAQ,WAAY,EAAE,EAC3C,MAAMF,CAAc,EAC5CO,IACFF,EAAiBE,EAAQ,OACzBJ,GAASE,EAAiB,EAE9B,CAGA,GAAIH,EAAO,SAAU,CAInB,IAAMK,EAHeL,EAAO,SACzB,YAAY,EACZ,QAAQ,WAAY,EAAE,EACI,MAAMF,CAAc,EAC7CO,IACFD,EAAkBC,EAAQ,OAC1BJ,GAASG,EAAkB,EAE/B,CAEA,MAAO,CACL,GAAGJ,EACH,cAAeC,EACf,gBAAiB,CACf,MAAOC,EACP,QAASC,EACT,SAAUC,CACZ,CACF,CACF,CAAC,EAGoC,OAClCJ,GAAWA,EAAO,cAAgB,CACrC,EAGA,OAAAD,EAAe,KAAK,CAACO,EAAGC,IAAMA,EAAE,cAAgBD,EAAE,aAAa,EAE/D,QAAQ,IACN,yBAAyBP,EAAe,MAAM,sBAAsBJ,CAAQ,GAC9E,EAGII,EAAe,OAAS,IAC1B,QAAQ,IAAI,8BAA8B,EAC1CA,EAAe,MAAM,EAAG,CAAC,EAAE,QAAQ,CAACC,EAAQQ,IAAU,CACpD,QAAQ,IACN,KAAKA,EAAQ,CAAC,MAAMR,EAAO,KAAK,aAC9BA,EAAO,aACT,WAAWA,EAAO,gBAAgB,KAAK,aACrCA,EAAO,gBAAgB,OACzB,cAAcA,EAAO,gBAAgB,QAAQ,GAC/C,CACF,CAAC,GAGID,CACT,CAOO,SAASU,GAAgB,CAC9B,OAAI,OAAO,iBAAmB,MAAM,QAAQ,OAAO,eAAe,GAChE,QAAQ,IACN,6BAA6B,OAAO,gBAAgB,MAAM,iBAC5D,EACO,OAAO,kBAGhB,QAAQ,IAAI,0CAA0C,EAC/C,KACT,CAzIA,IAAAC,EAAAC,EAAA,QCAA,IAAAC,EAAAC,EAAA,KAMAC,IACAC,IACAC,IACAC,IACAC,KAEC,UAA0B,CAEzB,GAAI,OAAO,OAAO,EAAM,IAAa,CACnC,QAAQ,KAAK,iDAAiD,EAC9D,MACF,CAEA,IAAMC,EAAQ,OAAO,EAAE,qBAAqB,EACtCC,EAAe,OAAO,EAAE,SAAS,EAEvC,GAAID,EAAM,SAAW,EAAG,CACtB,QAAQ,MAAM,oCAAoC,EAClD,MACF,CAMA,SAASE,GAAkB,CACzB,MAAO,CACL,MAAOD,EAAa,IAAI,GAAK,GAC7B,KAAM,OAAO,EAAE,gBAAgB,EAAE,IAAI,GAAK,EAC5C,CACF,CAMA,SAASE,EAAiBC,EAAO,CAC/BA,EAAM,eAAe,EAErB,IAAMC,EAASH,EAAgB,EAG/B,GAAI,CAACG,EAAO,MAAM,KAAK,EAAG,CACxB,QAAQ,IAAI,0CAA0C,EACtDC,EAAmB,EACnB,MACF,CAGA,IAAMC,EAAaC,EAAc,EACjC,GAAID,GAAcA,EAAW,OAAS,EAAG,CACvC,QAAQ,IAAI,sDAAsD,EAClE,IAAME,EAAiBC,EAAgBL,EAAO,MAAOE,CAAU,EAG/DI,EAAaF,CAAc,EAC3BG,EAAoBH,CAAc,EAClCI,EAAcJ,EAAgB,qBAAqB,EAEnD,QAAQ,IACN,6BAA6BA,EAAe,MAAM,yCACpD,CACF,KAAO,CAEL,IAAMK,EAAa,OAAO,EAAE,sBAAsB,EAC9CA,EAAW,OAAS,GACtBA,EAAW,KAAK,8CAA8C,CAElE,CAIE,OAAO,eACP,OAAO,OAAO,cAAc,eAAkB,YAG9C,OAAO,cAAc,aAAeT,EAAO,MAC3C,OAAO,cAAc,YAAc,EAGnC,OAAO,cAAc,cAAcA,EAAO,MAAO,SAAUU,EAAO,CAEhE,GAAI,CAACR,GAAcA,EAAW,SAAW,EAAG,CAC1C,QAAQ,MAAM,4CAA4C,EAC1D,IAAMO,EAAa,OAAO,EAAE,sBAAsB,EAC9CA,EAAW,OAAS,GACtBA,EAAW,KACT,sGACF,CAEJ,MACE,QAAQ,IAAI,kDAAkD,CAElE,CAAC,GAED,QAAQ,MAAM,gCAAgC,CAElD,CAMA,SAASE,GAAmB,CAC1Bf,EAAa,IAAI,EAAE,EACnB,QAAQ,IAAI,4CAA4C,EACxDK,EAAmB,CACrB,CAGAN,EAAM,GAAG,SAAUG,CAAgB,EAGnC,OAAO,EAAE,cAAc,EAAE,GAAG,QAASa,CAAgB,EAGrDf,EAAa,GAAG,QAAS,UAAY,CACnC,IAAMgB,EAAY,OAAO,EAAE,cAAc,EACrC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,OAAS,EAChCA,EAAU,KAAK,SAAU,EAAK,EAE9BA,EAAU,KAAK,SAAU,EAAE,CAE/B,CAAC,EAED,QAAQ,IAAI,iCAAiC,CAC/C,GAAG,ICpIH,IAAAC,GAAAC,EAAA,KACAC,IACA,IAAAC,GAAO,OACPC,IACA,IAAAC,GAAO,OACPC,IACAC,IACAC,IACAC,IACAC",
  "names": ["search_card_template_exports", "__export", "renderResults", "formatDate", "dateStr", "date", "createSearchCard", "result", "card", "inner", "content", "textSection", "title", "summary", "category", "tagsContainer", "cat", "trimmedCat", "tag", "actions", "button", "buttonText", "icon", "metadata", "usefulFor", "usefulRow", "label", "value", "dateEl", "results", "containerId", "container", "$container", "el", "cards", "noResults", "init_search_card_template", "__esmMin", "initMultiSelect", "selector", "element", "MultiSelectDropdown", "init_multi_select_dropdown", "__esmMin", "selectElement", "optionsList", "selectAllItem", "option", "optionItem", "actionsContainer", "okButton", "cancelButton", "item", "checkbox", "e", "labelText", "checkboxes", "isChecked", "selectAllCheckbox", "checkedCount", "cb", "textElement", "selectedLabels", "value", "opt", "event", "extractWorkAreas", "results", "workAreaSet", "result", "area", "trimmed", "a", "b", "populateWorkAreaDropdown", "workAreas", "dropdown", "defaultOption", "workArea", "option", "multiSelectInstance", "initMultiSelect", "populateSortDropdown", "sortOptions", "opt", "addDropdownIcons", "workAreaDropdown", "icon", "wrapper", "inner", "sortDropdown", "initializeDropdowns", "init_populate_dropdowns", "__esmMin", "init_multi_select_dropdown", "storeResults", "results", "allResults", "filterByWorkArea", "selectedWorkAreas", "result", "workAreaArray", "area", "selectedArea", "sortResults", "sortBy", "sorted", "a", "b", "dateA", "dateB", "titleA", "titleB", "applyFiltersAndSort", "workAreaContainer", "sortDropdown", "selectedSort", "filtered", "renderResults", "initializeFiltersAndSort", "init_search_filters", "__esmMin", "ntgFunnelback", "init_ntg_funnelback", "__esmMin", "init_search_card_template", "init_populate_dropdowns", "init_search_filters", "query", "doctype", "owner", "corrections", "scopeID", "regex", "onError", "container", "startRank", "fbUrl", "params", "newUrl", "dataset", "xhr", "status", "error", "fallbackData", "noiseList", "searchPhrase", "revisedPhrase", "i", "term", "phraseAsString", "results", "excludedUrls", "filteredResults", "result", "mappedResults", "storeResults", "initializeDropdowns", "initializeFiltersAndSort", "renderResults", "require_cta_button_alias", "__commonJSMin", "CTA_SELECTOR", "applyCtaButtonAlias", "root", "anchor", "loadInitialResults", "searchResultsContainer", "response", "data", "processAndRenderResults", "fallbackError", "error", "source", "mappedResults", "result", "storeResults", "initializeDropdowns", "initializeFiltersAndSort", "renderResults", "init_load_initial_results", "__esmMin", "init_search_card_template", "init_populate_dropdowns", "init_search_filters", "searchLocalData", "keywords", "results", "normalizedKeywords", "keywordPattern", "matchedResults", "result", "score", "titleMatches", "summaryMatches", "metadataMatches", "matches", "a", "b", "index", "getCachedData", "init_offline_search", "__esmMin", "require_search_form_handler", "__commonJSMin", "init_load_initial_results", "init_search_card_template", "init_offline_search", "init_search_filters", "init_populate_dropdowns", "$form", "$searchInput", "getSearchParams", "handleFormSubmit", "event", "params", "loadInitialResults", "cachedData", "getCachedData", "offlineResults", "searchLocalData", "storeResults", "initializeDropdowns", "renderResults", "$container", "error", "handleClearInput", "$clearBtn", "require_index", "__commonJSMin", "init_ntg_funnelback", "import_cta_button_alias", "init_search_card_template", "import_search_form_handler", "init_load_initial_results", "init_populate_dropdowns", "init_search_filters", "init_offline_search", "init_multi_select_dropdown"]
}
