(() => {
  var __create = Object.create;
  var __defProp = Object.defineProperty;
  var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
  var __getOwnPropNames = Object.getOwnPropertyNames;
  var __getProtoOf = Object.getPrototypeOf;
  var __hasOwnProp = Object.prototype.hasOwnProperty;
  var __esm = (fn, res) => function __init() {
    return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
  };
  var __commonJS = (cb, mod) => function __require() {
    return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
  };
  var __copyProps = (to, from, except, desc) => {
    if (from && typeof from === "object" || typeof from === "function") {
      for (let key of __getOwnPropNames(from))
        if (!__hasOwnProp.call(to, key) && key !== except)
          __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
    }
    return to;
  };
  var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
    // If the importer is in node compatibility mode or this is not an ESM
    // file that has been converted to a CommonJS file using a Babel-
    // compatible transform (i.e. "__esModule" has not been set), then set
    // "default" to the CommonJS "module.exports" for node compatibility.
    isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
    mod
  ));

  // src/js/ntg-funnelback.js
  function htmlEscape(text) {
    const map = {
      "&": "&amp;",
      "<": "&lt;",
      ">": "&gt;",
      '"': "&quot;",
      "'": "&#039;"
    };
    return text.replace(/[&<>"']/g, function(m) {
      return map[m];
    });
  }
  var ntgFunnelback;
  var init_ntg_funnelback = __esm({
    "src/js/ntg-funnelback.js"() {
      ntgFunnelback = {
        originalterm: "",
        filteredterm: "",
        currentPage: 1,
        defaults: {
          sourceField: "#search",
          endpointURL: "https://ntgov-search.funnelback.squiz.cloud/s/search.json?collection=ntgov~sp-ntgc-ai-knowledge-base&s=!FunDoesNotExist:PadreNull",
          funnelbackParams: {},
          minChars: 3,
          containerSelector: "#content .inner-page.au-body .container"
        },
        noisewords: "a au all am an and any are as at be been but by can cant co com de do eg else etc for from get go had has hasnt have he hence her here hers him his how http https i ie if in is it its la me my nor not now of off on or our ours pm put re she so than that the their them then there these they this those thus to too uk un until up upon us very via was we well were what when where which while who why www you your yours",
        init: function(query, doctype, owner, corrections, scopeID = false) {
          console.log("Init Funnelback Search");
          const regex = new RegExp("[*<>();/&]", "gi");
          query = query.replace(regex, "");
          if (query !== false) {
            ntgFunnelback.originalterm = query;
            ntgFunnelback.currentPage = 1;
            ntgFunnelback.callSearchAPI();
          }
          $(".search-icon").on("click", function() {
            $("#policy-search-form").trigger("submit");
          });
          $("#policy-search-form").on("submit", function(e) {
            e.preventDefault();
            let sourcefieldval = $(ntgFunnelback.defaults.sourceField).val();
            const regex2 = new RegExp("[*<>();/&]", "gi");
            sourcefieldval = sourcefieldval.replace(regex2, "");
            $(ntgFunnelback.defaults.sourceField).val(sourcefieldval);
            ntgFunnelback.originalterm = sourcefieldval;
            ntgFunnelback.currentPage = 1;
            ntgFunnelback.callSearchAPI();
          });
        },
        callSearchAPI: function() {
          $(ntgFunnelback.defaults.containerSelector).html("");
          ntgFunnelback.filterQuery();
          const hasQueryParamAlready = new URLSearchParams(
            window.location.search
          ).has("query");
          const shouldUpdateQuery = ntgFunnelback.filteredterm && ntgFunnelback.filteredterm.trim().length > 0;
          const shouldUpdatePage = ntgFunnelback.currentPage && ntgFunnelback.currentPage !== 1;
          if (shouldUpdateQuery || shouldUpdatePage || hasQueryParamAlready) {
            const params = new URLSearchParams(window.location.search);
            if (shouldUpdateQuery) {
              params.set("query", ntgFunnelback.filteredterm);
            }
            if (shouldUpdatePage) {
              params.set("page", ntgFunnelback.currentPage);
            } else {
              params.delete("page");
            }
            const newUrl = window.location.pathname + (params.toString() ? "?" + params.toString() : "");
            window.history.replaceState({}, "", newUrl);
          }
          const startRank = (ntgFunnelback.currentPage - 1) * 10 + 1;
          let base = ntgFunnelback.defaults.endpointURL;
          base = base.replace(/start_rank=\d+/, "start_rank=" + startRank);
          const fbUrl = base + "&query=" + encodeURIComponent(ntgFunnelback.filteredterm) + "&num_ranks=10";
          console.log("Calling Funnelback API directly:", fbUrl);
          $.ajax({
            url: fbUrl,
            dataType: "JSON",
            type: "GET",
            success: function(dataset) {
              ntgFunnelback.processResults(dataset);
            },
            error: function(xhr, status, error) {
              console.warn("Funnelback API error, loading fallback data:", error);
              $.ajax({
                url: "src/data/search.json",
                dataType: "JSON",
                type: "GET",
                success: function(fallbackData) {
                  console.log("Loaded fallback search data");
                  ntgFunnelback.processResults(fallbackData);
                },
                error: function() {
                  console.error("Failed to load fallback search data");
                  $(ntgFunnelback.defaults.containerSelector).html(
                    "<p>Unable to load search results. Please try again later.</p>"
                  );
                }
              });
            }
          });
        },
        filterQuery: function() {
          const noiseList = ntgFunnelback.noisewords.split(" ");
          const searchPhrase = ntgFunnelback.originalterm.split(" ");
          if (searchPhrase.length === 0) {
            ntgFunnelback.filteredterm = searchPhrase;
            return false;
          }
          const revisedPhrase = [];
          $.each(searchPhrase, function(i, term) {
            if ($.inArray(term, noiseList) === -1) {
              revisedPhrase.push(term);
            }
          });
          const regex = new RegExp("[*<>{}();/&]", "gi");
          let phraseAsString = revisedPhrase.join(" ");
          phraseAsString = phraseAsString.replace(regex, "");
          ntgFunnelback.filteredterm = phraseAsString;
          return;
        },
        processResults: function(dataset) {
          const results = dataset.response && dataset.response.resultPacket ? dataset.response.resultPacket.results : [];
          const prettyJSON = JSON.stringify(results, null, 2);
          const htmlContent = "<pre><code>" + htmlEscape(prettyJSON) + "</code></pre>";
          const container = document.getElementById("search-results-list");
          if (container) {
            container.innerHTML = htmlContent;
            console.log("JSON output written to #search-results-list");
          } else {
            console.warn(
              "#search-results-list container not found, logging results instead"
            );
            console.log("Funnelback Results:", results);
          }
          console.log("Funnelback Full Response:", dataset);
        }
      };
      window.ntgFunnelback = ntgFunnelback;
    }
  });

  // src/js/cta-button-alias.js
  var require_cta_button_alias = __commonJS({
    "src/js/cta-button-alias.js"() {
      var CTA_SELECTOR = 'div[data-hydration-component="squiz-call-to-action"] a';
      function applyCtaButtonAlias(root = document) {
        const anchors = root.querySelectorAll(CTA_SELECTOR);
        anchors.forEach((anchor) => {
          anchor.classList.add("ntgc-btn", "ntgc-btn--primary");
        });
      }
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", () => applyCtaButtonAlias());
      } else {
        applyCtaButtonAlias();
      }
    }
  });

  // src/js/search-card-template.js
  function formatDate(dateStr) {
    if (!dateStr) return "";
    const monthYearPattern = /^[A-Z][a-z]+ \d{4}$/;
    if (monthYearPattern.test(dateStr)) {
      return dateStr;
    }
    try {
      const date = new Date(dateStr);
      if (!isNaN(date.getTime())) {
        const months = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December"
        ];
        return `${months[date.getMonth()]} ${date.getFullYear()}`;
      }
    } catch (e) {
    }
    return dateStr;
  }
  function createSearchCard(result) {
    if (!result.title || !result.summary || !result.liveUrl) {
      console.warn("Skipping card with missing required fields:", result);
      return null;
    }
    const card = document.createElement("div");
    card.className = "aikb-search-card";
    const inner = document.createElement("div");
    inner.className = "aikb-search-card__inner";
    const content = document.createElement("div");
    content.className = "aikb-search-card__content";
    const textSection = document.createElement("div");
    textSection.className = "aikb-search-card__text";
    const title = document.createElement("h3");
    title.className = "aikb-search-card__title";
    title.textContent = result.title;
    textSection.appendChild(title);
    const summary = document.createElement("p");
    summary.className = "aikb-search-card__summary";
    summary.textContent = result.summary;
    textSection.appendChild(summary);
    content.appendChild(textSection);
    const category = result.listMetadata && result.listMetadata.keyword ? result.listMetadata.keyword[0] : null;
    if (category) {
      const tagsContainer = document.createElement("div");
      tagsContainer.className = "aikb-search-card__tags";
      const categories = category.split(",");
      categories.forEach((cat) => {
        const trimmedCat = cat.trim();
        if (trimmedCat) {
          const tag = document.createElement("div");
          tag.className = "aikb-search-card__tag";
          tag.textContent = trimmedCat;
          tagsContainer.appendChild(tag);
        }
      });
      content.appendChild(tagsContainer);
    }
    inner.appendChild(content);
    const actions = document.createElement("div");
    actions.className = "aikb-search-card__actions";
    const button = document.createElement("a");
    button.href = result.liveUrl;
    button.className = "ntgc-btn ntgc-btn--secondary";
    const buttonText = document.createElement("span");
    buttonText.textContent = "See more";
    button.appendChild(buttonText);
    const icon = document.createElement("span");
    icon.className = "fal fa-long-arrow-right";
    icon.setAttribute("aria-hidden", "true");
    button.appendChild(icon);
    actions.appendChild(button);
    const metadata = document.createElement("div");
    metadata.className = "aikb-search-card__metadata";
    const usefulFor = result.listMetadata && result.listMetadata.keyword ? result.listMetadata.keyword[1] : null;
    if (usefulFor) {
      const usefulRow = document.createElement("div");
      usefulRow.className = "aikb-search-card__useful-for";
      const label = document.createElement("span");
      label.className = "aikb-search-card__useful-label";
      label.textContent = "Useful for: ";
      usefulRow.appendChild(label);
      const value = document.createElement("span");
      value.className = "aikb-search-card__useful-value";
      value.textContent = usefulFor;
      usefulRow.appendChild(value);
      metadata.appendChild(usefulRow);
    }
    if (result.date) {
      const dateEl = document.createElement("div");
      dateEl.className = "aikb-search-card__date";
      dateEl.textContent = `Submitted: ${formatDate(result.date)}`;
      metadata.appendChild(dateEl);
    }
    actions.appendChild(metadata);
    inner.appendChild(actions);
    card.appendChild(inner);
    return card;
  }
  function renderResults(results, containerId = "search-results-list") {
    console.log(
      `renderResults called with ${results.length} results for container #${containerId}`
    );
    let container = document.getElementById(containerId);
    console.log(`document.getElementById("${containerId}"):`, container);
    if (!container) {
      const $container = window.$ ? window.$(`#${containerId}`) : null;
      console.log(`jQuery selector $("#${containerId}"):`, $container);
      container = $container && $container.length > 0 ? $container[0] : null;
    }
    if (!container) {
      console.error(`Container #${containerId} not found`);
      console.log(
        "Available elements with id:",
        Array.from(document.querySelectorAll("[id]")).map((el) => el.id)
      );
      return;
    }
    container.innerHTML = "";
    const cards = results.map((result) => createSearchCard(result)).filter((card) => card !== null);
    if (cards.length === 0) {
      const noResults = document.createElement("p");
      noResults.textContent = "No results found.";
      noResults.style.padding = "24px 48px";
      container.appendChild(noResults);
      return;
    }
    cards.forEach((card) => container.appendChild(card));
    console.log(`Rendered ${cards.length} search result cards`);
  }
  var init_search_card_template = __esm({
    "src/js/search-card-template.js"() {
      window.aikbRenderResults = renderResults;
    }
  });

  // src/js/search-form-handler.js
  var require_search_form_handler = __commonJS({
    "src/js/search-form-handler.js"() {
      (function initSearchForm() {
        if (typeof window.$ === "undefined") {
          console.warn("jQuery not loaded; search form handler disabled");
          return;
        }
        const $form = window.$("#policy-search-form");
        const $searchInput = window.$("#search");
        if ($form.length === 0) {
          console.error("Form #policy-search-form not found");
          return;
        }
        function getSearchParams() {
          return {
            query: $searchInput.val() || "",
            area: window.$("#select-input-2").val() || ""
          };
        }
        function handleFormSubmit(event) {
          event.preventDefault();
          const params = getSearchParams();
          if (!params.query.trim()) {
            console.warn("Search query is empty");
            return;
          }
          const $container = window.$("#search-results-list");
          if ($container.length > 0) {
            $container.html('<div class="aikb-loading">Searching...</div>');
          }
          if (window.ntgFunnelback && typeof window.ntgFunnelback.callSearchAPI === "function") {
            window.ntgFunnelback.callSearchAPI(params.query, params);
          } else {
            console.error("Funnelback API not initialized");
          }
        }
        function handleClearInput() {
          $searchInput.val("");
          const $container = window.$("#search-results-list");
          if ($container.length > 0) {
            $container.html("");
          }
        }
        $form.on("submit", handleFormSubmit);
        window.$("#clear-input").on("click", handleClearInput);
        $searchInput.on("input", function() {
          const $clearBtn = window.$("#clear-input");
          if (window.$(this).val().length > 0) {
            $clearBtn.attr("hidden", false);
          } else {
            $clearBtn.attr("hidden", "");
          }
        });
        console.log("Search form handler initialized");
      })();
    }
  });

  // src/js/load-initial-results.js
  var require_load_initial_results = __commonJS({
    "src/js/load-initial-results.js"() {
      init_search_card_template();
      (function() {
        function loadInitialResults() {
          const searchResultsContainer = document.getElementById(
            "search-results-list"
          );
          if (!searchResultsContainer) {
            console.warn("search-results-list container not found on page");
            return;
          }
          console.log("Loading initial results from Funnelback API...");
          const apiURL = "https://ntgov-search.funnelback.squiz.cloud/s/search.json?collection=ntgov~sp-ntgc-ai-knowledge-base&s=!FunDoesNotExist:PadreNull&query=";
          fetch(apiURL).then((response) => {
            console.log(
              "Funnelback API response status:",
              response.status,
              response.ok
            );
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          }).then((data) => {
            console.log("Funnelback API data loaded successfully:", data);
            processAndRenderResults(data);
          }).catch((error) => {
            console.error(
              "Error loading from Funnelback API, falling back to local JSON:",
              error
            );
            fetch("src/data/search.json").then((response) => {
              console.log(
                "Fallback JSON response status:",
                response.status,
                response.ok
              );
              if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
            }).then((data) => {
              console.log("Fallback JSON data loaded successfully:", data);
              processAndRenderResults(data);
            }).catch((fallbackError) => {
              console.error("Error loading fallback search.json:", fallbackError);
              searchResultsContainer.innerHTML = "<p>Error loading search data: " + fallbackError.message + "</p>";
            });
          });
        }
        function processAndRenderResults(data) {
          const results = data.response && data.response.resultPacket ? data.response.resultPacket.results : [];
          const mappedResults = results.map((result) => ({
            title: result.title || "",
            summary: result.summary || "",
            listMetadata: result.listMetadata || {},
            date: result.date ? new Date(result.date).toLocaleDateString("en-AU", {
              year: "numeric",
              month: "long"
            }) : "",
            liveUrl: result.liveUrl || ""
          }));
          console.log("Rendering", mappedResults.length, "cards");
          renderResults(mappedResults, "search-results-list");
        }
        window.addEventListener("load", function() {
          console.log("Page load event fired, loading initial results...");
          setTimeout(loadInitialResults, 200);
        });
      })();
    }
  });

  // src/js/index.js
  var require_js = __commonJS({
    "src/js/index.js"() {
      init_ntg_funnelback();
      var import_cta_button_alias = __toESM(require_cta_button_alias());
      init_search_card_template();
      var import_search_form_handler = __toESM(require_search_form_handler());
      var import_load_initial_results = __toESM(require_load_initial_results());
    }
  });
  require_js();
})();
//# sourceMappingURL=aikb_scripts.min.js.map
