(()=>{var xe=Object.create;var D=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var _e=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty;var g=(t,e)=>()=>(t&&(e=t(t=0)),e);var P=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),R=(t,e)=>{for(var o in e)D(t,o,{get:e[o],enumerable:!0})},Be=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ae(e))!$e.call(t,a)&&a!==o&&D(t,a,{get:()=>e[a],enumerable:!(n=Se(e,a))||n.enumerable});return t};var Z=(t,e,o)=>(o=t!=null?xe(_e(t)):{},Be(e||!t||!t.__esModule?D(o,"default",{value:t,enumerable:!0}):o,t));function G(){return window.location.hostname==="ntgcentral.nt.gov.au"}function v(){return{isProduction:G(),liveApiUrl:"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/articles/_nocache",fallbackJsonUrl:"./dist/search.json",workAreasUrl:G()?"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/work-areas/_nocache":"./src/data/work-areas.json"}}function Y(){let t=v();return t.isProduction?t.liveApiUrl:t.fallbackJsonUrl}function X(){let t=v();return t.isProduction?t.fallbackJsonUrl:null}function ee(){return v().workAreasUrl}var T=g(()=>{});var ae={};R(ae,{getCurrentPage:()=>Le,getCurrentPageResults:()=>ne,getTotalPages:()=>W,initializePagination:()=>Ne,updatePagination:()=>Re});function Ne(t,e=10){F=t,A=e,O=t.length,u=1,Ie(),z()}function ne(){let t=(u-1)*A,e=t+A;return F.slice(t,e)}function Le(){return u}function W(){return Math.ceil(O/A)}function Ie(){if(f=document.getElementById("aikb-pagination"),!f){let t=document.getElementById("search-results-list");t&&t.parentNode&&(f=document.createElement("div"),f.id="aikb-pagination",f.className="aikb-pagination",t.parentNode.insertBefore(f,t.nextSibling))}}function z(){if(!f)return;let t=W();if(t<=1){f.innerHTML="",f.style.display="none";return}f.style.display="flex";let e=document.createElement("div");e.className="aikb-pagination__wrapper";let o=te("Previous",u>1,()=>{u>1&&M(u-1)});e.appendChild(o);let n=De(t);e.appendChild(n);let a=te("Next",u<t,()=>{u<t&&M(u+1)});e.appendChild(a),f.innerHTML="",f.appendChild(e)}function te(t,e,o){let n=document.createElement("div");n.className="aikb-pagination__control",e||n.classList.add("aikb-pagination__control--disabled");let a=document.createElement("div");if(a.className="aikb-pagination__icon-label",t==="Previous"){let s=document.createElement("span");s.className="fal fa-chevron-left",s.setAttribute("aria-hidden","true"),a.appendChild(s)}let l=document.createElement("span");if(l.className="aikb-pagination__text",l.textContent=t,a.appendChild(l),t==="Next"){let s=document.createElement("span");s.className="fal fa-chevron-right",s.setAttribute("aria-hidden","true"),a.appendChild(s)}return n.appendChild(a),e&&(n.addEventListener("click",o),n.style.cursor="pointer"),n}function De(t){let e=document.createElement("div");return e.className="aikb-pagination__pages",Pe(u,t).forEach(n=>{if(n==="..."){let a=document.createElement("span");a.className="aikb-pagination__ellipsis",a.textContent="...",e.appendChild(a)}else{let a=document.createElement("div");a.className="aikb-pagination__page-number",n===u&&a.classList.add("aikb-pagination__page-number--active");let l=document.createElement("span");l.textContent=n,a.appendChild(l),a.addEventListener("click",()=>M(n)),a.style.cursor="pointer",e.appendChild(a)}}),e}function Pe(t,e){if(e<=7)return Array.from({length:e},(l,s)=>s+1);let o=[];o.push(1),t>3&&o.push("...");let n=Math.max(2,t-1),a=Math.min(e-1,t+1);for(let l=n;l<=a;l++)o.push(l);return t<e-2&&o.push("..."),o.push(e),o}function M(t){let e=W();if(t<1||t>e||t===u)return;u=t,z();let o=new CustomEvent("aikb-pagination-change",{detail:{page:u,results:ne()}});document.dispatchEvent(o);let n=document.getElementById("search-results-list");if(n){let l=n.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:l,behavior:"smooth"})}}function Re(t){F=t,O=t.length,u=1,z()}var u,A,O,F,f,q=g(()=>{u=1,A=10,O=0,F=[],f=null});var le={};R(le,{renderResults:()=>_});function Te(t){if(!t)return"";if(/^[A-Z][a-z]+ \d{4}$/.test(t))return t;try{let o=new Date(t);if(!isNaN(o.getTime()))return`${["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]} ${o.getFullYear()}`}catch{}return t}function V(t){if(!t.title||!t.summary||!t.liveUrl)return console.warn("Skipping card with missing required fields:",t),null;let e=document.createElement("div");e.className="aikb-search-card";let o=document.createElement("div");o.className="aikb-search-card__inner";let n=document.createElement("div");n.className="aikb-search-card__content";let a=document.createElement("div");a.className="aikb-search-card__text";let l=document.createElement("h3");l.className="aikb-search-card__title",l.textContent=t.title,a.appendChild(l);let s=document.createElement("p");s.className="aikb-search-card__summary",s.textContent=t.summary,a.appendChild(s),n.appendChild(a);let i=t.listMetadata&&t.listMetadata["Work area"]?t.listMetadata["Work area"]:[];if(i&&i.length>0){let h=document.createElement("div");h.className="aikb-search-card__tags",i.forEach(y=>{if(y&&y.trim()){let w=document.createElement("div");w.className="aikb-search-card__tag",w.textContent=y.trim(),h.appendChild(w)}}),h.children.length>0&&n.appendChild(h)}o.appendChild(n);let c=document.createElement("div");c.className="aikb-search-card__actions";let r=document.createElement("a");r.href=t.liveUrl,r.className="ntgc-btn ntgc-btn--secondary";let p=document.createElement("span");p.textContent="See more",r.appendChild(p);let m=document.createElement("span");m.className="fal fa-long-arrow-right",m.setAttribute("aria-hidden","true"),r.appendChild(m),c.appendChild(r);let d=document.createElement("div");d.className="aikb-search-card__metadata";let I=t.listMetadata&&t.listMetadata.Roles?t.listMetadata.Roles:[];if(I&&I.length>0){let h=document.createElement("div");h.className="aikb-search-card__useful-for";let y=document.createElement("span");y.className="aikb-search-card__useful-value";let w=document.createElement("strong");w.textContent="Good for: ",y.appendChild(w);let Ce=document.createTextNode(I.join(", "));y.appendChild(Ce),h.appendChild(y),d.appendChild(h)}if(t.date){let h=document.createElement("div");h.className="aikb-search-card__date",h.textContent=`Last updated: ${Te(t.date)}`,d.appendChild(h)}return c.appendChild(d),o.appendChild(c),e.appendChild(o),e}function _(t,e="search-results-list",o=!0){console.log(`renderResults called with ${t.length} results for container #${e}`);let n=document.getElementById(e);if(console.log(`document.getElementById("${e}"):`,n),!n){let a=window.$?window.$(`#${e}`):null;console.log(`jQuery selector $("#${e}"):`,a),n=a&&a.length>0?a[0]:null}if(!n){console.error(`Container #${e} not found`),console.log("Available elements with id:",Array.from(document.querySelectorAll("[id]")).map(a=>a.id));return}if(n.innerHTML="",t.length===0){let a=document.createElement("p");a.textContent="No results found.",a.style.padding="24px 48px",n.appendChild(a);return}if(o)Promise.resolve().then(()=>(q(),ae)).then(({initializePagination:a,getCurrentPageResults:l})=>{a(t,10);let i=l().map(c=>V(c)).filter(c=>c!==null);i.forEach(c=>n.appendChild(c)),console.log(`Rendered ${i.length} of ${t.length} search result cards (page 1)`)});else{let a=t.map(l=>V(l)).filter(l=>l!==null);a.forEach(l=>n.appendChild(l)),console.log(`Rendered ${a.length} search result cards`)}}var oe,C=g(()=>{window.aikbRenderResults=_;oe=!1;oe||(document.addEventListener("aikb-pagination-change",t=>{let{results:e}=t.detail,o=document.getElementById("search-results-list");if(o&&e){o.innerHTML="";let n=e.map(a=>V(a)).filter(a=>a!==null);n.forEach(a=>o.appendChild(a)),console.log(`Rendered ${n.length} cards for page ${t.detail.page}`)}}),oe=!0)});function se(t){let e=typeof t=="string"?document.querySelector(t):t;return e?new U(e):(console.warn("Multi-select element not found:",t),null)}var U,H=g(()=>{U=class{constructor(e){this.selectElement=e,this.options=[],this.selectedValues=new Set,this.tempSelectedValues=new Set,this.isOpen=!1,this.container=null,this.displayButton=null,this.dropdownPanel=null,this.init()}init(){this.selectElement.style.display="none",this.createDropdownStructure(),this.selectAllByDefault(),this.bindEvents(),this.container.__multiSelectInstance=this}selectAllByDefault(){this.options.forEach(e=>{this.selectedValues.add(e.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.tempSelectedValues=new Set(this.selectedValues)}createDropdownStructure(){this.container=document.createElement("div"),this.container.className="aikb-multiselect-container",this.displayButton=document.createElement("button"),this.displayButton.type="button",this.displayButton.className="aikb-multiselect-button",this.displayButton.innerHTML=`
      <span class="aikb-multiselect-text">Select Options</span>
      <span class="aikb-multiselect-icon"></span>
    `,this.dropdownPanel=document.createElement("div"),this.dropdownPanel.className="aikb-multiselect-panel",this.dropdownPanel.style.display="none";let e=document.createElement("div");e.className="aikb-multiselect-options";let o=this.createOptionItem({value:"_select_all",label:"Select All",isSelectAll:!0});e.appendChild(o),Array.from(this.selectElement.options).forEach(s=>{if(!s.disabled&&s.value){this.options.push({value:s.value,label:s.textContent});let i=this.createOptionItem({value:s.value,label:s.textContent});e.appendChild(i)}});let n=document.createElement("div");n.className="aikb-multiselect-actions";let a=document.createElement("button");a.type="button",a.className="aikb-multiselect-btn aikb-multiselect-btn-ok",a.textContent="OK",a.addEventListener("click",()=>this.handleOk());let l=document.createElement("button");l.type="button",l.className="aikb-multiselect-btn aikb-multiselect-btn-cancel",l.textContent="Cancel",l.addEventListener("click",()=>this.handleCancel()),n.appendChild(a),n.appendChild(l),this.dropdownPanel.appendChild(e),this.dropdownPanel.appendChild(n),this.container.appendChild(this.displayButton),this.container.appendChild(this.dropdownPanel),this.selectElement.parentNode.insertBefore(this.container,this.selectElement.nextSibling)}createOptionItem(e){let o=document.createElement("label");o.className="aikb-multiselect-option",e.isSelectAll&&o.classList.add("aikb-multiselect-option-all");let n=document.createElement("input");n.type="checkbox",n.className="aikb-multiselect-checkbox",n.value=e.value,n.dataset.label=e.label,e.isSelectAll?n.addEventListener("change",l=>this.handleSelectAll(l)):n.addEventListener("change",()=>this.updateSelectAllState());let a=document.createElement("span");return a.className="aikb-multiselect-label",a.textContent=e.label,o.appendChild(n),o.appendChild(a),o}bindEvents(){this.displayButton.addEventListener("click",e=>{e.stopPropagation(),this.toggle()}),document.addEventListener("click",e=>{!this.container.contains(e.target)&&this.isOpen&&this.handleCancel()})}toggle(){this.isOpen?this.close():this.open()}open(){this.isOpen=!0,this.dropdownPanel.style.display="block",this.displayButton.classList.add("aikb-multiselect-open"),this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes()}close(){this.isOpen=!1,this.dropdownPanel.style.display="none",this.displayButton.classList.remove("aikb-multiselect-open")}handleOk(){let e=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])');this.selectedValues.clear(),e.forEach(o=>{o.checked&&this.selectedValues.add(o.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.triggerChange(),this.close()}handleCancel(){this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes(),this.close()}handleSelectAll(e){let o=e.target.checked;this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(a=>{a.disabled||(a.checked=o)})}updateSelectAllState(){let e=this.dropdownPanel.querySelector('.aikb-multiselect-checkbox[value="_select_all"]'),o=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])'),n=Array.from(o).filter(l=>!l.disabled),a=n.filter(l=>l.checked).length;e&&(e.checked=n.length>0&&a===n.length,e.indeterminate=a>0&&a<n.length)}updateCheckboxes(){this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(o=>{o.checked=this.tempSelectedValues.has(o.value)}),this.updateSelectAllState()}updateDisplayText(){let e=this.displayButton.querySelector(".aikb-multiselect-text");if(this.selectedValues.size===0)e.textContent="Select Options",e.classList.remove("aikb-multiselect-has-selection");else if(this.selectedValues.size===this.options.length)e.textContent="All selected",e.classList.add("aikb-multiselect-has-selection");else if(this.selectedValues.size===1){let o=Array.from(this.selectedValues).map(n=>{let a=this.options.find(l=>l.value===n);return a?a.label:n});e.textContent=o[0],e.classList.add("aikb-multiselect-has-selection")}else e.textContent=`${this.selectedValues.size} selected`,e.classList.add("aikb-multiselect-has-selection")}triggerChange(){let e=new CustomEvent("multiselect-change",{detail:{values:Array.from(this.selectedValues)}});if(this.container.dispatchEvent(e),this.selectElement){let o=new Event("change",{bubbles:!0});this.selectElement.dispatchEvent(o)}console.log("Multi-select changed:",Array.from(this.selectedValues))}syncNativeSelect(){this.selectElement&&(Array.from(this.selectElement.options).forEach(e=>{e.selected=!1}),Array.from(this.selectElement.options).forEach(e=>{this.selectedValues.has(e.value)&&(e.selected=!0)}))}getSelectedValues(){return Array.from(this.selectedValues)}reset(){this.selectedValues.clear(),this.tempSelectedValues.clear(),this.updateDisplayText(),this.updateCheckboxes()}updateCounts(e){Array.from(this.selectElement.options).forEach(n=>{if(!n.disabled&&n.value&&e.has(n.value)){let a=e.get(n.value),l=n.textContent.replace(/\s*\(\d+\)\s*$/,"");a>0?n.textContent=`${l} (${a})`:n.textContent=l}}),this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(n=>{let a=n.value;if(e.has(a)){let l=e.get(a),s=n.parentElement,i=s.querySelector(".aikb-multiselect-label");if(i){let c=i.querySelector(".aikb-count-badge");c&&c.remove();let r=i.textContent.replace(/\s*\(\d+\)\s*$/,"").trim();i.textContent=r;let p=document.createElement("span");if(p.className="aikb-count-badge",p.textContent=l.toString(),i.appendChild(p),l===0){n.disabled=!0,n.checked=!1,s.classList.add("aikb-multiselect-option-disabled"),this.selectedValues.delete(a),this.tempSelectedValues.delete(a);let m=this.options.findIndex(d=>d.value===a);m!==-1&&(this.options[m].label=`${r} (${l})`)}else{n.disabled=!1,s.classList.remove("aikb-multiselect-option-disabled");let m=this.options.findIndex(d=>d.value===a);m!==-1&&(this.options[m].label=`${r} (${l})`)}}}}),this.updateDisplayText(),console.log("Multi-select counts updated")}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.selectElement&&(this.selectElement.style.display=""),this.container=null,this.displayButton=null,this.dropdownPanel=null,console.log("Multi-select instance destroyed")}}});function Me(t){let e=new Set;return t.forEach(o=>{if(o.listMetadata&&o.listMetadata["Work area"]){let n=o.listMetadata["Work area"];Array.isArray(n)&&n.forEach(a=>{let l=a.trim();l&&e.add(l)})}}),Array.from(e).sort((o,n)=>o==="All work areas"?-1:n==="All work areas"?1:o.localeCompare(n))}function Oe(t,e){let o=new Map;return t.forEach(n=>{o.set(n,0)}),e.forEach(n=>{if(n.listMetadata&&n.listMetadata["Work area"]){let a=n.listMetadata["Work area"];Array.isArray(a)&&a.forEach(l=>{let s=l.trim();s&&o.has(s)&&o.set(s,o.get(s)+1)})}}),o.has("All work areas")&&o.set("All work areas",e.length),o}function ie(t){j=t,console.log(`Stored ${t.length} static work areas`)}function Fe(t){let e=document.getElementById("document_type");if(!e){console.warn("Work area dropdown #document_type not found");return}e.innerHTML="";let o=document.createElement("option");o.value="",o.textContent="Select a work area",o.disabled=!0,o.selected=!0,e.appendChild(o),t.forEach(n=>{let a=document.createElement("option");a.value=n,a.textContent=n,e.appendChild(a)}),console.log(`Populated work area dropdown with ${t.length} options`),k&&(k.destroy(),k=null),(!e.nextElementSibling||!e.nextElementSibling.classList.contains("aikb-multiselect-container"))&&(k=se(e))}function We(){let t=document.getElementById("select-question-3");if(!t){console.warn("Sort dropdown container #select-question-3 not found");return}let e=document.getElementById("owner");if(e)e.innerHTML="";else{let n=t.querySelector("label");if(t.innerHTML="",n)t.appendChild(n);else{let s=document.createElement("label");s.className="ntgc-form-input--label",s.setAttribute("for","select-input-2"),s.textContent="Sort",t.appendChild(s)}let a=document.createElement("div");a.className="aikb-dropdown-wrapper";let l=document.createElement("div");l.className="aikb-dropdown-inner",e=document.createElement("select"),e.name="sort",e.className="ntgc-select ntgc-select--block ntgc-select-input--filter",e.id="owner",l.appendChild(e),a.appendChild(l),t.appendChild(a)}let o=[{value:"relevance",label:"Relevance",selected:!0},{value:"date-newest",label:"Date (newest first)"},{value:"date-oldest",label:"Date (oldest first)"},{value:"title-az",label:"Title (A-Z)"},{value:"title-za",label:"Title (Z-A)"}];o.forEach(n=>{let a=document.createElement("option");a.value=n.value,a.textContent=n.label,n.selected&&(a.selected=!0),e.appendChild(a)}),console.log(`Populated sort dropdown with ${o.length} options`)}function ze(){let t=document.getElementById("document_type");if(t&&!t.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let n=t.closest(".aikb-dropdown-wrapper");if(n){let a=n.querySelector(".aikb-dropdown-inner");a&&a.appendChild(o)}}let e=document.getElementById("owner");if(e&&!e.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let n=e.closest(".aikb-dropdown-wrapper");if(n){let a=n.querySelector(".aikb-dropdown-inner");a&&a.appendChild(o)}}}function ce(t,e=null){console.log("Initializing dropdowns with search data...");let o;e&&e.length>0?(o=e,console.log("Using pre-fetched static work areas list")):j.length>0?(o=j,console.log("Using stored static work areas list")):(o=Me(t),console.log("Extracted work areas from results (fallback)")),Fe(o);let n=Oe(o,t);k&&k.updateCounts(n),We(),ze(),console.log("Dropdowns initialized successfully")}var k,j,$=g(()=>{H();k=null,j=[]});function de(t){let e=document.getElementById("appliedFiltersSection"),o=document.getElementById("appliedFilters"),n=document.getElementById("clearAllBtn");if(!e||!o){console.warn("Applied filters section not found");return}o.innerHTML="";let a=!1;if(t.searchQuery&&t.searchQuery.trim()){a=!0;let l=re("Search",t.searchQuery,"bg-success","search");o.appendChild(l)}t.workAreas&&t.workAreas.length>0&&(qe(t.workAreas)||(a=!0,t.workAreas.forEach(s=>{let i=re("Work area",s,"bg-primary","work-area",s);o.appendChild(i)}))),n&&(n.style.display=a?"inline-flex":"none",n.style.marginLeft="8px",n.style.verticalAlign="middle",n.style.alignItems="center",o.appendChild(n)),e.style.display=a?"block":"none"}function qe(t){let e=document.getElementById("document_type");if(!e)return!1;let o=Array.from(e.options).filter(n=>!n.disabled&&n.value).length;return t.length===o}function re(t,e,o,n,a){let l=document.createElement("span");l.className=`badge ${o} filter-pill d-inline-flex align-items-center`;let s=document.createElement("span");s.className="pill-label",s.textContent=`${t}:`;let i=document.createElement("span");i.className="pill-value",i.textContent=e;let c=document.createElement("button");c.type="button",c.className="pill-remove",c.title=`Remove ${t}: ${e}`,c.setAttribute("data-filter-type",n),a&&c.setAttribute("data-filter-value",a);let r=document.createElement("span");return r.className="fas fa-times",c.appendChild(r),c.addEventListener("click",p=>{p.preventDefault(),Ve(n,a)}),l.appendChild(s),l.appendChild(i),l.appendChild(c),l}async function Ve(t,e){switch(console.log(`Removing filter: ${t}`,e),t){case"search":let o=document.getElementById("search");if(o){o.value="";let{loadInitialResults:a}=await Promise.resolve().then(()=>(x(),J));a()}break;case"work-area":let n=document.getElementById("document_type");if(n&&e){let a=Array.from(n.options).find(i=>i.value===e);a&&(a.selected=!1);let l=new Event("change",{bubbles:!0});n.dispatchEvent(l);let s=n.nextElementSibling;if(s&&s.classList.contains("aikb-multiselect-container")){let i=s.__multiSelectInstance;i&&(i.selectedValues.delete(e),i.syncNativeSelect(),i.updateDisplayText(),i.triggerChange())}}break}}async function Ue(){console.log("Clearing all filters");let t=document.getElementById("search");t&&(t.value="");let e=document.getElementById("document_type");if(e){Array.from(e.options).forEach(l=>{!l.disabled&&l.value&&(l.selected=!0)});let a=e.nextElementSibling;if(a&&a.classList.contains("aikb-multiselect-container")){let l=a.__multiSelectInstance;l&&typeof l.selectAllByDefault=="function"&&(l.selectAllByDefault(),l.triggerChange())}}let o=document.getElementById("appliedFiltersSection");o&&(o.style.display="none");let{loadInitialResults:n}=await Promise.resolve().then(()=>(x(),J));n()}function ue(){let t=document.getElementById("clearAllBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),Ue()})}function pe(){let t=document.getElementById("search"),e=document.getElementById("document_type"),o=document.getElementById("sort")||document.getElementById("owner"),n={searchQuery:t?t.value:"",workAreas:[],sort:o?o.value:"relevance"};if(e){let a=Array.from(e.selectedOptions||[]);n.workAreas=a.map(l=>l.value).filter(l=>l&&l.trim().length>0)}return n}var B=g(()=>{});function E(t){let e=new Set,o=[];t.forEach((n,a)=>{let l=n.liveUrl||n.url||n.title||JSON.stringify(n)+a;e.has(l)||(e.add(l),o.push(n))}),S=o,console.log(`Stored ${S.length} results for filtering/sorting (${t.length-S.length} duplicates removed)`)}function He(t){if(!t||t.length===0)return S;let e=new Set,o=[];return S.forEach((n,a)=>{if(!n.listMetadata||!n.listMetadata["Work area"])return;let l=n.listMetadata["Work area"];if(t.some(i=>l.includes(i))){let i=n.liveUrl||n.url||n.title||JSON.stringify(n)+a;e.has(i)||(e.add(i),o.push(n))}}),o}function je(t,e){let o=[...t];switch(e){case"relevance":o.sort((n,a)=>n.rank&&a.rank?n.rank-a.rank:n.score&&a.score?a.score-n.score:0);break;case"date-newest":o.sort((n,a)=>{let l=n.date?new Date(n.date).getTime():0;return(a.date?new Date(a.date).getTime():0)-l});break;case"date-oldest":o.sort((n,a)=>{let l=n.date?new Date(n.date).getTime():0,s=a.date?new Date(a.date).getTime():0;return l-s});break;case"title-az":o.sort((n,a)=>{let l=n.title||"",s=a.title||"";return l.localeCompare(s)});break;case"title-za":o.sort((n,a)=>{let l=n.title||"";return(a.title||"").localeCompare(l)});break;default:break}return o}async function b(){if(K){console.log("Filter/sort already in progress, skipping duplicate call");return}K=!0;try{let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(!t||!e){console.warn("Required dropdowns not found (document_type or sort)");return}let o=[];t&&(o=Array.from(t.selectedOptions||[]).map(r=>r.value).filter(r=>r&&r.trim().length>0));let n=e.value||"relevance";console.log(`Applying filters - Work Areas: [${o.join(", ")}], Sort: "${n}"`);let a=He(o);console.log(`After filtering: ${a.length} results`);let l=je(a,n);console.log(`After sorting: ${l.length} results`);let{renderResults:s}=await Promise.resolve().then(()=>(C(),le));s(l,"search-results-list");let i=pe();de(i)}finally{K=!1}}function he(){if(me){console.log("Filter and sort listeners already initialized, skipping");return}let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(t){t.addEventListener("change",function(){console.log("Work area filter changed"),b()});let o=t.nextElementSibling;o&&o.classList.contains("aikb-multiselect-container")&&o.addEventListener("multiselect-change",()=>{console.log("Work area filter applied via custom multi-select"),b()}),typeof window.$<"u"&&window.$(t).on("sumo:closed",function(){console.log("Work area filter applied via SumoSelect OK"),b()})}e&&e.addEventListener("change",function(){console.log(`Sort changed to: ${this.value}`),b()}),me=!0,console.log("Filter and sort listeners initialized")}var S,K,me,N=g(()=>{B();S=[];K=!1;me=!1});var J={};R(J,{loadInitialResults:()=>be});async function Je(){let t=ee();console.log(`Fetching work areas from ${t}...`);try{let e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let o=await e.json();return console.log("Work areas loaded successfully:",o),Array.isArray(o)?o:[]}catch(e){return console.error(`Error fetching work areas from ${t}:`,e),null}}function be(){if(!document.getElementById("search-results-list")){console.warn("search-results-list container not found on page");return}let e=v(),o=Y(),n=X();console.log(`Loading initial results from ${e.isProduction?"live API":"local JSON"}...`),Je().then(a=>{a&&(ye=a,ie(a))}),fetch(o).then(a=>{if(console.log(`Primary source (${o}) response status:`,a.status,a.ok),!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return a.json()}).then(a=>{console.log(`Primary source data loaded successfully (${e.isProduction?"live API":"local JSON"}):`,a),ge(a,e.isProduction?"live-api":"local")}).catch(a=>{console.error(`Error loading from primary source (${o}):`,a),n?(console.log("Attempting fallback to local JSON..."),fetch(n).then(l=>{if(console.log("Fallback JSON response status:",l.status,l.ok),!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return l.json()}).then(l=>{console.log("Fallback JSON data loaded successfully:",l),ge(l,"fallback")}).catch(l=>{console.error("Error loading fallback search.json:",l),fe()})):fe()})}function fe(){let t=document.getElementById("search-results-list");t&&(t.innerHTML='<p class="aikb-error">Unable to load search results. Please check your connection and try again later.</p>')}function ge(t,e="unknown"){let n=(Array.isArray(t)?t:[]).map(s=>({title:s.title||"",summary:s.description||s.summary||"",listMetadata:{"Work area":s["work-area"]||[],Roles:s.roles||[],Benefits:s.benefits||[]},date:s["last-updated"]?new Date(s["last-updated"]).toLocaleDateString("en-AU",{year:"numeric",month:"long"}):"",liveUrl:s.url||s.liveUrl||"",submittedBy:s["submitted-by"]||""}));console.log(`Rendering ${n.length} cards from ${e}`);let a=new Set,l=[];n.forEach((s,i)=>{let c=s.liveUrl||s.url||s.title||JSON.stringify(s)+i;a.has(c)||(a.add(c),l.push(s))}),n.length!==l.length&&console.log(`Removed ${n.length-l.length} duplicate items from source data`),E(l),window.aikbSearchCache=l,console.log(`Cached ${l.length} results for offline search`),ce(l,ye),he(),_(l,"search-results-list")}var ye,x=g(()=>{C();$();N();T();ye=null;window.addEventListener("load",function(){console.log("Page load event fired, loading initial results..."),setTimeout(be,200)})});function we(t,e){if(!t||!e||e.length===0)return console.log("Offline search: No keywords or no cached results available"),[];let o=t.toLowerCase().replace(/[^\w\s]/g,"").trim();if(!o)return console.log("Offline search: Keywords empty after normalization"),[];console.log(`Offline search: Searching for "${t}" in ${e.length} cached results`);let n=new RegExp(o,"gi"),l=e.map(s=>{let i=0,c=0,r=0,p=0;if(s.title){let d=s.title.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(c=d.length,i+=c*3)}if(s.summary){let d=s.summary.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(r=d.length,i+=r*1)}if(s.metadata){let d=s.metadata.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(p=d.length,i+=p*2)}return{...s,_offlineScore:i,_offlineMatches:{title:c,summary:r,metadata:p}}}).filter(s=>s._offlineScore>0);return l.sort((s,i)=>i._offlineScore-s._offlineScore),console.log(`Offline search: Found ${l.length} results matching "${t}"`),l.length>0&&(console.log("Offline search: Top results:"),l.slice(0,3).forEach((s,i)=>{console.log(`  ${i+1}. "${s.title}" (score: ${s._offlineScore}, title:${s._offlineMatches.title}, summary:${s._offlineMatches.summary}, metadata:${s._offlineMatches.metadata})`)})),l}function L(){return window.aikbSearchCache&&Array.isArray(window.aikbSearchCache)?(console.log(`Offline search: Retrieved ${window.aikbSearchCache.length} cached results`),window.aikbSearchCache):(console.log("Offline search: No cached data available"),null)}var Q=g(()=>{});var ke=P(()=>{x();C();Q();N();$();B();(function(){if(typeof window.$>"u"){console.warn("jQuery not loaded; search form handler disabled");return}let e=window.$("#policy-search-form"),o=window.$("#search");if(e.length===0){console.error("Form #policy-search-form not found");return}function n(){return{query:o.val()||"",area:window.$("#document_type").val()||""}}function a(i){i.preventDefault()}function l(){o.val(""),console.log("Search cleared - restoring filtered view of all results");let i=L();i&&i.length>0&&(E(i),b())}e.on("submit",a),window.$("#clear-input").on("click",l),o.on("input",function(){let i=window.$("#clear-input");window.$(this).val().length>0?i.attr("hidden",!1):i.attr("hidden","")}),o.on("keydown",function(i){if(i.key==="Enter"||i.keyCode===13){i.preventDefault();let c=window.$(this).val();if(c.trim())s(c);else{console.log("Empty search via Enter - restoring filtered view of all results");let r=L();r&&r.length>0&&(E(r),b())}}});function s(i){if(!i.trim())return;console.log(`Triggered search for: "${i}"`);let c=L();if(c&&c.length>0){console.log("Performing local search");let r=we(i,c);E(r),b(),console.log(`Local search: Found ${r.length} results, applying filters`)}else{console.error("No cached data available for search");let r=window.$("#search-results-list");r.length>0&&r.html('<p class="aikb-error">Unable to load search results. Please check your connection and try again.</p>')}}console.log("Search form handler initialized")})()});var ve=P(()=>{var Ke='div[data-hydration-component="squiz-call-to-action"] a';function Ee(t=document){t.querySelectorAll(Ke).forEach(o=>{o.classList.add("ntgc-btn","ntgc-btn--primary")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>Ee()):Ee()});var Qe=P(()=>{T();var At=Z(ke());N();C();$();Q();H();x();var Dt=Z(ve());q();B();console.log("[aikb] Landing page bundle loaded successfully");console.log("[aikb] jQuery available:",typeof window.jQuery<"u");console.log("[aikb] DOM ready state:",document.readyState);window.addEventListener("load",function(){ue(),console.log("[aikb] Applied filters initialized")})});Qe();})();
//# sourceMappingURL=landing-page.min.js.map
