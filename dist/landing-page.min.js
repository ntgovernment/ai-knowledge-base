(()=>{var Se=Object.create;var I=Object.defineProperty;var xe=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var _e=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty;var g=(t,e)=>()=>(t&&(e=t(t=0)),e);var D=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),M=(t,e)=>{for(var l in e)I(t,l,{get:e[l],enumerable:!0})},Be=(t,e,l,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ae(e))!$e.call(t,a)&&a!==l&&I(t,a,{get:()=>e[a],enumerable:!(n=xe(e,a))||n.enumerable});return t};var Z=(t,e,l)=>(l=t!=null?Se(_e(t)):{},Be(e||!t||!t.__esModule?I(l,"default",{value:t,enumerable:!0}):l,t));function G(){return window.location.hostname==="ntgcentral.nt.gov.au"}function E(){return{isProduction:G(),liveApiUrl:"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/articles/_nocache",fallbackJsonUrl:"./dist/search.json",workAreasUrl:G()?"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/work-areas/_nocache":"./src/data/work-areas.json"}}function Y(){let t=E();return t.isProduction?t.liveApiUrl:t.fallbackJsonUrl}function X(){let t=E();return t.isProduction?t.fallbackJsonUrl:null}function ee(){return E().workAreasUrl}var R=g(()=>{});var ae={};M(ae,{getCurrentPage:()=>Pe,getCurrentPageResults:()=>ne,getTotalPages:()=>H,initializePagination:()=>Ne,updatePagination:()=>Me});function Ne(t,e=10){F=t,A=e,O=t.length,u=1,Le(),W()}function ne(){let t=(u-1)*A,e=t+A;return F.slice(t,e)}function Pe(){return u}function H(){return Math.ceil(O/A)}function Le(){if(f=document.getElementById("aikb-pagination"),!f){let t=document.getElementById("search-results-list");t&&t.parentNode&&(f=document.createElement("div"),f.id="aikb-pagination",f.className="aikb-pagination",t.parentNode.insertBefore(f,t.nextSibling))}}function W(){if(!f)return;let t=H();if(t<=1){f.innerHTML="",f.style.display="none";return}f.style.display="flex";let e=document.createElement("div");e.className="aikb-pagination__wrapper";let l=te("Previous",u>1,()=>{u>1&&T(u-1)});e.appendChild(l);let n=Ie(t);e.appendChild(n);let a=te("Next",u<t,()=>{u<t&&T(u+1)});e.appendChild(a),f.innerHTML="",f.appendChild(e)}function te(t,e,l){let n=document.createElement("div");n.className="aikb-pagination__control",e||n.classList.add("aikb-pagination__control--disabled");let a=document.createElement("div");if(a.className="aikb-pagination__icon-label",t==="Previous"){let s=document.createElement("span");s.className="fal fa-chevron-left",s.setAttribute("aria-hidden","true"),a.appendChild(s)}let o=document.createElement("span");if(o.className="aikb-pagination__text",o.textContent=t,a.appendChild(o),t==="Next"){let s=document.createElement("span");s.className="fal fa-chevron-right",s.setAttribute("aria-hidden","true"),a.appendChild(s)}return n.appendChild(a),e&&(n.addEventListener("click",l),n.style.cursor="pointer"),n}function Ie(t){let e=document.createElement("div");return e.className="aikb-pagination__pages",De(u,t).forEach(n=>{if(n==="..."){let a=document.createElement("span");a.className="aikb-pagination__ellipsis",a.textContent="...",e.appendChild(a)}else{let a=document.createElement("div");a.className="aikb-pagination__page-number",n===u&&a.classList.add("aikb-pagination__page-number--active");let o=document.createElement("span");o.textContent=n,a.appendChild(o),a.addEventListener("click",()=>T(n)),a.style.cursor="pointer",e.appendChild(a)}}),e}function De(t,e){if(e<=7)return Array.from({length:e},(o,s)=>s+1);let l=[];l.push(1),t>3&&l.push("...");let n=Math.max(2,t-1),a=Math.min(e-1,t+1);for(let o=n;o<=a;o++)l.push(o);return t<e-2&&l.push("..."),l.push(e),l}function T(t){let e=H();if(t<1||t>e||t===u)return;u=t,W();let l=new CustomEvent("aikb-pagination-change",{detail:{page:u,results:ne()}});document.dispatchEvent(l);let n=document.getElementById("search-results-list");if(n){let o=n.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:o,behavior:"smooth"})}}function Me(t){F=t,O=t.length,u=1,W()}var u,A,O,F,f,z=g(()=>{u=1,A=10,O=0,F=[],f=null});var oe={};M(oe,{renderResults:()=>_});function Re(t){if(!t)return"";if(/^[A-Z][a-z]+ \d{4}$/.test(t))return t;try{let l=new Date(t);if(!isNaN(l.getTime()))return`${["January","February","March","April","May","June","July","August","September","October","November","December"][l.getMonth()]} ${l.getFullYear()}`}catch{}return t}function q(t){if(!t.title||!t.summary||!t.liveUrl)return console.warn("Skipping card with missing required fields:",t),null;let e=document.createElement("div");e.className="aikb-search-card";let l=document.createElement("div");l.className="aikb-search-card__inner";let n=document.createElement("div");n.className="aikb-search-card__content";let a=document.createElement("div");a.className="aikb-search-card__text";let o=document.createElement("h3");o.className="aikb-search-card__title",o.textContent=t.title,a.appendChild(o);let s=document.createElement("p");s.className="aikb-search-card__summary",s.textContent=t.summary,a.appendChild(s),n.appendChild(a);let i=t.listMetadata&&t.listMetadata["Work area"]?t.listMetadata["Work area"]:[];if(i&&i.length>0){let m=document.createElement("div");m.className="aikb-search-card__tags",i.forEach(y=>{if(y&&y.trim()){let w=document.createElement("div");w.className="aikb-search-card__tag",w.textContent=y.trim(),m.appendChild(w)}}),m.children.length>0&&n.appendChild(m)}l.appendChild(n);let r=document.createElement("div");r.className="aikb-search-card__actions";let c=document.createElement("a");c.href=t.liveUrl,c.className="ntgc-btn ntgc-btn--secondary";let p=document.createElement("span");p.textContent="See more",c.appendChild(p);let h=document.createElement("span");h.className="fal fa-long-arrow-right",h.setAttribute("aria-hidden","true"),c.appendChild(h),r.appendChild(c);let d=document.createElement("div");d.className="aikb-search-card__metadata";let L=t.listMetadata&&t.listMetadata.Roles?t.listMetadata.Roles:[];if(L&&L.length>0){let m=document.createElement("div");m.className="aikb-search-card__useful-for";let y=document.createElement("span");y.className="aikb-search-card__useful-value";let w=document.createElement("strong");w.textContent="Good for: ",y.appendChild(w);let Ce=document.createTextNode(L.join(", "));y.appendChild(Ce),m.appendChild(y),d.appendChild(m)}if(t.date){let m=document.createElement("div");m.className="aikb-search-card__date",m.textContent=`Last updated: ${Re(t.date)}`,d.appendChild(m)}return r.appendChild(d),l.appendChild(r),e.appendChild(l),e}function _(t,e="search-results-list",l=!0){console.log(`renderResults called with ${t.length} results for container #${e}`);let n=document.getElementById(e);if(console.log(`document.getElementById("${e}"):`,n),!n){let a=window.$?window.$(`#${e}`):null;console.log(`jQuery selector $("#${e}"):`,a),n=a&&a.length>0?a[0]:null}if(!n){console.error(`Container #${e} not found`),console.log("Available elements with id:",Array.from(document.querySelectorAll("[id]")).map(a=>a.id));return}if(n.innerHTML="",t.length===0){let a=document.createElement("p");a.textContent="No results found.",a.style.padding="24px 48px",n.appendChild(a);return}if(l)Promise.resolve().then(()=>(z(),ae)).then(({initializePagination:a,getCurrentPageResults:o})=>{a(t,10);let i=o().map(r=>q(r)).filter(r=>r!==null);i.forEach(r=>n.appendChild(r)),console.log(`Rendered ${i.length} of ${t.length} search result cards (page 1)`)});else{let a=t.map(o=>q(o)).filter(o=>o!==null);a.forEach(o=>n.appendChild(o)),console.log(`Rendered ${a.length} search result cards`)}}var le,C=g(()=>{window.aikbRenderResults=_;le=!1;le||(document.addEventListener("aikb-pagination-change",t=>{let{results:e}=t.detail,l=document.getElementById("search-results-list");if(l&&e){l.innerHTML="";let n=e.map(a=>q(a)).filter(a=>a!==null);n.forEach(a=>l.appendChild(a)),console.log(`Rendered ${n.length} cards for page ${t.detail.page}`)}}),le=!0)});function se(t){let e=typeof t=="string"?document.querySelector(t):t;return e?new V(e):(console.warn("Multi-select element not found:",t),null)}var V,U=g(()=>{V=class{constructor(e){this.selectElement=e,this.options=[],this.selectedValues=new Set,this.tempSelectedValues=new Set,this.isOpen=!1,this.container=null,this.displayButton=null,this.dropdownPanel=null,this._boundHandlers={},this.init()}init(){this.selectElement.style.display="none",this.createDropdownStructure(),this.selectAllByDefault(),this.bindEvents(),this.container.__multiSelectInstance=this}selectAllByDefault(){this.options.forEach(e=>{let l=Array.from(this.selectElement.options).find(n=>n.value===e.value);l&&!l.disabled&&this.selectedValues.add(e.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.tempSelectedValues=new Set(this.selectedValues)}createDropdownStructure(){this.container=document.createElement("div"),this.container.className="aikb-multiselect-container",this.displayButton=document.createElement("button"),this.displayButton.type="button",this.displayButton.className="aikb-multiselect-button",this.displayButton.innerHTML=`
      <span class="aikb-multiselect-text">Select Options</span>
      <span class="aikb-multiselect-icon"></span>
    `,this.dropdownPanel=document.createElement("div"),this.dropdownPanel.className="aikb-multiselect-panel",this.dropdownPanel.style.display="none";let e=document.createElement("div");e.className="aikb-multiselect-options";let l=this.createOptionItem({value:"_select_all",label:"Select All",isSelectAll:!0});e.appendChild(l),Array.from(this.selectElement.options).forEach(s=>{if(!s.disabled&&s.value){this.options.push({value:s.value,label:s.textContent});let i=this.createOptionItem({value:s.value,label:s.textContent});e.appendChild(i)}});let n=document.createElement("div");n.className="aikb-multiselect-actions";let a=document.createElement("button");a.type="button",a.className="aikb-multiselect-btn aikb-multiselect-btn-ok",a.textContent="OK",this._boundHandlers.okClick=()=>this.handleOk(),a.addEventListener("click",this._boundHandlers.okClick);let o=document.createElement("button");o.type="button",o.className="aikb-multiselect-btn aikb-multiselect-btn-cancel",o.textContent="Cancel",this._boundHandlers.cancelClick=()=>this.handleCancel(),o.addEventListener("click",this._boundHandlers.cancelClick),n.appendChild(a),n.appendChild(o),this.dropdownPanel.appendChild(e),this.dropdownPanel.appendChild(n),this._boundHandlers.checkboxChange=s=>{s.target.classList.contains("aikb-multiselect-checkbox")&&(s.target.value==="_select_all"?this.handleSelectAll(s):this.updateSelectAllState())},this.dropdownPanel.addEventListener("change",this._boundHandlers.checkboxChange),this.container.appendChild(this.displayButton),this.container.appendChild(this.dropdownPanel),this.selectElement.parentNode.insertBefore(this.container,this.selectElement.nextSibling)}createOptionItem(e){let l=document.createElement("label");l.className="aikb-multiselect-option",e.isSelectAll&&l.classList.add("aikb-multiselect-option-all");let n=document.createElement("input");n.type="checkbox",n.className="aikb-multiselect-checkbox",n.value=e.value,n.dataset.label=e.label;let a=document.createElement("span");return a.className="aikb-multiselect-label",a.textContent=e.label,l.appendChild(n),l.appendChild(a),l}bindEvents(){this._boundHandlers.displayClick=e=>{e.stopPropagation(),this.toggle()},this.displayButton.addEventListener("click",this._boundHandlers.displayClick),this._boundHandlers.documentClick=e=>{this.container&&!this.container.contains(e.target)&&this.isOpen&&this.handleCancel()},document.addEventListener("click",this._boundHandlers.documentClick)}toggle(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): toggle");return}this.isOpen?this.close():this.open()}open(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): open");return}this.isOpen=!0,this.dropdownPanel.style.display="block",this.displayButton.classList.add("aikb-multiselect-open"),this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes()}close(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): close");return}this.isOpen=!1,this.dropdownPanel.style.display="none",this.displayButton.classList.remove("aikb-multiselect-open")}handleOk(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleOk");return}let e=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])');this.selectedValues.clear(),e.forEach(l=>{l.checked&&this.selectedValues.add(l.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.triggerChange(),this.close()}handleCancel(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleCancel");return}this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes(),this.close()}handleSelectAll(e){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleSelectAll");return}let l=e.target.checked;this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(a=>{a.disabled||(a.checked=l)})}updateSelectAllState(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateSelectAllState");return}let e=this.dropdownPanel.querySelector('.aikb-multiselect-checkbox[value="_select_all"]'),l=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])'),n=Array.from(l).filter(o=>!o.disabled),a=n.filter(o=>o.checked).length;e&&(e.checked=n.length>0&&a===n.length,e.indeterminate=a>0&&a<n.length)}updateCheckboxes(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateCheckboxes");return}this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(l=>{l.checked=this.tempSelectedValues.has(l.value)}),this.updateSelectAllState()}updateDisplayText(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateDisplayText");return}let e=this.displayButton.querySelector(".aikb-multiselect-text");if(this.selectedValues.size===0)e.textContent="Select Options",e.classList.remove("aikb-multiselect-has-selection");else if(this.selectedValues.size===this.options.length)e.textContent="All selected",e.classList.add("aikb-multiselect-has-selection");else if(this.selectedValues.size===1){let l=Array.from(this.selectedValues).map(n=>{let a=this.options.find(o=>o.value===n);return a?a.label:n});e.textContent=l[0],e.classList.add("aikb-multiselect-has-selection")}else e.textContent=`${this.selectedValues.size} selected`,e.classList.add("aikb-multiselect-has-selection")}triggerChange(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): triggerChange");return}let e=new CustomEvent("multiselect-change",{detail:{values:Array.from(this.selectedValues)}});if(this.container.dispatchEvent(e),this.selectElement){let l=new Event("change",{bubbles:!0});this.selectElement.dispatchEvent(l)}console.log("Multi-select changed:",Array.from(this.selectedValues))}syncNativeSelect(){this.selectElement&&(Array.from(this.selectElement.options).forEach(e=>{e.selected=!1}),Array.from(this.selectElement.options).forEach(e=>{this.selectedValues.has(e.value)&&(e.selected=!0)}))}getSelectedValues(){return Array.from(this.selectedValues)}reset(){this.selectedValues.clear(),this.tempSelectedValues.clear(),this.updateDisplayText(),this.updateCheckboxes()}updateCounts(e){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateCounts");return}Array.from(this.selectElement.options).forEach(n=>{if(n.value&&e.has(n.value)){let a=e.get(n.value),o=n.textContent.replace(/\s*\(\d+\)\s*$/,"");a>0?(n.textContent=`${o} (${a})`,n.disabled=!1):(n.textContent=o,n.disabled=!0,n.selected=!1)}}),this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(n=>{let a=n.value;if(e.has(a)){let o=e.get(a),s=n.parentElement,i=s.querySelector(".aikb-multiselect-label");if(i){let r=i.querySelector(".aikb-count-badge");r&&r.remove();let c=i.textContent.replace(/\s*\(\d+\)\s*$/,"").trim();i.textContent=c;let p=document.createElement("span");if(p.className="aikb-count-badge",p.textContent=o.toString(),i.appendChild(p),o===0){n.disabled=!0,n.checked=!1,s.classList.add("aikb-multiselect-option-disabled"),this.selectedValues.delete(a),this.tempSelectedValues.delete(a);let h=this.options.findIndex(d=>d.value===a);h!==-1&&(this.options[h].label=`${c} (${o})`)}else{n.disabled=!1,s.classList.remove("aikb-multiselect-option-disabled");let h=this.options.findIndex(d=>d.value===a);h!==-1&&(this.options[h].label=`${c} (${o})`)}}}}),this.syncNativeSelect(),this.updateDisplayText(),console.log("Multi-select counts updated")}destroy(){this._boundHandlers&&(this._boundHandlers.documentClick&&document.removeEventListener("click",this._boundHandlers.documentClick),this.displayButton&&this._boundHandlers.displayClick&&this.displayButton.removeEventListener("click",this._boundHandlers.displayClick),this.dropdownPanel&&this._boundHandlers.checkboxChange&&this.dropdownPanel.removeEventListener("change",this._boundHandlers.checkboxChange)),this.isOpen=!1,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.selectElement&&(this.selectElement.style.display=""),this.container=null,this.displayButton=null,this.dropdownPanel=null,this._boundHandlers=null,console.log("Multi-select instance destroyed")}}});function Te(t){let e=new Set;return t.forEach(l=>{if(l.listMetadata&&l.listMetadata["Work area"]){let n=l.listMetadata["Work area"];Array.isArray(n)&&n.forEach(a=>{let o=a.trim();o&&e.add(o)})}}),Array.from(e).sort((l,n)=>l==="All work areas"?-1:n==="All work areas"?1:l.localeCompare(n))}function Oe(t,e){let l=new Map;return t.forEach(n=>{l.set(n,0)}),e.forEach(n=>{if(n.listMetadata&&n.listMetadata["Work area"]){let a=n.listMetadata["Work area"];Array.isArray(a)&&a.forEach(o=>{let s=o.trim();s&&l.has(s)&&l.set(s,l.get(s)+1)})}}),l.has("All work areas")&&l.set("All work areas",e.length),l}function ie(t){j=t,console.log(`Stored ${t.length} static work areas`)}function Fe(t){let e=document.getElementById("document_type");if(!e){console.warn("Work area dropdown #document_type not found");return}e.innerHTML="";let l=document.createElement("option");l.value="",l.textContent="Select a work area",l.disabled=!0,l.selected=!0,e.appendChild(l),t.forEach(n=>{let a=document.createElement("option");a.value=n,a.textContent=n,e.appendChild(a)}),console.log(`Populated work area dropdown with ${t.length} options`),k&&(k.destroy(),k=null),(!e.nextElementSibling||!e.nextElementSibling.classList.contains("aikb-multiselect-container"))&&(k=se(e))}function He(){let t=document.getElementById("select-question-3");if(!t){console.warn("Sort dropdown container #select-question-3 not found");return}let e=document.getElementById("owner");if(e)e.innerHTML="";else{let n=t.querySelector("label");if(t.innerHTML="",n)t.appendChild(n);else{let s=document.createElement("label");s.className="ntgc-form-input--label",s.setAttribute("for","select-input-2"),s.textContent="Sort",t.appendChild(s)}let a=document.createElement("div");a.className="aikb-dropdown-wrapper";let o=document.createElement("div");o.className="aikb-dropdown-inner",e=document.createElement("select"),e.name="sort",e.className="ntgc-select ntgc-select--block ntgc-select-input--filter",e.id="owner",o.appendChild(e),a.appendChild(o),t.appendChild(a)}let l=[{value:"relevance",label:"Relevance",selected:!0},{value:"date-newest",label:"Date (newest first)"},{value:"date-oldest",label:"Date (oldest first)"},{value:"title-az",label:"Title (A-Z)"},{value:"title-za",label:"Title (Z-A)"}];l.forEach(n=>{let a=document.createElement("option");a.value=n.value,a.textContent=n.label,n.selected&&(a.selected=!0),e.appendChild(a)}),console.log(`Populated sort dropdown with ${l.length} options`)}function We(){let t=document.getElementById("document_type");if(t&&!t.parentElement.querySelector(".aikb-dropdown-icon")){let l=document.createElement("div");l.className="aikb-dropdown-icon",l.setAttribute("data-colour","NTG Blue");let n=t.closest(".aikb-dropdown-wrapper");if(n){let a=n.querySelector(".aikb-dropdown-inner");a&&a.appendChild(l)}}let e=document.getElementById("owner");if(e&&!e.parentElement.querySelector(".aikb-dropdown-icon")){let l=document.createElement("div");l.className="aikb-dropdown-icon",l.setAttribute("data-colour","NTG Blue");let n=e.closest(".aikb-dropdown-wrapper");if(n){let a=n.querySelector(".aikb-dropdown-inner");a&&a.appendChild(l)}}}function re(t,e=null){console.log("Initializing dropdowns with search data...");let l;e&&e.length>0?(l=e,console.log("Using pre-fetched static work areas list")):j.length>0?(l=j,console.log("Using stored static work areas list")):(l=Te(t),console.log("Extracted work areas from results (fallback)")),Fe(l);let n=Oe(l,t);k&&k.updateCounts(n),He(),We(),console.log("Dropdowns initialized successfully")}var k,j,$=g(()=>{U();k=null,j=[]});function de(t){let e=document.getElementById("appliedFiltersSection"),l=document.getElementById("appliedFilters"),n=document.getElementById("clearAllBtn");if(!e||!l){console.warn("Applied filters section not found");return}l.innerHTML="";let a=!1;if(t.searchQuery&&t.searchQuery.trim()){a=!0;let o=ce("Search",t.searchQuery,"bg-success","search");l.appendChild(o)}t.workAreas&&t.workAreas.length>0&&(ze(t.workAreas)||(a=!0,t.workAreas.forEach(s=>{let i=ce("Work area",s,"bg-primary","work-area",s);l.appendChild(i)}))),n&&(n.style.display=a?"inline-flex":"none",n.style.marginLeft="8px",n.style.verticalAlign="middle",n.style.alignItems="center",l.appendChild(n)),e.style.display=a?"block":"none"}function ze(t){let e=document.getElementById("document_type");if(!e)return!1;let l=Array.from(e.options).filter(n=>!n.disabled&&n.value).length;return t.length===l}function ce(t,e,l,n,a){let o=document.createElement("span");o.className=`badge ${l} filter-pill d-inline-flex align-items-center`;let s=document.createElement("span");s.className="pill-label",s.textContent=`${t}:`;let i=document.createElement("span");i.className="pill-value",i.textContent=e;let r=document.createElement("button");r.type="button",r.className="pill-remove",r.title=`Remove ${t}: ${e}`,r.setAttribute("data-filter-type",n),a&&r.setAttribute("data-filter-value",a);let c=document.createElement("span");return c.className="fas fa-times",r.appendChild(c),r.addEventListener("click",p=>{p.preventDefault(),qe(n,a)}),o.appendChild(s),o.appendChild(i),o.appendChild(r),o}async function qe(t,e){switch(console.log(`Removing filter: ${t}`,e),t){case"search":let l=document.getElementById("search");if(l){l.value="";let{loadInitialResults:a}=await Promise.resolve().then(()=>(S(),J));a()}break;case"work-area":let n=document.getElementById("document_type");if(n&&e){let a=Array.from(n.options).find(i=>i.value===e);a&&(a.selected=!1);let o=new Event("change",{bubbles:!0});n.dispatchEvent(o);let s=n.nextElementSibling;if(s&&s.classList.contains("aikb-multiselect-container")){let i=s.__multiSelectInstance;i&&(i.selectedValues.delete(e),i.syncNativeSelect(),i.updateDisplayText(),i.triggerChange())}}break}}async function Ve(){console.log("Clearing all filters");let t=document.getElementById("search");t&&(t.value="");let e=document.getElementById("document_type");if(e){Array.from(e.options).forEach(o=>{!o.disabled&&o.value&&(o.selected=!0)});let a=e.nextElementSibling;if(a&&a.classList.contains("aikb-multiselect-container")){let o=a.__multiSelectInstance;o&&typeof o.selectAllByDefault=="function"&&(o.selectAllByDefault(),o.triggerChange())}}let l=document.getElementById("appliedFiltersSection");l&&(l.style.display="none");let{loadInitialResults:n}=await Promise.resolve().then(()=>(S(),J));n()}function ue(){let t=document.getElementById("clearAllBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),Ve()})}function pe(){let t=document.getElementById("search"),e=document.getElementById("document_type"),l=document.getElementById("sort")||document.getElementById("owner"),n={searchQuery:t?t.value:"",workAreas:[],sort:l?l.value:"relevance"};if(e){let a=Array.from(e.selectedOptions||[]);n.workAreas=a.map(o=>o.value).filter(o=>o&&o.trim().length>0)}return n}var B=g(()=>{});function v(t){let e=new Set,l=[];t.forEach((n,a)=>{let o=n.liveUrl||n.url||n.title||JSON.stringify(n)+a;e.has(o)||(e.add(o),l.push(n))}),x=l,console.log(`Stored ${x.length} results for filtering/sorting (${t.length-x.length} duplicates removed)`)}function Ue(t){if(!t||t.length===0)return x;let e=new Set,l=[];return x.forEach((n,a)=>{if(!n.listMetadata||!n.listMetadata["Work area"])return;let o=n.listMetadata["Work area"];if(t.some(i=>o.includes(i))){let i=n.liveUrl||n.url||n.title||JSON.stringify(n)+a;e.has(i)||(e.add(i),l.push(n))}}),l}function je(t,e){let l=[...t];switch(e){case"relevance":l.sort((n,a)=>n.rank&&a.rank?n.rank-a.rank:n.score&&a.score?a.score-n.score:0);break;case"date-newest":l.sort((n,a)=>{let o=n.date?new Date(n.date).getTime():0;return(a.date?new Date(a.date).getTime():0)-o});break;case"date-oldest":l.sort((n,a)=>{let o=n.date?new Date(n.date).getTime():0,s=a.date?new Date(a.date).getTime():0;return o-s});break;case"title-az":l.sort((n,a)=>{let o=n.title||"",s=a.title||"";return o.localeCompare(s)});break;case"title-za":l.sort((n,a)=>{let o=n.title||"";return(a.title||"").localeCompare(o)});break;default:break}return l}async function b(){if(K){console.log("Filter/sort already in progress, skipping duplicate call");return}K=!0;try{let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(!t||!e){console.warn("Required dropdowns not found (document_type or sort)");return}let l=[];t&&(l=Array.from(t.selectedOptions||[]).map(c=>c.value).filter(c=>c&&c.trim().length>0));let n=e.value||"relevance";console.log(`Applying filters - Work Areas: [${l.join(", ")}], Sort: "${n}"`);let a=Ue(l);console.log(`After filtering: ${a.length} results`);let o=je(a,n);console.log(`After sorting: ${o.length} results`);let{renderResults:s}=await Promise.resolve().then(()=>(C(),oe));s(o,"search-results-list");let i=pe();de(i)}finally{K=!1}}function me(){if(he){console.log("Filter and sort listeners already initialized, skipping");return}let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(t){t.addEventListener("change",function(){console.log("Work area filter changed"),b()});let l=t.nextElementSibling;l&&l.classList.contains("aikb-multiselect-container")&&l.addEventListener("multiselect-change",()=>{console.log("Work area filter applied via custom multi-select"),b()}),typeof window.$<"u"&&window.$(t).on("sumo:closed",function(){console.log("Work area filter applied via SumoSelect OK"),b()})}e&&e.addEventListener("change",function(){console.log(`Sort changed to: ${this.value}`),b()}),he=!0,console.log("Filter and sort listeners initialized")}var x,K,he,N=g(()=>{B();x=[];K=!1;he=!1});var J={};M(J,{loadInitialResults:()=>be});async function Je(){let t=ee();console.log(`Fetching work areas from ${t}...`);try{let e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let l=await e.json();return console.log("Work areas loaded successfully:",l),Array.isArray(l)?l:[]}catch(e){return console.error(`Error fetching work areas from ${t}:`,e),null}}function be(){if(!document.getElementById("search-results-list")){console.warn("search-results-list container not found on page");return}let e=E(),l=Y(),n=X();console.log(`Loading initial results from ${e.isProduction?"live API":"local JSON"}...`),Je().then(a=>{a&&(ye=a,ie(a))}),fetch(l).then(a=>{if(console.log(`Primary source (${l}) response status:`,a.status,a.ok),!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return a.json()}).then(a=>{console.log(`Primary source data loaded successfully (${e.isProduction?"live API":"local JSON"}):`,a),ge(a,e.isProduction?"live-api":"local")}).catch(a=>{console.error(`Error loading from primary source (${l}):`,a),n?(console.log("Attempting fallback to local JSON..."),fetch(n).then(o=>{if(console.log("Fallback JSON response status:",o.status,o.ok),!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.json()}).then(o=>{console.log("Fallback JSON data loaded successfully:",o),ge(o,"fallback")}).catch(o=>{console.error("Error loading fallback search.json:",o),fe()})):fe()})}function fe(){let t=document.getElementById("search-results-list");t&&(t.innerHTML='<p class="aikb-error">Unable to load search results. Please check your connection and try again later.</p>')}function ge(t,e="unknown"){let n=(Array.isArray(t)?t:[]).map(s=>({title:s.title||"",summary:s.description||s.summary||"",listMetadata:{"Work area":s["work-area"]||[],Roles:s.roles||[],Benefits:s.benefits||[]},date:s["last-updated"]?new Date(s["last-updated"]).toLocaleDateString("en-AU",{year:"numeric",month:"long"}):"",liveUrl:s.url||s.liveUrl||"",submittedBy:s["submitted-by"]||""}));console.log(`Rendering ${n.length} cards from ${e}`);let a=new Set,o=[];n.forEach((s,i)=>{let r=s.liveUrl||s.url||s.title||JSON.stringify(s)+i;a.has(r)||(a.add(r),o.push(s))}),n.length!==o.length&&console.log(`Removed ${n.length-o.length} duplicate items from source data`),v(o),window.aikbSearchCache=o,console.log(`Cached ${o.length} results for offline search`),re(o,ye),me(),_(o,"search-results-list")}var ye,S=g(()=>{C();$();N();R();ye=null;window.addEventListener("load",function(){console.log("Page load event fired, loading initial results..."),setTimeout(be,200)})});function we(t,e){if(!t||!e||e.length===0)return console.log("Offline search: No keywords or no cached results available"),[];let l=t.toLowerCase().replace(/[^\w\s]/g,"").trim();if(!l)return console.log("Offline search: Keywords empty after normalization"),[];console.log(`Offline search: Searching for "${t}" in ${e.length} cached results`);let n=new RegExp(l,"gi"),o=e.map(s=>{let i=0,r=0,c=0,p=0;if(s.title){let d=s.title.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(r=d.length,i+=r*3)}if(s.summary){let d=s.summary.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(c=d.length,i+=c*1)}if(s.metadata){let d=s.metadata.toLowerCase().replace(/[^\w\s]/g,"").match(n);d&&(p=d.length,i+=p*2)}return{...s,_offlineScore:i,_offlineMatches:{title:r,summary:c,metadata:p}}}).filter(s=>s._offlineScore>0);return o.sort((s,i)=>i._offlineScore-s._offlineScore),console.log(`Offline search: Found ${o.length} results matching "${t}"`),o.length>0&&(console.log("Offline search: Top results:"),o.slice(0,3).forEach((s,i)=>{console.log(`  ${i+1}. "${s.title}" (score: ${s._offlineScore}, title:${s._offlineMatches.title}, summary:${s._offlineMatches.summary}, metadata:${s._offlineMatches.metadata})`)})),o}function P(){return window.aikbSearchCache&&Array.isArray(window.aikbSearchCache)?(console.log(`Offline search: Retrieved ${window.aikbSearchCache.length} cached results`),window.aikbSearchCache):(console.log("Offline search: No cached data available"),null)}var Q=g(()=>{});var ke=D(()=>{S();C();Q();N();$();B();(function(){if(typeof window.$>"u"){console.warn("jQuery not loaded; search form handler disabled");return}let e=window.$("#policy-search-form"),l=window.$("#search");if(e.length===0){console.error("Form #policy-search-form not found");return}function n(){return{query:l.val()||"",area:window.$("#document_type").val()||""}}function a(i){i.preventDefault()}function o(){l.val(""),console.log("Search cleared - restoring filtered view of all results");let i=P();i&&i.length>0&&(v(i),b())}e.on("submit",a),window.$("#clear-input").on("click",o),l.on("input",function(){let i=window.$("#clear-input");window.$(this).val().length>0?i.attr("hidden",!1):i.attr("hidden","")}),l.on("keydown",function(i){if(i.key==="Enter"||i.keyCode===13){i.preventDefault();let r=window.$(this).val();if(r.trim())s(r);else{console.log("Empty search via Enter - restoring filtered view of all results");let c=P();c&&c.length>0&&(v(c),b())}}});function s(i){if(!i.trim())return;console.log(`Triggered search for: "${i}"`);let r=P();if(r&&r.length>0){console.log("Performing local search");let c=we(i,r);v(c),b(),console.log(`Local search: Found ${c.length} results, applying filters`)}else{console.error("No cached data available for search");let c=window.$("#search-results-list");c.length>0&&c.html('<p class="aikb-error">Unable to load search results. Please check your connection and try again.</p>')}}console.log("Search form handler initialized")})()});var Ee=D(()=>{var Ke='div[data-hydration-component="squiz-call-to-action"] a';function ve(t=document){t.querySelectorAll(Ke).forEach(l=>{l.classList.add("ntgc-btn","ntgc-btn--primary")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>ve()):ve()});var Qe=D(()=>{R();var At=Z(ke());N();C();$();Q();U();S();var It=Z(Ee());z();B();console.log("[aikb] Landing page bundle loaded successfully");console.log("[aikb] jQuery available:",typeof window.jQuery<"u");console.log("[aikb] DOM ready state:",document.readyState);window.addEventListener("load",function(){ue(),console.log("[aikb] Applied filters initialized")})});Qe();})();
//# sourceMappingURL=landing-page.min.js.map
