(()=>{var Pe=Object.create;var R=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var De=Object.getOwnPropertyNames;var Re=Object.getPrototypeOf,We=Object.prototype.hasOwnProperty;var y=(e,t)=>()=>(e&&(t=e(e=0)),t);var W=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),F=(e,t)=>{for(var o in t)R(e,o,{get:t[o],enumerable:!0})},Fe=(e,t,o,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of De(t))!We.call(e,n)&&n!==o&&R(e,n,{get:()=>t[n],enumerable:!(a=Ie(t,n))||a.enumerable});return e};var oe=(e,t,o)=>(o=e!=null?Pe(Re(e)):{},Fe(t||!e||!e.__esModule?R(o,"default",{value:e,enumerable:!0}):o,e));function le(){return window.location.hostname==="ntgcentral.nt.gov.au"}function S(){return{isProduction:le(),liveApiUrl:"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/articles/_nocache",fallbackJsonUrl:"./dist/search.json",workAreasUrl:le()?"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/work-areas/_nocache":"./src/data/work-areas.json"}}function se(){let e=S();return e.isProduction?e.liveApiUrl:e.fallbackJsonUrl}function ie(){let e=S();return e.isProduction?e.fallbackJsonUrl:null}function re(){return S().workAreasUrl}var ce,$=y(()=>{ce=new Set(["a","au","all","am","an","and","any","are","as","at","be","been","but","by","can","cant","co","com","de","do","eg","else","etc","for","from","get","go","had","has","hasnt","have","he","hence","her","here","hers","him","his","how","http","https","i","ie","if","in","is","it","its","la","me","my","nor","not","now","of","off","on","or","our","ours","pm","put","re","she","so","than","that","the","their","them","then","there","these","they","this","those","thus","to","too","uk","un","until","up","upon","us","very","via","was","we","well","were","what","when","where","which","while","who","why","www","you","your","yours"])});var he={};F(he,{getCurrentPage:()=>He,getCurrentPageResults:()=>ue,getTotalPages:()=>q,initializePagination:()=>Oe,updatePagination:()=>Ue});function Oe(e,t=10){z=e,M=t,H=e.length,p=1,ze(),V()}function ue(){let e=(p-1)*M,t=e+M;return z.slice(e,t)}function He(){return p}function q(){return Math.ceil(H/M)}function ze(){if(f=document.getElementById("aikb-pagination"),!f){let e=document.getElementById("search-results-list");e&&e.parentNode&&(f=document.createElement("div"),f.id="aikb-pagination",f.className="aikb-pagination",e.parentNode.insertBefore(f,e.nextSibling))}}function V(){if(!f)return;let e=q();if(e<=1){f.innerHTML="",f.style.display="none";return}f.style.display="flex";let t=document.createElement("div");t.className="aikb-pagination__wrapper";let o=de("Previous",p>1,()=>{p>1&&O(p-1)});t.appendChild(o);let a=qe(e);t.appendChild(a);let n=de("Next",p<e,()=>{p<e&&O(p+1)});t.appendChild(n),f.innerHTML="",f.appendChild(t)}function de(e,t,o){let a=document.createElement("div");a.className="aikb-pagination__control",t||a.classList.add("aikb-pagination__control--disabled");let n=document.createElement("div");if(n.className="aikb-pagination__icon-label",e==="Previous"){let s=document.createElement("span");s.className="fal fa-chevron-left",s.setAttribute("aria-hidden","true"),n.appendChild(s)}let l=document.createElement("span");if(l.className="aikb-pagination__text",l.textContent=e,n.appendChild(l),e==="Next"){let s=document.createElement("span");s.className="fal fa-chevron-right",s.setAttribute("aria-hidden","true"),n.appendChild(s)}return a.appendChild(n),t&&(a.addEventListener("click",o),a.style.cursor="pointer"),a}function qe(e){let t=document.createElement("div");return t.className="aikb-pagination__pages",Ve(p,e).forEach(a=>{if(a==="..."){let n=document.createElement("span");n.className="aikb-pagination__ellipsis",n.textContent="...",t.appendChild(n)}else{let n=document.createElement("div");n.className="aikb-pagination__page-number",a===p&&n.classList.add("aikb-pagination__page-number--active");let l=document.createElement("span");l.textContent=a,n.appendChild(l),n.addEventListener("click",()=>O(a)),n.style.cursor="pointer",t.appendChild(n)}}),t}function Ve(e,t){if(t<=7)return Array.from({length:t},(l,s)=>s+1);let o=[];o.push(1),e>3&&o.push("...");let a=Math.max(2,e-1),n=Math.min(t-1,e+1);for(let l=a;l<=n;l++)o.push(l);return e<t-2&&o.push("..."),o.push(t),o}function O(e){let t=q();if(e<1||e>t||e===p)return;p=e,V();let o=new CustomEvent("aikb-pagination-change",{detail:{page:p,results:ue()}});document.dispatchEvent(o);let a=document.getElementById("search-results-list");if(a){let l=a.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:l,behavior:"smooth"})}}function Ue(e){z=e,H=e.length,p=1,V()}var p,M,H,z,f,U=y(()=>{p=1,M=10,H=0,z=[],f=null});var me={};F(me,{renderResults:()=>B});function je(e){if(!e)return"";if(/^[A-Z][a-z]+ \d{4}$/.test(e))return e;try{let o=new Date(e);if(!isNaN(o.getTime()))return`${["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]} ${o.getFullYear()}`}catch{}return e}function j(e,t){if(!e||!t||t.length===0)return e;let o=e;return[...t].sort((n,l)=>l.length-n.length).forEach(n=>{let l=new RegExp(`(?!<mark[^>]*>)(${n})(?![^<]*</mark>)`,"gi");o=o.replace(l,"<mark>$1</mark>")}),o}function J(e,t){e.innerHTML="";let a=new DOMParser().parseFromString(t,"text/html");Array.from(a.body.childNodes).forEach(n=>{e.appendChild(n.cloneNode(!0))})}function Q(e){if(!e.title||!e.summary||!e.liveUrl)return console.warn("Skipping card with missing required fields:",e),null;let t=document.createElement("div");t.className="aikb-search-card";let o=e._offlineScore||(e.rank?-e.rank:e.score||0);t.setAttribute("data-sort-relevance",o),t.setAttribute("data-sort-title",e.title);let a=e.dateTimestamp||0;t.setAttribute("data-sort-date",a);let n=document.createElement("div");n.className="aikb-search-card__inner";let l=document.createElement("div");l.className="aikb-search-card__content";let s=document.createElement("div");s.className="aikb-search-card__text";let i=document.createElement("h3");if(i.className="aikb-search-card__title",e._matchedTerms&&e._matchedTerms.length>0){let h=j(e.title,e._matchedTerms);J(i,h)}else i.textContent=e.title;s.appendChild(i);let r=document.createElement("p");if(r.className="aikb-search-card__summary",e._matchedTerms&&e._matchedTerms.length>0){let h=j(e.summary,e._matchedTerms);J(r,h)}else r.textContent=e.summary;s.appendChild(r),l.appendChild(s);let c=e.listMetadata&&e.listMetadata["Work area"]?e.listMetadata["Work area"]:[];if(c&&c.length>0){let h=document.createElement("div");h.className="aikb-search-card__tags",c.forEach(g=>{if(g&&g.trim()){let w=document.createElement("div");w.className="aikb-search-card__tag",w.textContent=g.trim(),h.appendChild(w)}}),h.children.length>0&&l.appendChild(h)}n.appendChild(l);let u=document.createElement("div");u.className="aikb-search-card__actions";let d=document.createElement("a");d.href=e.liveUrl,d.className="ntgc-btn ntgc-btn--secondary";let m=document.createElement("span");m.textContent="See more",d.appendChild(m);let C=document.createElement("span");C.className="fal fa-long-arrow-right",C.setAttribute("aria-hidden","true"),d.appendChild(C),u.appendChild(d);let E=document.createElement("div");E.className="aikb-search-card__metadata";let I=e.listMetadata&&e.listMetadata.Roles?e.listMetadata.Roles:[];if(I&&I.length>0){let h=document.createElement("div");h.className="aikb-search-card__useful-for";let g=document.createElement("span");g.className="aikb-search-card__useful-value";let w=document.createElement("strong");w.textContent="Good for: ",g.appendChild(w);let ne=I.join(", ");if(e._matchedTerms&&e._matchedTerms.length>0){let D=j(ne,e._matchedTerms),ae=document.createElement("span");J(ae,D),Array.from(ae.childNodes).forEach(Te=>{g.appendChild(Te)})}else{let D=document.createTextNode(ne);g.appendChild(D)}h.appendChild(g),E.appendChild(h)}if(e.date){let h=document.createElement("div");h.className="aikb-search-card__date",h.textContent=`Last updated: ${je(e.date)}`,E.appendChild(h)}return u.appendChild(E),n.appendChild(u),t.appendChild(n),t}function B(e,t="search-results-list",o=!0){console.log(`renderResults called with ${e.length} results for container #${t}`);let a=document.getElementById(t);if(console.log(`document.getElementById("${t}"):`,a),!a){let n=window.$?window.$(`#${t}`):null;console.log(`jQuery selector $("#${t}"):`,n),a=n&&n.length>0?n[0]:null}if(!a){console.error(`Container #${t} not found`),console.log("Available elements with id:",Array.from(document.querySelectorAll("[id]")).map(n=>n.id));return}if(a.innerHTML="",e.length===0){let n=document.createElement("p");n.textContent="No results found.",n.style.padding="24px 48px",a.appendChild(n);return}if(o)Promise.resolve().then(()=>(U(),he)).then(({initializePagination:n,getCurrentPageResults:l})=>{n(e,10);let i=l().map(r=>Q(r)).filter(r=>r!==null);i.forEach(r=>a.appendChild(r)),console.log(`Rendered ${i.length} of ${e.length} search result cards (page 1)`)});else{let n=e.map(l=>Q(l)).filter(l=>l!==null);n.forEach(l=>a.appendChild(l)),console.log(`Rendered ${n.length} search result cards`)}}var pe,A=y(()=>{window.aikbRenderResults=B;pe=!1;pe||(document.addEventListener("aikb-pagination-change",e=>{let{results:t}=e.detail,o=document.getElementById("search-results-list");if(o&&t){o.innerHTML="";let a=t.map(n=>Q(n)).filter(n=>n!==null);a.forEach(n=>o.appendChild(n)),console.log(`Rendered ${a.length} cards for page ${e.detail.page}`)}}),pe=!0)});function fe(e){let t=typeof e=="string"?document.querySelector(e):e;return t?new K(t):(console.warn("Multi-select element not found:",e),null)}var K,Z=y(()=>{K=class{constructor(t){this.selectElement=t,this.options=[],this.selectedValues=new Set,this.tempSelectedValues=new Set,this.isOpen=!1,this.container=null,this.displayButton=null,this.dropdownPanel=null,this._boundHandlers={},this.init()}init(){this.selectElement.style.display="none",this.createDropdownStructure(),this.selectAllByDefault(),this.bindEvents(),this.container.__multiSelectInstance=this}selectAllByDefault(){this.options.forEach(t=>{let o=Array.from(this.selectElement.options).find(a=>a.value===t.value);o&&!o.disabled&&this.selectedValues.add(t.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.tempSelectedValues=new Set(this.selectedValues)}createDropdownStructure(){this.container=document.createElement("div"),this.container.className="aikb-multiselect-container",this.displayButton=document.createElement("button"),this.displayButton.type="button",this.displayButton.className="aikb-multiselect-button",this.displayButton.innerHTML=`
      <span class="aikb-multiselect-text">Select Options</span>
      <span class="aikb-multiselect-icon"></span>
    `,this.dropdownPanel=document.createElement("div"),this.dropdownPanel.className="aikb-multiselect-panel",this.dropdownPanel.style.display="none";let t=document.createElement("div");t.className="aikb-multiselect-options";let o=this.createOptionItem({value:"_select_all",label:"Select All",isSelectAll:!0});t.appendChild(o),Array.from(this.selectElement.options).forEach(s=>{if(!s.disabled&&s.value){this.options.push({value:s.value,label:s.textContent});let i=this.createOptionItem({value:s.value,label:s.textContent});t.appendChild(i)}});let a=document.createElement("div");a.className="aikb-multiselect-actions";let n=document.createElement("button");n.type="button",n.className="aikb-multiselect-btn aikb-multiselect-btn-ok",n.textContent="OK",this._boundHandlers.okClick=()=>this.handleOk(),n.addEventListener("click",this._boundHandlers.okClick);let l=document.createElement("button");l.type="button",l.className="aikb-multiselect-btn aikb-multiselect-btn-cancel",l.textContent="Cancel",this._boundHandlers.cancelClick=()=>this.handleCancel(),l.addEventListener("click",this._boundHandlers.cancelClick),a.appendChild(n),a.appendChild(l),this.dropdownPanel.appendChild(t),this.dropdownPanel.appendChild(a),this._boundHandlers.checkboxChange=s=>{s.target.classList.contains("aikb-multiselect-checkbox")&&(s.target.value==="_select_all"?this.handleSelectAll(s):this.updateSelectAllState())},this.dropdownPanel.addEventListener("change",this._boundHandlers.checkboxChange),this.container.appendChild(this.displayButton),this.container.appendChild(this.dropdownPanel),this.selectElement.parentNode.insertBefore(this.container,this.selectElement.nextSibling)}createOptionItem(t){let o=document.createElement("label");o.className="aikb-multiselect-option",t.isSelectAll&&o.classList.add("aikb-multiselect-option-all");let a=document.createElement("input");a.type="checkbox",a.className="aikb-multiselect-checkbox",a.value=t.value,a.dataset.label=t.label;let n=document.createElement("span");return n.className="aikb-multiselect-label",n.textContent=t.label,o.appendChild(a),o.appendChild(n),o}bindEvents(){this._boundHandlers.displayClick=t=>{t.stopPropagation(),this.toggle()},this.displayButton.addEventListener("click",this._boundHandlers.displayClick),this._boundHandlers.documentClick=t=>{this.container&&!this.container.contains(t.target)&&this.isOpen&&this.handleCancel()},document.addEventListener("click",this._boundHandlers.documentClick)}toggle(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): toggle");return}this.isOpen?this.close():this.open()}open(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): open");return}this.isOpen=!0,this.dropdownPanel.style.display="block",this.displayButton.classList.add("aikb-multiselect-open"),this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes()}close(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): close");return}this.isOpen=!1,this.dropdownPanel.style.display="none",this.displayButton.classList.remove("aikb-multiselect-open")}handleOk(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleOk");return}let t=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])');this.selectedValues.clear(),t.forEach(o=>{o.checked&&this.selectedValues.add(o.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.triggerChange(),this.close()}handleCancel(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleCancel");return}this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes(),this.close()}handleSelectAll(t){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): handleSelectAll");return}let o=t.target.checked;this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(n=>{n.disabled||(n.checked=o)})}updateSelectAllState(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateSelectAllState");return}let t=this.dropdownPanel.querySelector('.aikb-multiselect-checkbox[value="_select_all"]'),o=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])'),a=Array.from(o).filter(l=>!l.disabled),n=a.filter(l=>l.checked).length;t&&(t.checked=a.length>0&&n===a.length,t.indeterminate=n>0&&n<a.length)}updateCheckboxes(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateCheckboxes");return}this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(o=>{o.checked=this.tempSelectedValues.has(o.value)}),this.updateSelectAllState()}updateDisplayText(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateDisplayText");return}let t=this.displayButton.querySelector(".aikb-multiselect-text");if(this.selectedValues.size===0)t.textContent="Select Options",t.classList.remove("aikb-multiselect-has-selection");else if(this.selectedValues.size===this.options.length)t.textContent="All selected",t.classList.add("aikb-multiselect-has-selection");else if(this.selectedValues.size===1){let o=Array.from(this.selectedValues).map(a=>{let n=this.options.find(l=>l.value===a);return n?n.label:a});t.textContent=o[0],t.classList.add("aikb-multiselect-has-selection")}else t.textContent=`${this.selectedValues.size} selected`,t.classList.add("aikb-multiselect-has-selection")}triggerChange(){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): triggerChange");return}let t=new CustomEvent("multiselect-change",{detail:{values:Array.from(this.selectedValues)}});if(this.container.dispatchEvent(t),this.selectElement){let o=new Event("change",{bubbles:!0});this.selectElement.dispatchEvent(o)}console.log("Multi-select changed:",Array.from(this.selectedValues))}syncNativeSelect(){this.selectElement&&(Array.from(this.selectElement.options).forEach(t=>{t.selected=!1}),Array.from(this.selectElement.options).forEach(t=>{this.selectedValues.has(t.value)&&(t.selected=!0)}))}getSelectedValues(){return Array.from(this.selectedValues)}reset(){this.selectedValues.clear(),this.tempSelectedValues.clear(),this.updateDisplayText(),this.updateCheckboxes()}updateCounts(t){if(!this.container||!this.dropdownPanel){console.warn("MultiSelect method called after destroy(): updateCounts");return}Array.from(this.selectElement.options).forEach(a=>{if(a.value&&t.has(a.value)){let n=t.get(a.value),l=a.textContent.replace(/\s*\(\d+\)\s*$/,"");n>0?(a.textContent=`${l} (${n})`,a.disabled=!1):(a.textContent=l,a.disabled=!0,a.selected=!1)}}),this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(a=>{let n=a.value;if(t.has(n)){let l=t.get(n),s=a.parentElement,i=s.querySelector(".aikb-multiselect-label");if(i){let r=i.querySelector(".aikb-count-badge");r&&r.remove();let c=i.textContent.replace(/\s*\(\d+\)\s*$/,"").trim();i.textContent=c;let u=document.createElement("span");if(u.className="aikb-count-badge",u.textContent=l.toString(),i.appendChild(u),l===0){a.disabled=!0,a.checked=!1,s.classList.add("aikb-multiselect-option-disabled"),this.selectedValues.delete(n),this.tempSelectedValues.delete(n);let d=this.options.findIndex(m=>m.value===n);d!==-1&&(this.options[d].label=`${c} (${l})`)}else{a.disabled=!1,s.classList.remove("aikb-multiselect-option-disabled");let d=this.options.findIndex(m=>m.value===n);d!==-1&&(this.options[d].label=`${c} (${l})`)}}}}),this.syncNativeSelect(),this.updateDisplayText(),console.log("Multi-select counts updated")}destroy(){this._boundHandlers&&(this._boundHandlers.documentClick&&document.removeEventListener("click",this._boundHandlers.documentClick),this.displayButton&&this._boundHandlers.displayClick&&this.displayButton.removeEventListener("click",this._boundHandlers.displayClick),this.dropdownPanel&&this._boundHandlers.checkboxChange&&this.dropdownPanel.removeEventListener("change",this._boundHandlers.checkboxChange)),this.isOpen=!1,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.selectElement&&(this.selectElement.style.display=""),this.container=null,this.displayButton=null,this.dropdownPanel=null,this._boundHandlers=null,console.log("Multi-select instance destroyed")}}});function Je(e){let t=new Set;return e.forEach(o=>{if(o.listMetadata&&o.listMetadata["Work area"]){let a=o.listMetadata["Work area"];Array.isArray(a)&&a.forEach(n=>{let l=n.trim();l&&t.add(l)})}}),Array.from(t).sort((o,a)=>o==="All work areas"?-1:a==="All work areas"?1:o.localeCompare(a))}function Qe(e,t){let o=new Map;return e.forEach(a=>{o.set(a,0)}),t.forEach(a=>{if(a.listMetadata&&a.listMetadata["Work area"]){let n=a.listMetadata["Work area"];Array.isArray(n)&&n.forEach(l=>{let s=l.trim();s&&o.has(s)&&o.set(s,o.get(s)+1)})}}),o.has("All work areas")&&o.set("All work areas",t.length),o}function ge(e){G=e,console.log(`Stored ${e.length} static work areas`)}function Ke(e){let t=document.getElementById("document_type");if(!t){console.warn("Work area dropdown #document_type not found");return}t.innerHTML="";let o=document.createElement("option");o.value="",o.textContent="Select a work area",o.disabled=!0,o.selected=!0,t.appendChild(o),e.forEach(a=>{let n=document.createElement("option");n.value=a,n.textContent=a,t.appendChild(n)}),console.log(`Populated work area dropdown with ${e.length} options`),k&&(k.destroy(),k=null),(!t.nextElementSibling||!t.nextElementSibling.classList.contains("aikb-multiselect-container"))&&(k=fe(t))}function Ze(){let e=document.getElementById("select-question-3");if(!e){console.warn("Sort dropdown container #select-question-3 not found");return}let t=document.getElementById("owner");if(t)t.innerHTML="";else{let a=e.querySelector("label");if(e.innerHTML="",a)e.appendChild(a);else{let s=document.createElement("label");s.className="ntgc-form-input--label",s.setAttribute("for","select-input-2"),s.textContent="Sort",e.appendChild(s)}let n=document.createElement("div");n.className="aikb-dropdown-wrapper";let l=document.createElement("div");l.className="aikb-dropdown-inner",t=document.createElement("select"),t.name="sort",t.className="ntgc-select ntgc-select--block ntgc-select-input--filter",t.id="owner",l.appendChild(t),n.appendChild(l),e.appendChild(n)}let o=[{value:"relevance",label:"Relevance",selected:!0},{value:"date-newest",label:"Date (newest first)"},{value:"date-oldest",label:"Date (oldest first)"},{value:"title-az",label:"Title (A-Z)"},{value:"title-za",label:"Title (Z-A)"}];o.forEach(a=>{let n=document.createElement("option");n.value=a.value,n.textContent=a.label,a.selected&&(n.selected=!0),t.appendChild(n)}),console.log(`Populated sort dropdown with ${o.length} options`)}function Ge(){let e=document.getElementById("document_type");if(e&&!e.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let a=e.closest(".aikb-dropdown-wrapper");if(a){let n=a.querySelector(".aikb-dropdown-inner");n&&n.appendChild(o)}}let t=document.getElementById("owner");if(t&&!t.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let a=t.closest(".aikb-dropdown-wrapper");if(a){let n=a.querySelector(".aikb-dropdown-inner");n&&n.appendChild(o)}}}function ye(e,t=null){console.log("Initializing dropdowns with search data...");let o;t&&t.length>0?(o=t,console.log("Using pre-fetched static work areas list")):G.length>0?(o=G,console.log("Using stored static work areas list")):(o=Je(e),console.log("Extracted work areas from results (fallback)")),Ke(o);let a=Qe(o,e);k&&k.updateCounts(a),Ze(),Ge(),console.log("Dropdowns initialized successfully")}var k,G,N=y(()=>{Z();k=null,G=[]});function we(e){let t=document.getElementById("appliedFiltersSection"),o=document.getElementById("appliedFilters"),a=document.getElementById("clearAllBtn");if(!t||!o){console.warn("Applied filters section not found");return}o.innerHTML="";let n=!1;if(e.searchQuery&&e.searchQuery.trim()){n=!0;let l=be("Search",e.searchQuery,"bg-success","search");o.appendChild(l)}e.workAreas&&e.workAreas.length>0&&(Ye(e.workAreas)||(n=!0,e.workAreas.forEach(s=>{let i=be("Work area",s,"bg-primary","work-area",s);o.appendChild(i)}))),a&&(a.style.display=n?"inline-flex":"none",a.style.marginLeft="8px",a.style.verticalAlign="middle",a.style.alignItems="center",o.appendChild(a)),t.style.display=n?"block":"none"}function Ye(e){let t=document.getElementById("document_type");if(!t)return!1;let o=Array.from(t.options).filter(a=>!a.disabled&&a.value).length;return e.length===o}function be(e,t,o,a,n){let l=document.createElement("span");l.className=`badge ${o} filter-pill d-inline-flex align-items-center`;let s=document.createElement("span");s.className="pill-label",s.textContent=`${e}:`;let i=document.createElement("span");i.className="pill-value",i.textContent=t;let r=document.createElement("button");r.type="button",r.className="pill-remove",r.title=`Remove ${e}: ${t}`,r.setAttribute("data-filter-type",a),n&&r.setAttribute("data-filter-value",n);let c=document.createElement("span");return c.className="fas fa-times",r.appendChild(c),r.addEventListener("click",u=>{u.preventDefault(),Xe(a,n)}),l.appendChild(s),l.appendChild(i),l.appendChild(r),l}async function Xe(e,t){switch(console.log(`Removing filter: ${e}`,t),e){case"search":let o=document.getElementById("search");if(o){o.value="";let{loadInitialResults:n}=await Promise.resolve().then(()=>(x(),Y));n()}break;case"work-area":let a=document.getElementById("document_type");if(a&&t){let n=Array.from(a.options).find(i=>i.value===t);n&&(n.selected=!1);let l=new Event("change",{bubbles:!0});a.dispatchEvent(l);let s=a.nextElementSibling;if(s&&s.classList.contains("aikb-multiselect-container")){let i=s.__multiSelectInstance;i&&(i.selectedValues.delete(t),i.syncNativeSelect(),i.updateDisplayText(),i.triggerChange())}}break}}async function et(){console.log("Clearing all filters");let e=document.getElementById("search");e&&(e.value="");let t=document.getElementById("document_type");if(t){Array.from(t.options).forEach(l=>{!l.disabled&&l.value&&(l.selected=!0)});let n=t.nextElementSibling;if(n&&n.classList.contains("aikb-multiselect-container")){let l=n.__multiSelectInstance;l&&typeof l.selectAllByDefault=="function"&&(l.selectAllByDefault(),l.triggerChange())}}let o=document.getElementById("appliedFiltersSection");o&&(o.style.display="none");let{loadInitialResults:a}=await Promise.resolve().then(()=>(x(),Y));a()}function ke(){let e=document.getElementById("clearAllBtn");e&&e.addEventListener("click",t=>{t.preventDefault(),et()})}function ve(){let e=document.getElementById("search"),t=document.getElementById("document_type"),o=document.getElementById("sort")||document.getElementById("owner"),a={searchQuery:e?e.value:"",workAreas:[],sort:o?o.value:"relevance"};if(t){let n=Array.from(t.selectedOptions||[]);a.workAreas=n.map(l=>l.value).filter(l=>l&&l.trim().length>0)}return a}var L=y(()=>{});function v(e){let t=new Set,o=[];e.forEach((a,n)=>{let l=a.liveUrl||a.url||a.title||JSON.stringify(a)+n;t.has(l)||(t.add(l),o.push(a))}),_=o,console.log(`Stored ${_.length} results for filtering/sorting (${e.length-_.length} duplicates removed)`)}function tt(e){if(!e||e.length===0)return _;let t=new Set,o=[];return _.forEach((a,n)=>{if(!a.listMetadata||!a.listMetadata["Work area"])return;let l=a.listMetadata["Work area"];if(e.some(i=>l.includes(i))){let i=a.liveUrl||a.url||a.title||JSON.stringify(a)+n;t.has(i)||(t.add(i),o.push(a))}}),o}function nt(e,t){let o=[...e];switch(t){case"relevance":o.sort((a,n)=>a.rank&&n.rank?a.rank-n.rank:a.score&&n.score?n.score-a.score:0);break;case"date-newest":o.sort((a,n)=>{let l=a.dateTimestamp||0;return(n.dateTimestamp||0)-l});break;case"date-oldest":o.sort((a,n)=>{let l=a.dateTimestamp||0,s=n.dateTimestamp||0;return l-s});break;case"title-az":o.sort((a,n)=>{let l=a.title||"",s=n.title||"";return l.localeCompare(s)});break;case"title-za":o.sort((a,n)=>{let l=a.title||"";return(n.title||"").localeCompare(l)});break;default:break}return o}function at(e){let t=document.getElementById("search-results-list");if(!t)return;let o=Array.from(t.querySelectorAll(".aikb-search-card"));console.log(`Sorting ${o.length} cards by ${e}`),o.sort((a,n)=>{switch(e){case"relevance":let l=parseFloat(a.getAttribute("data-sort-relevance"))||0;return(parseFloat(n.getAttribute("data-sort-relevance"))||0)-l;case"date-newest":let i=parseFloat(a.getAttribute("data-sort-date"))||0,r=parseFloat(n.getAttribute("data-sort-date"))||0;return console.log(`Comparing dates: ${i} vs ${r}`),r-i;case"date-oldest":let c=parseFloat(a.getAttribute("data-sort-date"))||0,u=parseFloat(n.getAttribute("data-sort-date"))||0;return console.log(`Comparing dates: ${c} vs ${u}`),c-u;case"title-az":let d=a.getAttribute("data-sort-title")||"",m=n.getAttribute("data-sort-title")||"";return d.localeCompare(m);case"title-za":let C=a.getAttribute("data-sort-title")||"";return(n.getAttribute("data-sort-title")||"").localeCompare(C);default:return 0}}),o.forEach(a=>t.appendChild(a)),console.log(`Cards sorted by ${e} in DOM using data attributes`)}async function b(){if(X){console.log("Filter/sort already in progress, skipping duplicate call");return}X=!0;try{let e=document.getElementById("document_type"),t=document.getElementById("sort")||document.getElementById("owner");if(!e||!t){console.warn("Required dropdowns not found (document_type or sort)");return}let o=[];e&&(o=Array.from(e.selectedOptions||[]).map(c=>c.value).filter(c=>c&&c.trim().length>0));let a=t.value||"relevance";console.log(`Applying filters - Work Areas: [${o.join(", ")}], Sort: "${a}"`);let n=tt(o);console.log(`After filtering: ${n.length} results`);let l=nt(n,a);console.log(`After sorting: ${l.length} results`);let{renderResults:s}=await Promise.resolve().then(()=>(A(),me));s(l,"search-results-list"),at(a);let i=ve();we(i)}finally{X=!1}}function Ee(){if(Ce){console.log("Filter and sort listeners already initialized, skipping");return}let e=document.getElementById("document_type"),t=document.getElementById("sort")||document.getElementById("owner");if(e){e.addEventListener("change",function(){console.log("Work area filter changed"),b()});let o=e.nextElementSibling;o&&o.classList.contains("aikb-multiselect-container")&&o.addEventListener("multiselect-change",()=>{console.log("Work area filter applied via custom multi-select"),b()}),typeof window.$<"u"&&window.$(e).on("sumo:closed",function(){console.log("Work area filter applied via SumoSelect OK"),b()})}t&&t.addEventListener("change",function(){console.log(`Sort changed to: ${this.value}`),b()}),Ce=!0,console.log("Filter and sort listeners initialized")}var _,X,Ce,T=y(()=>{L();_=[];X=!1;Ce=!1});var Y={};F(Y,{loadInitialResults:()=>_e});async function ot(){let e=re();console.log(`Fetching work areas from ${e}...`);try{let t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);let o=await t.json();return console.log("Work areas loaded successfully:",o),Array.isArray(o)?o:[]}catch(t){return console.error(`Error fetching work areas from ${e}:`,t),null}}function _e(){if(!document.getElementById("search-results-list")){console.warn("search-results-list container not found on page");return}let t=S(),o=se(),a=ie();console.log(`Loading initial results from ${t.isProduction?"live API":"local JSON"}...`),ot().then(n=>{n&&(xe=n,ge(n))}),fetch(o).then(n=>{if(console.log(`Primary source (${o}) response status:`,n.status,n.ok),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n.json()}).then(n=>{console.log(`Primary source data loaded successfully (${t.isProduction?"live API":"local JSON"}):`,n),Ae(n,t.isProduction?"live-api":"local")}).catch(n=>{console.error(`Error loading from primary source (${o}):`,n),a?(console.log("Attempting fallback to local JSON..."),fetch(a).then(l=>{if(console.log("Fallback JSON response status:",l.status,l.ok),!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return l.json()}).then(l=>{console.log("Fallback JSON data loaded successfully:",l),Ae(l,"fallback")}).catch(l=>{console.error("Error loading fallback search.json:",l),Se()})):Se()})}function Se(){let e=document.getElementById("search-results-list");e&&(e.innerHTML='<p class="aikb-error">Unable to load search results. Please check your connection and try again later.</p>')}function Ae(e,t="unknown"){let a=(Array.isArray(e)?e:[]).map(s=>{let i=s["last-updated"]?new Date(s["last-updated"]).getTime():0;return{title:s.title||"",summary:s.description||s.summary||"",listMetadata:{"Work area":s["work-area"]||[],Roles:s.roles||[],Benefits:s.benefits||[]},date:s["last-updated"]?new Date(s["last-updated"]).toLocaleDateString("en-AU",{year:"numeric",month:"long"}):"",dateTimestamp:i,liveUrl:s.url||s.liveUrl||"",submittedBy:s["submitted-by"]||"",rank:s.rank||0,score:s.score||0}});console.log(`Rendering ${a.length} cards from ${t}`);let n=new Set,l=[];a.forEach((s,i)=>{let r=s.liveUrl||s.url||s.title||JSON.stringify(s)+i;n.has(r)||(n.add(r),l.push(s))}),a.length!==l.length&&console.log(`Removed ${a.length-l.length} duplicate items from source data`),v(l),window.aikbSearchCache=l,console.log(`Cached ${l.length} results for offline search`),ye(l,xe),Ee(),B(l,"search-results-list")}var xe,x=y(()=>{A();N();T();$();xe=null;window.addEventListener("load",function(){console.log("Page load event fired, loading initial results..."),setTimeout(_e,200)})});function lt(e){let t=e.replace(/[^\w\s]/g," ").trim();return t?t.split(/\s+/).filter(n=>n.length>0).filter(n=>{let l=n.toLowerCase();return ce.has(l)?n===n.toUpperCase()&&n.length>=2:!0}).map(n=>n.toLowerCase()):[]}function st(e){return e?e.toLowerCase().replace(/[^\w\s]/g," "):""}function ee(e,t){if(!e||!t)return{fullWordMatches:0,partialMatches:0};let o=st(e),a=new RegExp(`\\b${t}\\b`,"gi"),n=o.match(a),l=n?n.length:0,s=new RegExp(t,"gi"),i=o.match(s),r=i?i.length:0,c=Math.max(0,r-l);return{fullWordMatches:l,partialMatches:c}}function $e(e){let t=[];return e.listMetadata&&(e.listMetadata["Work area"]&&t.push(...e.listMetadata["Work area"]),e.listMetadata.Roles&&t.push(...e.listMetadata.Roles),e.listMetadata.Benefits&&t.push(...e.listMetadata.Benefits)),t.join(" ")}function it(e,t){let o=e.title||"",a=e.summary||"",n=$e(e),l=ee(o,t),s=ee(a,t),i=ee(n,t),r=l.fullWordMatches*5+l.partialMatches*2,c=s.fullWordMatches*2+s.partialMatches*1,u=i.fullWordMatches*3+i.partialMatches*1.5,d=r+c+u;return{titleTF:l.fullWordMatches+l.partialMatches,titleFullWord:l.fullWordMatches,titlePartial:l.partialMatches,summaryTF:s.fullWordMatches+s.partialMatches,summaryFullWord:s.fullWordMatches,summaryPartial:s.partialMatches,metadataTF:i.fullWordMatches+i.partialMatches,metadataFullWord:i.fullWordMatches,metadataPartial:i.partialMatches,titleScore:r,summaryScore:c,metadataScore:u,totalScore:d,hasMatch:d>0}}function rt(e){let t=(e.title||"").length,o=(e.summary||"").length,a=$e(e).length;return t+o+a}function Me(e,t){if(!e||!t||t.length===0)return console.log("Offline search: No keywords or no cached results available"),[];let o=lt(e);if(o.length===0)return console.log("Offline search: No valid search terms after filtering noise words"),[];console.log(`Offline search: Searching for terms [${o.join(", ")}] in ${t.length} cached results`);let n=t.map(l=>{let s=0,i=[],r={};o.forEach(d=>{let m=it(l,d);m.hasMatch&&(i.push(d),s+=m.totalScore,r[d]=m)});let c=rt(l),u=c>0?s/c*1e3:0;return{...l,_offlineScore:u,_rawScore:s,_matchedTerms:i,_termScores:r,_docLength:c}}).filter(l=>l._matchedTerms.length>0);return n.sort((l,s)=>s._offlineScore-l._offlineScore),console.log(`Offline search: Found ${n.length} results matching [${o.join(", ")}]`),n.length>0&&(console.log("Offline search: Top results:"),n.slice(0,3).forEach((l,s)=>{console.log(`  ${s+1}. "${l.title}" (score: ${l._offlineScore.toFixed(2)}, matched: [${l._matchedTerms.join(", ")}], raw: ${l._rawScore}, len: ${l._docLength})`)})),n}function P(){return window.aikbSearchCache&&Array.isArray(window.aikbSearchCache)?(console.log(`Offline search: Retrieved ${window.aikbSearchCache.length} cached results`),window.aikbSearchCache):(console.log("Offline search: No cached data available"),null)}var te=y(()=>{$()});var Be=W(()=>{x();A();te();T();N();L();(function(){if(typeof window.$>"u"){console.warn("jQuery not loaded; search form handler disabled");return}let t=window.$("#policy-search-form"),o=window.$("#search");if(t.length===0){console.error("Form #policy-search-form not found");return}function a(){return{query:o.val()||"",area:window.$("#document_type").val()||""}}function n(i){i.preventDefault()}function l(){o.val(""),console.log("Search cleared - restoring filtered view of all results");let i=P();i&&i.length>0&&(v(i),b())}t.on("submit",n),window.$("#clear-input").on("click",l),o.on("input",function(){let i=window.$("#clear-input");window.$(this).val().length>0?i.attr("hidden",!1):i.attr("hidden","")}),o.on("keydown",function(i){if(i.key==="Enter"||i.keyCode===13){i.preventDefault();let r=window.$(this).val();if(r.trim())s(r);else{console.log("Empty search via Enter - restoring filtered view of all results");let c=P();c&&c.length>0&&(v(c),b())}}});function s(i){if(!i.trim())return;console.log(`Triggered search for: "${i}"`);let r=P();if(r&&r.length>0){console.log("Performing local search");let c=Me(i,r);v(c),b(),console.log(`Local search: Found ${c.length} results, applying filters`)}else{console.error("No cached data available for search");let c=window.$("#search-results-list");c.length>0&&c.html('<p class="aikb-error">Unable to load search results. Please check your connection and try again.</p>')}}console.log("Search form handler initialized")})()});var Le=W(()=>{var ct='div[data-hydration-component="squiz-call-to-action"] a';function Ne(e=document){e.querySelectorAll(ct).forEach(o=>{o.classList.add("ntgc-btn","ntgc-btn--primary")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>Ne()):Ne()});var dt=W(()=>{$();var zt=oe(Be());T();A();N();te();Z();x();var Kt=oe(Le());U();L();console.log("[aikb] Landing page bundle loaded successfully");console.log("[aikb] jQuery available:",typeof window.jQuery<"u");console.log("[aikb] DOM ready state:",document.readyState);window.addEventListener("load",function(){ke(),console.log("[aikb] Applied filters initialized")})});dt();})();
//# sourceMappingURL=landing-page.min.js.map
