(()=>{var Ee=Object.create;var M=Object.defineProperty;var ve=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var xe=Object.getPrototypeOf,Ae=Object.prototype.hasOwnProperty;var f=(t,e)=>()=>(t&&(e=t(t=0)),e);var O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),W=(t,e)=>{for(var o in e)M(t,o,{get:e[o],enumerable:!0})},Se=(t,e,o,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Ce(e))!Ae.call(t,n)&&n!==o&&M(t,n,{get:()=>e[n],enumerable:!(a=ve(e,n))||a.enumerable});return t};var X=(t,e,o)=>(o=t!=null?Ee(xe(t)):{},Se(e||!t||!t.__esModule?M(o,"default",{value:t,enumerable:!0}):o,t));function ee(){return window.location.hostname==="ntgcentral.nt.gov.au"}function E(){return{isProduction:ee(),liveApiUrl:"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/articles/_nocache",fallbackJsonUrl:"./dist/search.json",workAreasUrl:ee()?"https://ntgcentral.nt.gov.au/services-and-support/ict-services-websites/artificial-intelligence/ai-knowledge-base/configuration/listing/work-areas/_nocache":"./src/data/work-areas.json"}}function te(){let t=E();return t.isProduction?t.liveApiUrl:t.fallbackJsonUrl}function ne(){let t=E();return t.isProduction?t.fallbackJsonUrl:null}function ae(){return E().workAreasUrl}var F=f(()=>{});var se={};W(se,{getCurrentPage:()=>Be,getCurrentPageResults:()=>le,getTotalPages:()=>U,initializePagination:()=>_e,updatePagination:()=>Ie});function _e(t,e=10){V=t,A=e,q=t.length,u=1,$e(),j()}function le(){let t=(u-1)*A,e=t+A;return V.slice(t,e)}function Be(){return u}function U(){return Math.ceil(q/A)}function $e(){if(h=document.getElementById("aikb-pagination"),!h){let t=document.getElementById("search-results-list");t&&t.parentNode&&(h=document.createElement("div"),h.id="aikb-pagination",h.className="aikb-pagination",t.parentNode.insertBefore(h,t.nextSibling))}}function j(){if(!h)return;let t=U();if(t<=1){h.innerHTML="",h.style.display="none";return}h.style.display="flex";let e=document.createElement("div");e.className="aikb-pagination__wrapper";let o=oe("Previous",u>1,()=>{u>1&&z(u-1)});e.appendChild(o);let a=Ne(t);e.appendChild(a);let n=oe("Next",u<t,()=>{u<t&&z(u+1)});e.appendChild(n),h.innerHTML="",h.appendChild(e)}function oe(t,e,o){let a=document.createElement("div");a.className="aikb-pagination__control",e||a.classList.add("aikb-pagination__control--disabled");let n=document.createElement("div");if(n.className="aikb-pagination__icon-label",t==="Previous"){let s=document.createElement("span");s.className="fal fa-chevron-left",s.setAttribute("aria-hidden","true"),n.appendChild(s)}let l=document.createElement("span");if(l.className="aikb-pagination__text",l.textContent=t,n.appendChild(l),t==="Next"){let s=document.createElement("span");s.className="fal fa-chevron-right",s.setAttribute("aria-hidden","true"),n.appendChild(s)}return a.appendChild(n),e&&(a.addEventListener("click",o),a.style.cursor="pointer"),a}function Ne(t){let e=document.createElement("div");return e.className="aikb-pagination__pages",Le(u,t).forEach(a=>{if(a==="..."){let n=document.createElement("span");n.className="aikb-pagination__ellipsis",n.textContent="...",e.appendChild(n)}else{let n=document.createElement("div");n.className="aikb-pagination__page-number",a===u&&n.classList.add("aikb-pagination__page-number--active");let l=document.createElement("span");l.textContent=a,n.appendChild(l),n.addEventListener("click",()=>z(a)),n.style.cursor="pointer",e.appendChild(n)}}),e}function Le(t,e){if(e<=7)return Array.from({length:e},(l,s)=>s+1);let o=[];o.push(1),t>3&&o.push("...");let a=Math.max(2,t-1),n=Math.min(e-1,t+1);for(let l=a;l<=n;l++)o.push(l);return t<e-2&&o.push("..."),o.push(e),o}function z(t){let e=U();if(t<1||t>e||t===u)return;u=t,j();let o=new CustomEvent("aikb-pagination-change",{detail:{page:u,results:le()}});document.dispatchEvent(o);let a=document.getElementById("search-results-list");if(a){let l=a.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:l,behavior:"smooth"})}}function Ie(t){V=t,q=t.length,u=1,j()}var u,A,q,V,h,H=f(()=>{u=1,A=10,q=0,V=[],h=null});var ie={};W(ie,{renderResults:()=>w});function Pe(t){if(!t)return"";if(/^[A-Z][a-z]+ \d{4}$/.test(t))return t;try{let o=new Date(t);if(!isNaN(o.getTime()))return`${["January","February","March","April","May","June","July","August","September","October","November","December"][o.getMonth()]} ${o.getFullYear()}`}catch{}return t}function J(t){if(!t.title||!t.summary||!t.liveUrl)return console.warn("Skipping card with missing required fields:",t),null;let e=document.createElement("div");e.className="aikb-search-card";let o=document.createElement("div");o.className="aikb-search-card__inner";let a=document.createElement("div");a.className="aikb-search-card__content";let n=document.createElement("div");n.className="aikb-search-card__text";let l=document.createElement("h3");l.className="aikb-search-card__title",l.textContent=t.title,n.appendChild(l);let s=document.createElement("p");s.className="aikb-search-card__summary",s.textContent=t.summary,n.appendChild(s),a.appendChild(n);let i=t.listMetadata&&t.listMetadata["Work area"]?t.listMetadata["Work area"]:[];if(i&&i.length>0){let m=document.createElement("div");m.className="aikb-search-card__tags",i.forEach(y=>{if(y&&y.trim()){let b=document.createElement("div");b.className="aikb-search-card__tag",b.textContent=y.trim(),m.appendChild(b)}}),m.children.length>0&&a.appendChild(m)}o.appendChild(a);let r=document.createElement("div");r.className="aikb-search-card__actions";let c=document.createElement("a");c.href=t.liveUrl,c.className="ntgc-btn ntgc-btn--secondary";let d=document.createElement("span");d.textContent="See more",c.appendChild(d);let g=document.createElement("span");g.className="fal fa-long-arrow-right",g.setAttribute("aria-hidden","true"),c.appendChild(g),r.appendChild(c);let p=document.createElement("div");p.className="aikb-search-card__metadata";let T=t.listMetadata&&t.listMetadata.Roles?t.listMetadata.Roles:[];if(T&&T.length>0){let m=document.createElement("div");m.className="aikb-search-card__useful-for";let y=document.createElement("span");y.className="aikb-search-card__useful-value";let b=document.createElement("strong");b.textContent="Good for: ",y.appendChild(b);let ke=document.createTextNode(T.join(", "));y.appendChild(ke),m.appendChild(y),p.appendChild(m)}if(t.date){let m=document.createElement("div");m.className="aikb-search-card__date",m.textContent=`Last updated: ${Pe(t.date)}`,p.appendChild(m)}return r.appendChild(p),o.appendChild(r),e.appendChild(o),e}function w(t,e="search-results-list",o=!0){console.log(`renderResults called with ${t.length} results for container #${e}`);let a=document.getElementById(e);if(console.log(`document.getElementById("${e}"):`,a),!a){let n=window.$?window.$(`#${e}`):null;console.log(`jQuery selector $("#${e}"):`,n),a=n&&n.length>0?n[0]:null}if(!a){console.error(`Container #${e} not found`),console.log("Available elements with id:",Array.from(document.querySelectorAll("[id]")).map(n=>n.id));return}if(a.innerHTML="",t.length===0){let n=document.createElement("p");n.textContent="No results found.",n.style.padding="24px 48px",a.appendChild(n);return}if(o)Promise.resolve().then(()=>(H(),se)).then(({initializePagination:n,getCurrentPageResults:l})=>{n(t,10);let i=l().map(r=>J(r)).filter(r=>r!==null);i.forEach(r=>a.appendChild(r)),console.log(`Rendered ${i.length} of ${t.length} search result cards (page 1)`)});else{let n=t.map(l=>J(l)).filter(l=>l!==null);n.forEach(l=>a.appendChild(l)),console.log(`Rendered ${n.length} search result cards`)}}var v=f(()=>{window.aikbRenderResults=w;document.addEventListener("aikb-pagination-change",t=>{let{results:e}=t.detail,o=document.getElementById("search-results-list");if(o&&e){o.innerHTML="";let a=e.map(n=>J(n)).filter(n=>n!==null);a.forEach(n=>o.appendChild(n)),console.log(`Rendered ${a.length} cards for page ${t.detail.page}`)}})});function re(t){let e=typeof t=="string"?document.querySelector(t):t;return e?new Q(e):(console.warn("Multi-select element not found:",t),null)}var Q,Z=f(()=>{Q=class{constructor(e){this.selectElement=e,this.options=[],this.selectedValues=new Set,this.tempSelectedValues=new Set,this.isOpen=!1,this.container=null,this.displayButton=null,this.dropdownPanel=null,this.init()}init(){this.selectElement.style.display="none",this.createDropdownStructure(),this.selectAllByDefault(),this.bindEvents(),this.container.__multiSelectInstance=this}selectAllByDefault(){this.options.forEach(e=>{this.selectedValues.add(e.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.tempSelectedValues=new Set(this.selectedValues)}createDropdownStructure(){this.container=document.createElement("div"),this.container.className="aikb-multiselect-container",this.displayButton=document.createElement("button"),this.displayButton.type="button",this.displayButton.className="aikb-multiselect-button",this.displayButton.innerHTML=`
      <span class="aikb-multiselect-text">Select Options</span>
      <span class="aikb-multiselect-icon"></span>
    `,this.dropdownPanel=document.createElement("div"),this.dropdownPanel.className="aikb-multiselect-panel",this.dropdownPanel.style.display="none";let e=document.createElement("div");e.className="aikb-multiselect-options";let o=this.createOptionItem({value:"_select_all",label:"Select All",isSelectAll:!0});e.appendChild(o),Array.from(this.selectElement.options).forEach(s=>{if(!s.disabled&&s.value){this.options.push({value:s.value,label:s.textContent});let i=this.createOptionItem({value:s.value,label:s.textContent});e.appendChild(i)}});let a=document.createElement("div");a.className="aikb-multiselect-actions";let n=document.createElement("button");n.type="button",n.className="aikb-multiselect-btn aikb-multiselect-btn-ok",n.textContent="OK",n.addEventListener("click",()=>this.handleOk());let l=document.createElement("button");l.type="button",l.className="aikb-multiselect-btn aikb-multiselect-btn-cancel",l.textContent="Cancel",l.addEventListener("click",()=>this.handleCancel()),a.appendChild(n),a.appendChild(l),this.dropdownPanel.appendChild(e),this.dropdownPanel.appendChild(a),this.container.appendChild(this.displayButton),this.container.appendChild(this.dropdownPanel),this.selectElement.parentNode.insertBefore(this.container,this.selectElement.nextSibling)}createOptionItem(e){let o=document.createElement("label");o.className="aikb-multiselect-option",e.isSelectAll&&o.classList.add("aikb-multiselect-option-all");let a=document.createElement("input");a.type="checkbox",a.className="aikb-multiselect-checkbox",a.value=e.value,a.dataset.label=e.label,e.isSelectAll?a.addEventListener("change",l=>this.handleSelectAll(l)):a.addEventListener("change",()=>this.updateSelectAllState());let n=document.createElement("span");return n.className="aikb-multiselect-label",n.textContent=e.label,o.appendChild(a),o.appendChild(n),o}bindEvents(){this.displayButton.addEventListener("click",e=>{e.stopPropagation(),this.toggle()}),document.addEventListener("click",e=>{!this.container.contains(e.target)&&this.isOpen&&this.handleCancel()})}toggle(){this.isOpen?this.close():this.open()}open(){this.isOpen=!0,this.dropdownPanel.style.display="block",this.displayButton.classList.add("aikb-multiselect-open"),this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes()}close(){this.isOpen=!1,this.dropdownPanel.style.display="none",this.displayButton.classList.remove("aikb-multiselect-open")}handleOk(){let e=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])');this.selectedValues.clear(),e.forEach(o=>{o.checked&&this.selectedValues.add(o.value)}),this.syncNativeSelect(),this.updateDisplayText(),this.triggerChange(),this.close()}handleCancel(){this.tempSelectedValues=new Set(this.selectedValues),this.updateCheckboxes(),this.close()}handleSelectAll(e){let o=e.target.checked;this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(n=>{n.checked=o})}updateSelectAllState(){let e=this.dropdownPanel.querySelector('.aikb-multiselect-checkbox[value="_select_all"]'),o=this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])'),a=Array.from(o).filter(n=>n.checked).length;e&&(e.checked=a===o.length,e.indeterminate=a>0&&a<o.length)}updateCheckboxes(){this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(o=>{o.checked=this.tempSelectedValues.has(o.value)}),this.updateSelectAllState()}updateDisplayText(){let e=this.displayButton.querySelector(".aikb-multiselect-text");if(this.selectedValues.size===0)e.textContent="Select Options",e.classList.remove("aikb-multiselect-has-selection");else if(this.selectedValues.size===this.options.length)e.textContent="All selected",e.classList.add("aikb-multiselect-has-selection");else{let o=Array.from(this.selectedValues).map(a=>{let n=this.options.find(l=>l.value===a);return n?n.label:a});this.selectedValues.size<=2?e.textContent=o.join(", "):e.textContent=`${this.selectedValues.size} selected`,e.classList.add("aikb-multiselect-has-selection")}}triggerChange(){let e=new CustomEvent("multiselect-change",{detail:{values:Array.from(this.selectedValues)}});if(this.container.dispatchEvent(e),this.selectElement){let o=new Event("change",{bubbles:!0});this.selectElement.dispatchEvent(o)}console.log("Multi-select changed:",Array.from(this.selectedValues))}syncNativeSelect(){this.selectElement&&(Array.from(this.selectElement.options).forEach(e=>{e.selected=!1}),Array.from(this.selectElement.options).forEach(e=>{this.selectedValues.has(e.value)&&(e.selected=!0)}))}getSelectedValues(){return Array.from(this.selectedValues)}reset(){this.selectedValues.clear(),this.tempSelectedValues.clear(),this.updateDisplayText(),this.updateCheckboxes()}updateCounts(e){Array.from(this.selectElement.options).forEach(a=>{if(!a.disabled&&a.value&&e.has(a.value)){let n=e.get(a.value),l=a.textContent.replace(/\s*\(\d+\)\s*$/,"");n>0?a.textContent=`${l} (${n})`:a.textContent=l}}),this.dropdownPanel.querySelectorAll('.aikb-multiselect-checkbox:not([value="_select_all"])').forEach(a=>{let n=a.value;if(e.has(n)){let l=e.get(n),s=a.parentElement.querySelector(".aikb-multiselect-label");if(s){let i=s.querySelector(".aikb-count-badge");i&&i.remove();let r=s.textContent.replace(/\s*\(\d+\)\s*$/,"").trim();if(s.textContent=r,l>0){let c=document.createElement("span");c.className="aikb-count-badge",c.textContent=l.toString(),s.appendChild(c);let d=this.options.findIndex(g=>g.value===n);d!==-1&&(this.options[d].label=`${r} (${l})`)}else{let c=this.options.findIndex(d=>d.value===n);c!==-1&&(this.options[c].label=r)}}}}),this.updateDisplayText(),console.log("Multi-select counts updated")}destroy(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.selectElement&&(this.selectElement.style.display=""),this.container=null,this.displayButton=null,this.dropdownPanel=null,console.log("Multi-select instance destroyed")}}});function De(t){let e=new Set;return t.forEach(o=>{if(o.listMetadata&&o.listMetadata["Work area"]){let a=o.listMetadata["Work area"];Array.isArray(a)&&a.forEach(n=>{let l=n.trim();l&&e.add(l)})}}),Array.from(e).sort((o,a)=>o==="All work areas"?-1:a==="All work areas"?1:o.localeCompare(a))}function Re(t,e){let o=new Map;return t.forEach(a=>{o.set(a,0)}),e.forEach(a=>{if(a.listMetadata&&a.listMetadata["Work area"]){let n=a.listMetadata["Work area"];Array.isArray(n)&&n.forEach(l=>{let s=l.trim();s&&o.has(s)&&o.set(s,o.get(s)+1)})}}),o.has("All work areas")&&o.set("All work areas",e.length),o}function ce(t){G=t,console.log(`Stored ${t.length} static work areas`)}function Te(t){let e=document.getElementById("document_type");if(!e){console.warn("Work area dropdown #document_type not found");return}e.innerHTML="";let o=document.createElement("option");o.value="",o.textContent="Select a work area",o.disabled=!0,o.selected=!0,e.appendChild(o),t.forEach(a=>{let n=document.createElement("option");n.value=a,n.textContent=a,e.appendChild(n)}),console.log(`Populated work area dropdown with ${t.length} options`),k&&(k.destroy(),k=null),(!e.nextElementSibling||!e.nextElementSibling.classList.contains("aikb-multiselect-container"))&&(k=re(e))}function Me(){let t=document.getElementById("select-question-3");if(!t){console.warn("Sort dropdown container #select-question-3 not found");return}let e=document.getElementById("owner");if(e)e.innerHTML="";else{let a=t.querySelector("label");if(t.innerHTML="",a)t.appendChild(a);else{let s=document.createElement("label");s.className="ntgc-form-input--label",s.setAttribute("for","select-input-2"),s.textContent="Sort",t.appendChild(s)}let n=document.createElement("div");n.className="aikb-dropdown-wrapper";let l=document.createElement("div");l.className="aikb-dropdown-inner",e=document.createElement("select"),e.name="sort",e.className="ntgc-select ntgc-select--block ntgc-select-input--filter",e.id="owner",l.appendChild(e),n.appendChild(l),t.appendChild(n)}let o=[{value:"relevance",label:"Relevance",selected:!0},{value:"date-newest",label:"Date (newest first)"},{value:"date-oldest",label:"Date (oldest first)"},{value:"title-az",label:"Title (A-Z)"},{value:"title-za",label:"Title (Z-A)"}];o.forEach(a=>{let n=document.createElement("option");n.value=a.value,n.textContent=a.label,a.selected&&(n.selected=!0),e.appendChild(n)}),console.log(`Populated sort dropdown with ${o.length} options`)}function Oe(){let t=document.getElementById("document_type");if(t&&!t.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let a=t.closest(".aikb-dropdown-wrapper");if(a){let n=a.querySelector(".aikb-dropdown-inner");n&&n.appendChild(o)}}let e=document.getElementById("owner");if(e&&!e.parentElement.querySelector(".aikb-dropdown-icon")){let o=document.createElement("div");o.className="aikb-dropdown-icon",o.setAttribute("data-colour","NTG Blue");let a=e.closest(".aikb-dropdown-wrapper");if(a){let n=a.querySelector(".aikb-dropdown-inner");n&&n.appendChild(o)}}}function S(t,e=null){console.log("Initializing dropdowns with search data...");let o;e&&e.length>0?(o=e,console.log("Using pre-fetched static work areas list")):G.length>0?(o=G,console.log("Using stored static work areas list")):(o=De(t),console.log("Extracted work areas from results (fallback)")),Te(o);let a=Re(o,t);k&&k.updateCounts(a),Me(),Oe(),console.log("Dropdowns initialized successfully")}var k,G,_=f(()=>{Z();k=null,G=[]});function B(t){let e=document.getElementById("appliedFiltersSection"),o=document.getElementById("appliedFilters"),a=document.getElementById("clearAllBtn");if(!e||!o){console.warn("Applied filters section not found");return}o.innerHTML="";let n=!1;if(t.searchQuery&&t.searchQuery.trim()){n=!0;let l=de("Search",t.searchQuery,"bg-success","search");o.appendChild(l)}t.workAreas&&t.workAreas.length>0&&(We(t.workAreas)||(n=!0,t.workAreas.forEach(s=>{let i=de("Work area",s,"bg-primary","work-area",s);o.appendChild(i)}))),a&&(a.style.display=n?"inline-flex":"none",a.style.marginLeft="8px",a.style.verticalAlign="middle",a.style.alignItems="center",o.appendChild(a)),e.style.display=n?"block":"none"}function We(t){let e=document.getElementById("document_type");if(!e)return!1;let o=Array.from(e.options).filter(a=>!a.disabled&&a.value).length;return t.length===o}function de(t,e,o,a,n){let l=document.createElement("span");l.className=`badge ${o} filter-pill d-inline-flex align-items-center`;let s=document.createElement("span");s.className="pill-label",s.textContent=`${t}:`;let i=document.createElement("span");i.className="pill-value",i.textContent=e;let r=document.createElement("button");r.type="button",r.className="pill-remove",r.title=`Remove ${t}: ${e}`,r.setAttribute("data-filter-type",a),n&&r.setAttribute("data-filter-value",n);let c=document.createElement("span");return c.className="fas fa-times",r.appendChild(c),r.addEventListener("click",d=>{d.preventDefault(),Fe(a,n)}),l.appendChild(s),l.appendChild(i),l.appendChild(r),l}async function Fe(t,e){switch(console.log(`Removing filter: ${t}`,e),t){case"search":let o=document.getElementById("search");if(o){o.value="";let{loadInitialResults:n}=await Promise.resolve().then(()=>(C(),K));n()}break;case"work-area":let a=document.getElementById("document_type");if(a&&e){let n=Array.from(a.options).find(i=>i.value===e);n&&(n.selected=!1);let l=new Event("change",{bubbles:!0});a.dispatchEvent(l);let s=a.nextElementSibling;if(s&&s.classList.contains("aikb-multiselect-container")){let i=s.__multiSelectInstance;i&&(i.selectedValues.delete(e),i.syncNativeSelect(),i.updateDisplayText(),i.triggerChange())}}break}}async function ze(){console.log("Clearing all filters");let t=document.getElementById("search");t&&(t.value="");let e=document.getElementById("document_type");if(e){Array.from(e.options).forEach(l=>{!l.disabled&&l.value&&(l.selected=!0)});let n=e.nextElementSibling;if(n&&n.classList.contains("aikb-multiselect-container")){let l=n.__multiSelectInstance;l&&typeof l.selectAllByDefault=="function"&&(l.selectAllByDefault(),l.triggerChange())}}let o=document.getElementById("appliedFiltersSection");o&&(o.style.display="none");let{loadInitialResults:a}=await Promise.resolve().then(()=>(C(),K));a()}function ue(){let t=document.getElementById("clearAllBtn");t&&t.addEventListener("click",e=>{e.preventDefault(),ze()})}function $(){let t=document.getElementById("search"),e=document.getElementById("document_type"),o=document.getElementById("sort")||document.getElementById("owner"),a={searchQuery:t?t.value:"",workAreas:[],sort:o?o.value:"relevance"};if(e){let n=Array.from(e.selectedOptions||[]);a.workAreas=n.map(l=>l.value).filter(l=>l&&l.trim().length>0)}return a}var N=f(()=>{});function P(t){I=t,console.log(`Stored ${I.length} results for filtering/sorting`)}function qe(t){return!t||t.length===0?I:I.filter(e=>{if(!e.listMetadata||!e.listMetadata["Work area"])return!1;let o=e.listMetadata["Work area"];return o.includes("All work areas")?!0:t.some(a=>o.includes(a))})}function Ve(t,e){let o=[...t];switch(e){case"relevance":o.sort((a,n)=>a.rank&&n.rank?a.rank-n.rank:a.score&&n.score?n.score-a.score:0);break;case"date-newest":o.sort((a,n)=>{let l=a.date?new Date(a.date).getTime():0;return(n.date?new Date(n.date).getTime():0)-l});break;case"date-oldest":o.sort((a,n)=>{let l=a.date?new Date(a.date).getTime():0,s=n.date?new Date(n.date).getTime():0;return l-s});break;case"title-az":o.sort((a,n)=>{let l=a.title||"",s=n.title||"";return l.localeCompare(s)});break;case"title-za":o.sort((a,n)=>{let l=a.title||"";return(n.title||"").localeCompare(l)});break;default:break}return o}async function L(){let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(!t||!e){console.warn("Required dropdowns not found (document_type or sort)");return}let o=[];t&&(o=Array.from(t.selectedOptions||[]).map(c=>c.value).filter(c=>c&&c.trim().length>0));let a=e.value||"relevance";console.log(`Applying filters - Work Areas: [${o.join(", ")}], Sort: "${a}"`);let n=qe(o);console.log(`After filtering: ${n.length} results`);let l=Ve(n,a);console.log(`After sorting: ${l.length} results`);let{renderResults:s}=await Promise.resolve().then(()=>(v(),ie));s(l,"search-results-list");let i=$();B(i)}function D(){let t=document.getElementById("document_type"),e=document.getElementById("sort")||document.getElementById("owner");if(t){t.addEventListener("change",function(){console.log("Work area filter changed"),L()});let o=t.nextElementSibling;o&&o.classList.contains("aikb-multiselect-container")&&o.addEventListener("multiselect-change",()=>{console.log("Work area filter applied via custom multi-select"),L()}),typeof window.$<"u"&&window.$(t).on("sumo:closed",function(){console.log("Work area filter applied via SumoSelect OK"),L()})}e&&e.addEventListener("change",function(){console.log(`Sort changed to: ${this.value}`),L()}),console.log("Filter and sort listeners initialized")}var I,R=f(()=>{N();I=[]});var K={};W(K,{loadInitialResults:()=>x});async function Ue(){let t=ae();console.log(`Fetching work areas from ${t}...`);try{let e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);let o=await e.json();return console.log("Work areas loaded successfully:",o),Array.isArray(o)?o:[]}catch(e){return console.error(`Error fetching work areas from ${t}:`,e),null}}function x(){if(!document.getElementById("search-results-list")){console.warn("search-results-list container not found on page");return}let e=E(),o=te(),a=ne();console.log(`Loading initial results from ${e.isProduction?"live API":"local JSON"}...`),Ue().then(n=>{n&&(he=n,ce(n))}),fetch(o).then(n=>{if(console.log(`Primary source (${o}) response status:`,n.status,n.ok),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return n.json()}).then(n=>{console.log(`Primary source data loaded successfully (${e.isProduction?"live API":"local JSON"}):`,n),me(n,e.isProduction?"live-api":"local")}).catch(n=>{console.error(`Error loading from primary source (${o}):`,n),a?(console.log("Attempting fallback to local JSON..."),fetch(a).then(l=>{if(console.log("Fallback JSON response status:",l.status,l.ok),!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return l.json()}).then(l=>{console.log("Fallback JSON data loaded successfully:",l),me(l,"fallback")}).catch(l=>{console.error("Error loading fallback search.json:",l),pe()})):pe()})}function pe(){let t=document.getElementById("search-results-list");t&&(t.innerHTML='<p class="aikb-error">Unable to load search results. Please check your connection and try again later.</p>')}function me(t,e="unknown"){let a=(Array.isArray(t)?t:[]).map(n=>({title:n.title||"",summary:n.description||n.summary||"",listMetadata:{"Work area":n["work-area"]||[],Roles:n.roles||[],Benefits:n.benefits||[]},date:n["last-updated"]?new Date(n["last-updated"]).toLocaleDateString("en-AU",{year:"numeric",month:"long"}):"",liveUrl:n.url||n.liveUrl||"",submittedBy:n["submitted-by"]||""}));console.log(`Rendering ${a.length} cards from ${e}`),P(a),window.aikbSearchCache=a,console.log(`Cached ${a.length} results for offline search`),S(a,he),D(),w(a,"search-results-list")}var he,C=f(()=>{v();_();R();F();he=null;window.addEventListener("load",function(){console.log("Page load event fired, loading initial results..."),setTimeout(x,200)})});function fe(t,e){if(!t||!e||e.length===0)return console.log("Offline search: No keywords or no cached results available"),[];let o=t.toLowerCase().replace(/[^\w\s]/g,"").trim();if(!o)return console.log("Offline search: Keywords empty after normalization"),[];console.log(`Offline search: Searching for "${t}" in ${e.length} cached results`);let a=new RegExp(o,"gi"),l=e.map(s=>{let i=0,r=0,c=0,d=0;if(s.title){let p=s.title.toLowerCase().replace(/[^\w\s]/g,"").match(a);p&&(r=p.length,i+=r*3)}if(s.summary){let p=s.summary.toLowerCase().replace(/[^\w\s]/g,"").match(a);p&&(c=p.length,i+=c*1)}if(s.metadata){let p=s.metadata.toLowerCase().replace(/[^\w\s]/g,"").match(a);p&&(d=p.length,i+=d*2)}return{...s,_offlineScore:i,_offlineMatches:{title:r,summary:c,metadata:d}}}).filter(s=>s._offlineScore>0);return l.sort((s,i)=>i._offlineScore-s._offlineScore),console.log(`Offline search: Found ${l.length} results matching "${t}"`),l.length>0&&(console.log("Offline search: Top results:"),l.slice(0,3).forEach((s,i)=>{console.log(`  ${i+1}. "${s.title}" (score: ${s._offlineScore}, title:${s._offlineMatches.title}, summary:${s._offlineMatches.summary}, metadata:${s._offlineMatches.metadata})`)})),l}function ge(){return window.aikbSearchCache&&Array.isArray(window.aikbSearchCache)?(console.log(`Offline search: Retrieved ${window.aikbSearchCache.length} cached results`),window.aikbSearchCache):(console.log("Offline search: No cached data available"),null)}var Y=f(()=>{});var ye=O(()=>{C();v();Y();R();_();N();(function(){if(typeof window.$>"u"){console.warn("jQuery not loaded; search form handler disabled");return}let e=window.$("#policy-search-form"),o=window.$("#search");if(e.length===0){console.error("Form #policy-search-form not found");return}function a(){return{query:o.val()||"",area:window.$("#document_type").val()||""}}function n(i){i.preventDefault()}function l(){o.val(""),console.log("Search cleared - reloading initial results"),x()}e.on("submit",n),window.$("#clear-input").on("click",l),o.on("input",function(){let i=window.$("#clear-input");window.$(this).val().length>0?i.attr("hidden",!1):i.attr("hidden","")}),o.on("keydown",function(i){if(i.key==="Enter"||i.keyCode===13){i.preventDefault();let r=window.$(this).val();r.trim()?s(r):(console.log("Empty search via Enter - reloading initial results"),x())}});function s(i){if(!i.trim())return;console.log(`Triggered search for: "${i}"`);let r=ge();if(r&&r.length>0){console.log("Performing local search");let c=fe(i,r);P(c),S(c),D(),w(c,"search-results-list");let d=$();B(d),console.log(`Local search: Displayed ${c.length} results`)}else{console.error("No cached data available for search");let c=window.$("#search-results-list");c.length>0&&c.html('<p class="aikb-error">Unable to load search results. Please check your connection and try again.</p>')}}console.log("Search form handler initialized")})()});var we=O(()=>{var je='div[data-hydration-component="squiz-call-to-action"] a';function be(t=document){t.querySelectorAll(je).forEach(o=>{o.classList.add("ntgc-btn","ntgc-btn--primary")})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>be()):be()});var He=O(()=>{F();var yt=X(ye());R();v();_();Y();Z();C();var xt=X(we());H();N();console.log("[aikb] Landing page bundle loaded successfully");console.log("[aikb] jQuery available:",typeof window.jQuery<"u");console.log("[aikb] DOM ready state:",document.readyState);window.addEventListener("load",function(){ue(),console.log("[aikb] Applied filters initialized")})});He();})();
//# sourceMappingURL=landing-page.min.js.map
